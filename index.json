[{"categories":["å­¦ä¹ "],"content":"ORC å’Œ Parquet æ–‡ä»¶å­˜å‚¨æ ¼å¼","date":"2022-12-07","objectID":"/orc/","tags":["æ•°ä»“"],"title":"ORC å’Œ Parquet æ–‡ä»¶å­˜å‚¨æ ¼å¼","uri":"/orc/"},{"categories":["å­¦ä¹ "],"content":"ORC ä¸ Parquet çš„è¾ƒé‡ã€‚ ","date":"2022-12-07","objectID":"/orc/:0:0","tags":["æ•°ä»“"],"title":"ORC å’Œ Parquet æ–‡ä»¶å­˜å‚¨æ ¼å¼","uri":"/orc/"},{"categories":["å­¦ä¹ "],"content":"åµŒå¥—ç»“æ„æ”¯æŒ Parquet èƒ½å¤Ÿå¾ˆå®Œç¾çš„æ”¯æŒåµŒå¥—å¼ç»“æ„ï¼Œè€Œåœ¨è¿™ä¸€ç‚¹ä¸Š ORC æ”¯æŒçš„å¹¶ä¸å¥½ï¼Œè¡¨è¾¾èµ·æ¥å¤æ‚ä¸”æ€§èƒ½å’Œç©ºé—´éƒ½æŸè€—è¾ƒå¤§ã€‚ Parquet éå¸¸é€‚ç”¨äº OLAP åœºæ™¯ï¼ŒæŒ‰åˆ—å­˜å‚¨å’Œæ‰«æã€‚ ","date":"2022-12-07","objectID":"/orc/:1:0","tags":["æ•°ä»“"],"title":"ORC å’Œ Parquet æ–‡ä»¶å­˜å‚¨æ ¼å¼","uri":"/orc/"},{"categories":["å­¦ä¹ "],"content":"æ›´æ–°ä¸ ACID æ”¯æŒ ORC æ ¼å¼æ”¯æŒ update æ“ä½œä¸ ACIDï¼Œè€Œ Parquet å¹¶ä¸æ”¯æŒã€‚ ","date":"2022-12-07","objectID":"/orc/:2:0","tags":["æ•°ä»“"],"title":"ORC å’Œ Parquet æ–‡ä»¶å­˜å‚¨æ ¼å¼","uri":"/orc/"},{"categories":["å­¦ä¹ "],"content":"å‹ç¼©ä¸æŸ¥è¯¢æ€§èƒ½ åœ¨å‹ç¼©ç©ºé—´ä¸æŸ¥è¯¢æ€§èƒ½æ–¹é¢ï¼ŒParquet ä¸ ORC æ€»ä½“ä¸Šç›¸å·®ä¸å¤§ã€‚å¯èƒ½ ORC è¦ç¨å¥½äº Parquetã€‚ ","date":"2022-12-07","objectID":"/orc/:3:0","tags":["æ•°ä»“"],"title":"ORC å’Œ Parquet æ–‡ä»¶å­˜å‚¨æ ¼å¼","uri":"/orc/"},{"categories":["å­¦ä¹ "],"content":"æŸ¥è¯¢å¼•æ“æ”¯æŒ è¿™æ–¹é¢ Parquet å¯èƒ½æ›´æœ‰ä¼˜åŠ¿ï¼Œæ”¯æŒ Hiveã€Impalaã€Presto ç­‰å„ç§æŸ¥è¯¢å¼•æ“ï¼Œè€Œ ORC ä¸ Hive æ¥è§¦çš„æ¯”è¾ƒç´§å¯†ï¼Œè€Œä¸ Impala é€‚é…çš„å¹¶ä¸å¥½ã€‚ä¹‹å‰æˆ‘ä»¬è¯´ Impala ä¸æ”¯æŒ ORCï¼Œç›´åˆ° CDH 6.1.x ç‰ˆæœ¬ä¹Ÿå°±æ˜¯ Impala3.x æ‰å¼€å§‹ä»¥ experimental feature æ”¯æŒ ORC æ ¼å¼ã€‚ ORC æ–‡ä»¶æ˜¯å¯åˆ‡åˆ†ï¼ˆSplitï¼‰çš„ã€‚å› æ­¤ï¼Œåœ¨ Hive ä¸­ä½¿ç”¨ ORC ä½œä¸ºè¡¨çš„æ–‡ä»¶å­˜å‚¨æ ¼å¼ï¼Œä¸ä»…èŠ‚çœ HDFS å­˜å‚¨èµ„æºï¼ŒæŸ¥è¯¢ä»»åŠ¡çš„è¾“å…¥æ•°æ®é‡å‡å°‘ï¼Œä½¿ç”¨çš„ MapTask ä¹Ÿå°±å‡å°‘äº†ã€‚ ","date":"2022-12-07","objectID":"/orc/:4:0","tags":["æ•°ä»“"],"title":"ORC å’Œ Parquet æ–‡ä»¶å­˜å‚¨æ ¼å¼","uri":"/orc/"},{"categories":["å­¦ä¹ "],"content":"æ€»ç»“ å…³äº Parquet ä¸ ORCï¼Œé¦–å…ˆå»ºè®®æ ¹æ®å®é™…æƒ…å†µè¿›è¡Œé€‰æ‹©ã€‚å¦å¤–ï¼Œæ ¹æ®ç¬”è€…çš„ç»¼åˆè¯„ä¼°ï¼Œå¦‚æœä¸æ˜¯ä¸€å®šè¦ä½¿ç”¨ ORC çš„ç‰¹æ€§ï¼Œè¿˜æ˜¯å»ºè®®é€‰æ‹© Parquetã€‚ ","date":"2022-12-07","objectID":"/orc/:5:0","tags":["æ•°ä»“"],"title":"ORC å’Œ Parquet æ–‡ä»¶å­˜å‚¨æ ¼å¼","uri":"/orc/"},{"categories":["å­¦ä¹ "],"content":"å‚è€ƒé“¾æ¥ æ–‡ä»¶å­˜å‚¨æ ¼å¼ï¼šORC ä¸ Parquetçš„è¾ƒé‡ å¹²è´§ | å†æ¥èŠä¸€èŠ Parquet åˆ—å¼å­˜å‚¨æ ¼å¼ ","date":"2022-12-07","objectID":"/orc/:6:0","tags":["æ•°ä»“"],"title":"ORC å’Œ Parquet æ–‡ä»¶å­˜å‚¨æ ¼å¼","uri":"/orc/"},{"categories":["å­¦ä¹ "],"content":"è¯¦è§£MapReduce Shuffleä¸Spark Shuffle","date":"2022-12-07","objectID":"/shuffle/","tags":["æ•°ä»“"],"title":"è¯¦è§£MapReduce Shuffleä¸Spark Shuffle","uri":"/shuffle/"},{"categories":["å­¦ä¹ "],"content":"æœ¬æ–‡ä»‹ç» MapReduce Shuffle ä¸ Spark Shuffle çš„è¯¦æƒ…å’ŒåŒºåˆ«ã€‚ ","date":"2022-12-07","objectID":"/shuffle/:0:0","tags":["æ•°ä»“"],"title":"è¯¦è§£MapReduce Shuffleä¸Spark Shuffle","uri":"/shuffle/"},{"categories":["å­¦ä¹ "],"content":"Shuffleç®€ä»‹ Shuffle çš„æœ¬æ„æ˜¯æ´—ç‰Œã€æ··æ´—çš„æ„æ€ï¼ŒæŠŠä¸€ç»„æœ‰è§„åˆ™çš„æ•°æ®å°½é‡æ‰“ä¹±æˆæ— è§„åˆ™çš„æ•°æ®ã€‚è€Œåœ¨ MapReduce ä¸­ï¼ŒShuffle æ›´åƒæ˜¯æ´—ç‰Œçš„é€†è¿‡ç¨‹ï¼ŒæŒ‡çš„æ˜¯å°† map ç«¯çš„æ— è§„åˆ™è¾“å‡ºæŒ‰æŒ‡å®šçš„è§„åˆ™â€œæ‰“ä¹±â€æˆå…·æœ‰ä¸€å®šè§„åˆ™çš„æ•°æ®ï¼Œä»¥ä¾¿ reduce ç«¯æ¥æ”¶å¤„ç†ã€‚æˆ–è€…è¯´éœ€è¦å°†å„èŠ‚ç‚¹ä¸ŠåŒä¸€ç±»æ•°æ®æ±‡é›†åˆ°æŸä¸€èŠ‚ç‚¹è¿›è¡Œè®¡ç®—ï¼ŒæŠŠè¿™äº›åˆ†å¸ƒåœ¨ä¸åŒèŠ‚ç‚¹çš„æ•°æ®æŒ‰ç…§ä¸€å®šçš„è§„åˆ™èšé›†åˆ°ä¸€èµ·çš„è¿‡ç¨‹ç§°ä¸º Shuffleã€‚ åœ¨ Shuffle ä¹‹å‰ï¼Œä¹Ÿå°±æ˜¯åœ¨ map é˜¶æ®µï¼ŒMapReduce ä¼šå¯¹è¦å¤„ç†çš„æ•°æ®è¿›è¡Œåˆ†ç‰‡splitæ“ä½œï¼Œä¸ºæ¯ä¸€ä¸ªåˆ†ç‰‡åˆ†é…ä¸€ä¸ª MapTask ä»»åŠ¡ã€‚æ¥ä¸‹æ¥ map ä¼šå¯¹æ¯ä¸€ä¸ªåˆ†ç‰‡ä¸­çš„æ¯ä¸€è¡Œæ•°æ®è¿›è¡Œå¤„ç†å¾—åˆ°é”®å€¼å¯¹ï¼ˆkey,valueï¼‰ï¼Œæ­¤æ—¶å¾—åˆ°çš„é”®å€¼å¯¹åˆå«åšâ€œä¸­é—´ç»“æœâ€ã€‚æ­¤åä¾¿è¿›å…¥ reduce é˜¶æ®µï¼Œç”±æ­¤å¯ä»¥çœ‹å‡º Shuffle é˜¶æ®µçš„ä½œç”¨æ˜¯å¤„ç†â€œä¸­é—´ç»“æœâ€ã€‚ ç”±äº Shuffle æ¶‰åŠåˆ°äº†ç£ç›˜çš„è¯»å†™å’Œç½‘ç»œçš„ä¼ è¾“ï¼Œå› æ­¤ Shuffle æ€§èƒ½çš„é«˜ä½ç›´æ¥å½±å“åˆ°äº†æ•´ä¸ªç¨‹åºçš„è¿è¡Œæ•ˆç‡ã€‚ ","date":"2022-12-07","objectID":"/shuffle/:1:0","tags":["æ•°ä»“"],"title":"è¯¦è§£MapReduce Shuffleä¸Spark Shuffle","uri":"/shuffle/"},{"categories":["å­¦ä¹ "],"content":"MapReduce Shuffle Hadoop çš„æ ¸å¿ƒæ€æƒ³æ˜¯ MapReduceï¼Œä½† Shuffle åˆæ˜¯ MapReduce çš„æ ¸å¿ƒã€‚Shuffle çš„ä¸»è¦å·¥ä½œæ˜¯ä» Map ç»“æŸåˆ° Reduce å¼€å§‹ä¹‹é—´çš„è¿‡ç¨‹ã€‚Shuffle é˜¶æ®µåˆå¯ä»¥åˆ†ä¸º Map ç«¯çš„ Shuffle å’Œ Reduce ç«¯çš„ Shuffleã€‚ ","date":"2022-12-07","objectID":"/shuffle/:2:0","tags":["æ•°ä»“"],"title":"è¯¦è§£MapReduce Shuffleä¸Spark Shuffle","uri":"/shuffle/"},{"categories":["å­¦ä¹ "],"content":"Spark Shuffle Spark ä¸°å¯Œäº†ä»»åŠ¡ç±»å‹ï¼Œæœ‰äº›ä»»åŠ¡ä¹‹é—´æ•°æ®æµè½¬ä¸éœ€è¦é€šè¿‡ Shuffleï¼Œä½†æ˜¯æœ‰äº›ä»»åŠ¡ä¹‹é—´è¿˜æ˜¯éœ€è¦é€šè¿‡ Shuffle æ¥ä¼ é€’æ•°æ®ï¼Œæ¯”å¦‚å®½ä¾èµ–çš„ group by key ä»¥åŠå„ç§ by key ç®—å­ã€‚å®½ä¾èµ–ä¹‹é—´ä¼šåˆ’åˆ† stageï¼Œè€Œ Stage ä¹‹é—´å°±æ˜¯ Shuffleï¼Œå¦‚ä¸‹å›¾ä¸­çš„ stage0ï¼Œstage1 å’Œ stage3 ä¹‹é—´å°±ä¼šäº§ç”Ÿ Shuffleã€‚ stage åœ¨ Spark ä¸­ï¼Œè´Ÿè´£ shuffle è¿‡ç¨‹çš„æ‰§è¡Œã€è®¡ç®—å’Œå¤„ç†çš„ç»„ä»¶ä¸»è¦å°±æ˜¯ ShuffleManagershuffleç®¡ç†å™¨ã€‚ShuffleManager éšç€ Spark çš„å‘å±•æœ‰ä¸¤ç§å®ç°çš„æ–¹å¼ï¼Œåˆ†åˆ«ä¸º HashShuffleManager å’Œ SortShuffleManagerï¼Œå› æ­¤ spark çš„ Shuffle æœ‰ Hash Shuffle å’Œ Sort Shuffle ä¸¤ç§ã€‚ ","date":"2022-12-07","objectID":"/shuffle/:3:0","tags":["æ•°ä»“"],"title":"è¯¦è§£MapReduce Shuffleä¸Spark Shuffle","uri":"/shuffle/"},{"categories":["å­¦ä¹ "],"content":"Spark ä¸ MapReduce Shuffle çš„å¼‚åŒ ä»æ•´ä½“åŠŸèƒ½ä¸Šçœ‹ï¼Œä¸¤è€…å¹¶æ²¡æœ‰å¤§çš„å·®åˆ«ã€‚éƒ½æ˜¯å°† mapperï¼ˆSpark é‡Œæ˜¯ ShuffleMapTaskï¼‰çš„è¾“å‡ºè¿›è¡Œ partitionï¼Œä¸åŒçš„ partition é€åˆ°ä¸åŒçš„ reducerã€‚ ä»æµç¨‹çš„ä¸Šçœ‹ï¼Œä¸¤è€…å·®åˆ«ä¸å°ã€‚MapReduce æ˜¯ sort-basedï¼Œè¿›å…¥ combine å’Œ reduceçš„ records å¿…é¡»å…ˆ sortã€‚è¿™æ ·çš„å¥½å¤„åœ¨äº combine/reduce å¯ä»¥å¤„ç†å¤§è§„æ¨¡çš„æ•°æ®ï¼Œå› ä¸ºå…¶è¾“å…¥æ•°æ®å¯ä»¥é€šè¿‡å¤–æ’å¾—åˆ°ï¼ˆmapper å¯¹æ¯æ®µæ•°æ®å…ˆåšæ’åºï¼Œreducer çš„ shuffle å¯¹æ’å¥½åºçš„æ¯æ®µæ•°æ®åšå½’å¹¶ï¼‰ã€‚ä»¥å‰ Spark é»˜è®¤é€‰æ‹©çš„æ˜¯ hash-basedï¼Œé€šå¸¸ä½¿ç”¨ HashMap æ¥å¯¹ shuffle æ¥çš„æ•°æ®è¿›è¡Œåˆå¹¶ï¼Œä¸ä¼šå¯¹æ•°æ®è¿›è¡Œæå‰æ’åºã€‚å¦‚æœç”¨æˆ·éœ€è¦ç»è¿‡æ’åºçš„æ•°æ®ï¼Œé‚£ä¹ˆéœ€è¦è‡ªå·±è°ƒç”¨ç±»ä¼¼ sortByKey çš„æ“ä½œã€‚ ä»æµç¨‹å®ç°è§’åº¦æ¥çœ‹ï¼Œä¸¤è€…ä¹Ÿæœ‰ä¸å°‘å·®åˆ«ã€‚MapReduce å°†å¤„ç†æµç¨‹åˆ’åˆ†å‡ºæ˜æ˜¾çš„å‡ ä¸ªé˜¶æ®µï¼šmap, spill, merge, shuffle, sort, reduce ç­‰ã€‚æ¯ä¸ªé˜¶æ®µå„å¸å…¶èŒï¼Œå¯ä»¥æŒ‰ç…§è¿‡ç¨‹å¼çš„ç¼–ç¨‹æ€æƒ³æ¥é€ä¸€å®ç°æ¯ä¸ªé˜¶æ®µçš„åŠŸèƒ½ã€‚åœ¨ Spark ä¸­ï¼Œæ²¡æœ‰è¿™æ ·åŠŸèƒ½æ˜ç¡®çš„é˜¶æ®µï¼Œåªæœ‰ä¸åŒçš„ stage å’Œä¸€ç³»åˆ—çš„ transformationï¼Œæ‰€ä»¥ spill, merge, aggregate ç­‰æ“ä½œéœ€è¦è•´å«åœ¨ transformationä¸­ã€‚ ä¸ MapReduce å®Œå…¨ä¸ä¸€æ ·çš„æ˜¯ï¼Œåœ¨ MapReduce ä¸­ï¼Œmap task å¿…é¡»å°†æ‰€æœ‰çš„æ•°æ®éƒ½å†™å…¥æœ¬åœ°ç£ç›˜æ–‡ä»¶ä»¥åï¼Œæ‰èƒ½å¯åŠ¨ reduce æ“ä½œï¼Œæ¥æ‹‰å–æ•°æ®ã€‚ä¸ºä»€ä¹ˆï¼Ÿå› ä¸º mapreduce è¦å®ç°é»˜è®¤çš„æ ¹æ® key çš„æ’åºï¼æ‰€ä»¥è¦æ’åºï¼Œè‚¯å®šå¾—å†™å®Œæ‰€æœ‰æ•°æ®ï¼Œæ‰èƒ½æ’åºï¼Œç„¶å reduce æ¥æ‹‰å–ã€‚ ä½†æ˜¯ Spark ä¸éœ€è¦ï¼Œspark é»˜è®¤æƒ…å†µä¸‹ï¼Œæ˜¯ä¸ä¼šå¯¹æ•°æ®è¿›è¡Œæ’åºçš„ã€‚å› æ­¤ ShuffleMapTask æ¯å†™å…¥ä¸€ç‚¹æ•°æ®ï¼ŒResultTask å°±å¯ä»¥æ‹‰å–ä¸€ç‚¹æ•°æ®ï¼Œç„¶ååœ¨æœ¬åœ°æ‰§è¡Œæˆ‘ä»¬å®šä¹‰çš„èšåˆå‡½æ•°å’Œç®—å­ï¼Œè¿›è¡Œè®¡ç®—ã€‚ ","date":"2022-12-07","objectID":"/shuffle/:4:0","tags":["æ•°ä»“"],"title":"è¯¦è§£MapReduce Shuffleä¸Spark Shuffle","uri":"/shuffle/"},{"categories":["å­¦ä¹ "],"content":"å¤§æ•°æ®â€”â€”Hive SQLä¼˜åŒ–","date":"2022-12-07","objectID":"/hive-youhua/","tags":["æ•°ä»“"],"title":"å¤§æ•°æ®â€”â€”Hive SQLä¼˜åŒ–","uri":"/hive-youhua/"},{"categories":["å­¦ä¹ "],"content":"æœ¬æ–‡ä»‹ç»ä¸€äº› hive çš„å¸¸è§ä¼˜åŒ–æ–¹æ¡ˆã€‚ ","date":"2022-12-07","objectID":"/hive-youhua/:0:0","tags":["æ•°ä»“"],"title":"å¤§æ•°æ®â€”â€”Hive SQLä¼˜åŒ–","uri":"/hive-youhua/"},{"categories":["å­¦ä¹ "],"content":"SELECT å­—æ®µå°½å¯èƒ½å°‘ï¼Œæ•°æ®è¿‡æ»¤å°½å¯èƒ½æå‰ SELECT ","date":"2022-12-07","objectID":"/hive-youhua/:1:0","tags":["æ•°ä»“"],"title":"å¤§æ•°æ®â€”â€”Hive SQLä¼˜åŒ–","uri":"/hive-youhua/"},{"categories":["å­¦ä¹ "],"content":"èƒ½ä¸ç”¨ JOIN è¿æ¥çš„å°±ä¸ç”¨ join ","date":"2022-12-07","objectID":"/hive-youhua/:2:0","tags":["æ•°ä»“"],"title":"å¤§æ•°æ®â€”â€”Hive SQLä¼˜åŒ–","uri":"/hive-youhua/"},{"categories":["å­¦ä¹ "],"content":"æ•°æ®å€¾æ–œé—®é¢˜ ","date":"2022-12-07","objectID":"/hive-youhua/:3:0","tags":["æ•°ä»“"],"title":"å¤§æ•°æ®â€”â€”Hive SQLä¼˜åŒ–","uri":"/hive-youhua/"},{"categories":["å­¦ä¹ "],"content":"JOIN ä¼˜åŒ– é€‰ç”¨ join key åˆ†å¸ƒæœ€å‡åŒ€çš„è¡¨ä½œä¸ºé©±åŠ¨è¡¨ï¼Œå¹¶ä¸”å¤§è¡¨æ”¾åœ¨å³è¾¹ï¼Œå°è¡¨æ”¾åœ¨å·¦è¾¹ã€‚ ","date":"2022-12-07","objectID":"/hive-youhua/:3:1","tags":["æ•°ä»“"],"title":"å¤§æ•°æ®â€”â€”Hive SQLä¼˜åŒ–","uri":"/hive-youhua/"},{"categories":["å­¦ä¹ "],"content":"æ’åºä¼˜åŒ– sort by ä»£æ›¿ order by ","date":"2022-12-07","objectID":"/hive-youhua/:3:2","tags":["æ•°ä»“"],"title":"å¤§æ•°æ®â€”â€”Hive SQLä¼˜åŒ–","uri":"/hive-youhua/"},{"categories":["å­¦ä¹ "],"content":"å°‘ç”¨count(distinct) ç”¨ group by ä»£æ›¿ count(distinct) select count(*) from (select uid from testmac group by uid) t ","date":"2022-12-07","objectID":"/hive-youhua/:3:3","tags":["æ•°ä»“"],"title":"å¤§æ•°æ®â€”â€”Hive SQLä¼˜åŒ–","uri":"/hive-youhua/"},{"categories":["å­¦ä¹ "],"content":"å¤šè¡¨ join æ—¶ key ä¿æŒä¸€è‡´ å½“å¯¹å¤šä¸ªè¡¨è¿›è¡Œ join è¿æ¥æ—¶ï¼Œå¦‚æœæ¯ä¸ª on å­å¥éƒ½ä½¿ç”¨ç›¸åŒçš„è¿æ¥é”®çš„è¯ï¼Œé‚£ä¹ˆåªä¼šäº§ç”Ÿä¸€ä¸ª MapReduce jobï¼Œæ‰§è¡Œæ•ˆç‡ç›¸å¯¹å¿«ã€‚ ","date":"2022-12-07","objectID":"/hive-youhua/:4:0","tags":["æ•°ä»“"],"title":"å¤§æ•°æ®â€”â€”Hive SQLä¼˜åŒ–","uri":"/hive-youhua/"},{"categories":["å­¦ä¹ "],"content":"å»é™¤ç©ºå€¼å’Œæ— æ„ä¹‰çš„å€¼ å‡ºç°ç©ºå€¼æˆ–æ— æ„ä¹‰å€¼æ—¶ï¼Œå¦‚nullï¼Œç©ºå­—ç¬¦ä¸²ã€-1ç­‰ï¼Œåœ¨åš join æ—¶è¿™äº›ç©ºå€¼å°±ä¼šéå¸¸é›†ä¸­ï¼Œæ‹–ç´¯è¿›åº¦ã€‚å› æ­¤ï¼Œè‹¥ä¸éœ€è¦ç©ºå€¼æ•°æ®ï¼Œå°±æå‰å†™ where è¯­å¥è¿‡æ»¤æ‰ã€‚è‹¥éœ€è¦ä¿ç•™ï¼Œå°†ç©ºå€¼ null çš„è®°å½•éšæœºæ”¹ä¸ºè´Ÿå€¼ï¼š ","date":"2022-12-07","objectID":"/hive-youhua/:5:0","tags":["æ•°ä»“"],"title":"å¤§æ•°æ®â€”â€”Hive SQLä¼˜åŒ–","uri":"/hive-youhua/"},{"categories":["å­¦ä¹ "],"content":"SQL-MySQLçª—å£å‡½æ•°å’Œå•è¡Œå‡½æ•°çš„ä½¿ç”¨","date":"2022-12-07","objectID":"/sql-window/","tags":["SQL"],"title":"SQL-MySQLçª—å£å‡½æ•°å’Œå•è¡Œå‡½æ•°çš„ä½¿ç”¨","uri":"/sql-window/"},{"categories":["å­¦ä¹ "],"content":"çª—å£å‡½æ•°ä¹Ÿå«OLAPå‡½æ•°ï¼ˆOnline Anallytical Processingè”æœºåˆ†æå¤„ç†ï¼‰ï¼Œå¯ä»¥å¯¹æ•°æ®è¿›è¡Œå®æ—¶åˆ†æå¤„ç†ã€‚çª—å£å‡½æ•°æ˜¯é¢è¯•ä¸­è€ƒå¯Ÿçš„é‡ç‚¹ã€‚çª—å£å‡½æ•°é€šå¸¸ç”¨æ¥è§£å†³ç»Ÿè®¡æ±‡æ€»ã€æ’åã€TopNã€è¿ç»­ç™»å½•å¤©æ•°ç­‰é—®é¢˜ã€‚ ","date":"2022-12-07","objectID":"/sql-window/:0:0","tags":["SQL"],"title":"SQL-MySQLçª—å£å‡½æ•°å’Œå•è¡Œå‡½æ•°çš„ä½¿ç”¨","uri":"/sql-window/"},{"categories":["å­¦ä¹ "],"content":"çª—å£å‡½æ•° è¯­æ³•ï¼šå‡½æ•°å(å­—æ®µå) over(partition by \u003cè¦åˆ†åˆ—çš„ç»„\u003e order by \u003cè¦æ’åºçš„åˆ—\u003e rows between \u003cæ•°æ®èŒƒå›´\u003e) æ•°æ®èŒƒå›´ï¼šé€šè¿‡ä¸‹é¢çš„æ¡ˆä¾‹æ¥è®²è§£æ•°æ®èŒƒå›´å¦‚ä½•ä½¿ç”¨ã€‚ # å–æœ¬è¡Œå’Œå‰é¢ä¸¤è¡Œ rows between 2 preceding and current row # å–æœ¬è¡Œå’Œä¹‹å‰æ‰€æœ‰çš„è¡Œ rows between unbounded preceding and current row # å–æœ¬è¡Œå’Œä¹‹åæ‰€æœ‰çš„è¡Œ rows between current row and unbounded following # ä»å‰é¢ä¸‰è¡Œå’Œä¸‹é¢ä¸€è¡Œï¼Œæ€»å…±äº”è¡Œ rows between 3 preceding and 1 following # å½“order byåé¢æ²¡æœ‰rows betweenæ—¶ï¼Œçª—å£è§„èŒƒé»˜è®¤æ˜¯å–æœ¬è¡Œå’Œä¹‹å‰æ‰€æœ‰çš„è¡Œ # å½“order byå’Œrows betweenéƒ½æ²¡æœ‰æ—¶ï¼Œçª—å£è§„èŒƒé»˜è®¤æ˜¯åˆ†ç»„ä¸‹æ‰€æœ‰è¡Œï¼ˆrows between unbounded preceding and unbounded followingï¼‰ åˆ†ç±»ï¼šæŒ‰ç…§çª—å£å‡½æ•°çš„æ„ä¹‰å¤§æ¦‚å¯ä»¥åˆ†ä¸ºä¸‹é¢ 5 ç±»ï¼Œå…¶ä¸­æ’åºå‡½æ•°æœ€ä¸ºå¸¸ç”¨ã€‚ æ’åºå‡½æ•°ï¼šrow_number()ã€rank()ã€dense_rank() åˆ†å¸ƒå‡½æ•°ï¼špercent_rank()ã€cume_dist() ç›¸å¯¹ä½ç½®å‡½æ•°ï¼šlag(expr,n)ã€lead(expr,n)ï¼Œç”¨äºè¿”å›æŸå­—æ®µçš„å‰ n è¡Œæˆ–å n è¡Œçš„å€¼ã€‚expr æ—¢å¯ä»¥æ˜¯è¡¨è¾¾å¼ä¹Ÿå¯ä»¥æ˜¯åˆ—åã€‚ ç»å¯¹ä½ç½®å‡½æ•°ï¼šfirst_value(expr)ã€last_value(expr)ã€nth_value(expr,n)ï¼Œè¿”å›ç¬¬ä¸€ä¸ªæˆ–æœ€åä¸€ä¸ªæˆ–ç¬¬ n ä¸ª expr çš„å€¼ã€‚ åˆ†æ¡¶å‡½æ•°ï¼šntile(x) å¦å¤–ï¼Œèšåˆå‡½æ•°ä¹Ÿå¯ä»¥ä½œä¸ºçª—å£å‡½æ•°ä½¿ç”¨ï¼š èšåˆå‡½æ•°ï¼šavg()ï¼Œsum()ï¼Œmin()ï¼Œmax() ","date":"2022-12-07","objectID":"/sql-window/:1:0","tags":["SQL"],"title":"SQL-MySQLçª—å£å‡½æ•°å’Œå•è¡Œå‡½æ•°çš„ä½¿ç”¨","uri":"/sql-window/"},{"categories":["å­¦ä¹ "],"content":"æ’åºå‡½æ•° row_number()ï¼šå¯¹æ¯ä¸€è¡Œåˆ†é…ä¸€ä¸ªåºå·ï¼Œåºå·è¿ç»­åŠ 1ï¼Œä¸ä¼šé‡å¤ã€‚å¸¸ç”¨äºæ’åºã€‚ rank()ï¼šç»™æ¯è¡Œåˆ†é…ä¸€ä¸ªåºå·ï¼Œç›¸åŒå€¼çš„åºå·ç›¸åŒï¼Œåºå·ä¸è¿ç»­ã€‚å¸¸ç”¨äºæ’åºã€‚ dense_rank()ï¼šç»™æ¯è¡Œåˆ†é…ä¸€ä¸ªåºå·ï¼Œç›¸åŒå€¼çš„åºå·ç›¸åŒï¼Œåºå·è¿ç»­ã€‚å¸¸ç”¨äºæ’åºã€‚ ","date":"2022-12-07","objectID":"/sql-window/:1:1","tags":["SQL"],"title":"SQL-MySQLçª—å£å‡½æ•°å’Œå•è¡Œå‡½æ•°çš„ä½¿ç”¨","uri":"/sql-window/"},{"categories":["å­¦ä¹ "],"content":"åˆ†å¸ƒå‡½æ•° percent_rank()ï¼šæ¯è¡ŒæŒ‰ç…§å…¬å¼$(rank-1) / (rows-1)$è¿›è¡Œè®¡ç®—ã€‚å…¶ä¸­ï¼Œrank ä¸º RANK() å‡½æ•°äº§ç”Ÿçš„åºå·ï¼Œrows ä¸ºå½“å‰çª—å£çš„è®°å½•æ€»è¡Œæ•°ã€‚ cume_dist()ï¼šåˆ†ç»„å†…å°äºã€ç­‰äºå½“å‰ rank å€¼çš„è¡Œæ•° / åˆ†ç»„å†…æ€»è¡Œæ•° ","date":"2022-12-07","objectID":"/sql-window/:1:2","tags":["SQL"],"title":"SQL-MySQLçª—å£å‡½æ•°å’Œå•è¡Œå‡½æ•°çš„ä½¿ç”¨","uri":"/sql-window/"},{"categories":["å­¦ä¹ "],"content":"ç›¸å¯¹ä½ç½®å‡½æ•° lag(expr,n)ï¼šè¿”å›ä½äºå½“å‰è¡Œçš„å‰ n è¡Œçš„å€¼ lead(expr,n)ï¼šè¿”å›ä½äºå½“å‰è¡Œçš„å n è¡Œçš„å€¼ ","date":"2022-12-07","objectID":"/sql-window/:1:3","tags":["SQL"],"title":"SQL-MySQLçª—å£å‡½æ•°å’Œå•è¡Œå‡½æ•°çš„ä½¿ç”¨","uri":"/sql-window/"},{"categories":["å­¦ä¹ "],"content":"ç»å¯¹ä½ç½®å‡½æ•° first_value(expr)ï¼šè¿”å›ç¬¬ä¸€ä¸ª expr çš„å€¼ã€‚ last_value(expr)ï¼šè¿”å›æœ€åä¸€ä¸ª expr çš„å€¼ã€‚ nth_value(expr,n)ï¼šè¿”å›çª—å£ä¸­ç¬¬ n ä¸ª expr çš„å€¼ã€‚ åº”ç”¨åœºæ™¯ 1 ä¸¾ä¾‹ï¼šæ±‚é¦–æ¬¡ç™»å½•å’Œæœ«æ¬¡ç™»å½•æ—¶é—´ select id, log_dt, first_value(log_dt) over(partition by id order by log_dt) f_dt, last_value(log_dt) over(partition by id order by log_dt) l_dt from tb; id log_dt f_dt l_dt 1 2020-11-10 2020-11-10 2020-11-10 1 2021-01-20 2020-11-10 2021-01-20 1 2021-08-12 2020-11-10 2021-08-12 2 2021-12-05 2021-12-05 2021-12-05 2 2021-12-29 2021-12-05 2021-12-29 åº”ç”¨åœºæ™¯ 2 ä¸¾ä¾‹ï¼šæ±‚éƒ¨é—¨ä¸­å·¥èµ„ç¬¬äºŒçš„å‘˜å·¥ SELECT id, dept_id did, salary s, NTH_VALUE(salary,2) over(PARTITION BY dept_id ORDER BY salary DESC) s2 FROM employee; id did s s2 2 1 200 100 1 1 100 100 4 2 400 300 3 2 300 300 6 3 560 500 5 3 500 500 ","date":"2022-12-07","objectID":"/sql-window/:1:4","tags":["SQL"],"title":"SQL-MySQLçª—å£å‡½æ•°å’Œå•è¡Œå‡½æ•°çš„ä½¿ç”¨","uri":"/sql-window/"},{"categories":["å­¦ä¹ "],"content":"åˆ†æ¡¶å‡½æ•° ntile(n)ï¼šå¯¹æ¯ä¸ªåˆ†åŒºç»§ç»­åˆ†æˆ n ç»„ï¼Œæ¯ç»„çš„è¡Œæ•°ä¸ºï¼šåˆ†åŒºçš„æ€»è¡Œæ•° / nã€‚ä¸å¸¸ç”¨ã€‚ ","date":"2022-12-07","objectID":"/sql-window/:1:5","tags":["SQL"],"title":"SQL-MySQLçª—å£å‡½æ•°å’Œå•è¡Œå‡½æ•°çš„ä½¿ç”¨","uri":"/sql-window/"},{"categories":["å­¦ä¹ "],"content":"æ—¥æœŸæ—¶é—´å‡½æ•° CURDATE() æˆ– CURRENT_DATE() è¿”å›å½“å‰æ—¥æœŸ NOW() è¿”å›å½“å‰ç³»ç»Ÿæ—¥æœŸæ—¶é—´ YEAR(date) è¿”å›å¹´ MONTH(date) è¿”å›æœˆ DAY(date) è¿”å›æ—¥ DATEDIFF(date1,date2) è¿”å› date1 - date2 çš„æ—¥æœŸé—´éš” DATE_FORMAT(datetime ,fmt) æŒ‰ç…§å­—ç¬¦ä¸² fmt æ ¼å¼åŒ–æ—¥æœŸ datetime å€¼ã€‚ %Y 4 ä½æ•°å­—è¡¨ç¤ºå¹´ä»½ %m ä¸¤ä½æ•°å­—è¡¨ç¤ºæœˆä»½ï¼ˆ01,02,03,â€¦ï¼‰ %d ä¸¤ä½æ•°å­—è¡¨ç¤ºæœˆä¸­çš„å¤©æ•°(01,02â€¦) %H ä¸¤ä½æ•°å­—è¡¨ç¤ºå°æ—¶ï¼Œ24å°æ—¶åˆ¶ï¼ˆ01,02,â€¦ï¼‰ ","date":"2022-12-07","objectID":"/sql-window/:2:0","tags":["SQL"],"title":"SQL-MySQLçª—å£å‡½æ•°å’Œå•è¡Œå‡½æ•°çš„ä½¿ç”¨","uri":"/sql-window/"},{"categories":["å­¦ä¹ "],"content":"æµç¨‹å‡½æ•° IF(value,t ,f) å¦‚æœ value æ˜¯çœŸï¼Œè¿”å› tï¼Œå¦åˆ™è¿”å› f IFNULL(value1, value2) å¦‚æœ value1 ä¸ä¸ºç©ºï¼Œè¿”å› value1ï¼Œå¦åˆ™è¿”å› value2 CASE WHEN ","date":"2022-12-07","objectID":"/sql-window/:3:0","tags":["SQL"],"title":"SQL-MySQLçª—å£å‡½æ•°å’Œå•è¡Œå‡½æ•°çš„ä½¿ç”¨","uri":"/sql-window/"},{"categories":["å­¦ä¹ "],"content":"æ•°å­¦å‡½æ•° ABS(x) è¿”å› x çš„ç»å¯¹å€¼ CEIL(x) è¿”å›å¤§äº x çš„æœ€å°æ•´æ•°å€¼ FLOOR(x) è¿”å›å°äº x çš„æœ€å¤§æ•´æ•°å€¼ MOD(x,y) è¿”å› x/y çš„æ¨¡ RAND(x) è¿”å› 0~1 çš„éšæœºå€¼ï¼Œxå¯ä»¥ä¸å†™ ROUND(x,y) è¿”å›å‚æ•° x çš„å››èˆäº”å…¥çš„æœ‰ y ä½çš„å°æ•°çš„å€¼ TRUNCATE(x,y) è¿”å›æ•°å­— x æˆªæ–­ä¸º y ä½å°æ•°çš„ç»“æœ SQRT(x) è¿”å› x çš„å¹³æ–¹æ ¹ POW(x,y) è¿”å› x çš„ y æ¬¡æ–¹ ","date":"2022-12-07","objectID":"/sql-window/:4:0","tags":["SQL"],"title":"SQL-MySQLçª—å£å‡½æ•°å’Œå•è¡Œå‡½æ•°çš„ä½¿ç”¨","uri":"/sql-window/"},{"categories":["å­¦ä¹ "],"content":"å­—ç¬¦ä¸²å‡½æ•° CONCAT(S1,S2,......,Sn) è¿æ¥ S1, S2, ......, Sn ä¸ºä¸€ä¸ªå­—ç¬¦ä¸² CONCAT_WS(separator, S1, S2, ......, Sn) åŒ CONCAT(s1, s2, ...) å‡½æ•°ï¼Œä½†æ˜¯æ¯ä¸ªå­—ç¬¦ä¸²ä¹‹é—´è¦åŠ ä¸Šåˆ†éš”ç¬¦ separatoråˆ†éš”ç¬¦ TRIM(s) å»æ‰å­—ç¬¦ä¸² s å¼€å§‹ä¸ç»“å°¾çš„ç©ºæ ¼ ","date":"2022-12-07","objectID":"/sql-window/:5:0","tags":["SQL"],"title":"SQL-MySQLçª—å£å‡½æ•°å’Œå•è¡Œå‡½æ•°çš„ä½¿ç”¨","uri":"/sql-window/"},{"categories":["å­¦ä¹ "],"content":"å›¾æ–‡è¯¦è§£ MapReduce å·¥ä½œæµç¨‹","date":"2022-12-07","objectID":"/mapreduce/","tags":["æ•°ä»“"],"title":"å›¾æ–‡è¯¦è§£ MapReduce å·¥ä½œæµç¨‹","uri":"/mapreduce/"},{"categories":["å­¦ä¹ "],"content":"æœ¬æ–‡ä¼šè¯¦è§£ MapReduce å·¥ä½œæµç¨‹ã€‚ MRå·¥ä½œæµç¨‹ ","date":"2022-12-07","objectID":"/mapreduce/:0:0","tags":["æ•°ä»“"],"title":"å›¾æ–‡è¯¦è§£ MapReduce å·¥ä½œæµç¨‹","uri":"/mapreduce/"},{"categories":["å­¦ä¹ "],"content":"MapReduce ç¼–ç¨‹æ¨¡å‹ MapReduce ç¼–ç¨‹æ¨¡å‹å¼€å‘ç®€å•ä¸”åŠŸèƒ½å¼ºå¤§ï¼Œä¸“é—¨ä¸ºå¹¶è¡Œå¤„ç†å¤§è§„æ¨¡æ•°æ®é‡è€Œè®¾è®¡ï¼Œæ¥ä¸‹æ¥ï¼Œé€šè¿‡ä¸€å¼ å›¾æ¥æè¿° MapReduce çš„å·¥ä½œè¿‡ç¨‹ï¼Œå¦‚å›¾æ‰€ç¤ºã€‚ å·¥ä½œæµç¨‹ ","date":"2022-12-07","objectID":"/mapreduce/:1:0","tags":["æ•°ä»“"],"title":"å›¾æ–‡è¯¦è§£ MapReduce å·¥ä½œæµç¨‹","uri":"/mapreduce/"},{"categories":["å­¦ä¹ "],"content":"æ•´ä½“æµç¨‹ åœ¨ä¸Šå›¾ä¸­ï¼Œ MapReduce5 çš„å·¥ä½œæµç¨‹å¤§è‡´å¯ä»¥åˆ†ä¸º5æ­¥ï¼Œå…·ä½“å¦‚ä¸‹: 5æ­¥ ","date":"2022-12-07","objectID":"/mapreduce/:2:0","tags":["æ•°ä»“"],"title":"å›¾æ–‡è¯¦è§£ MapReduce å·¥ä½œæµç¨‹","uri":"/mapreduce/"},{"categories":["å­¦ä¹ "],"content":"åˆ†ç‰‡ã€æ ¼å¼åŒ–æ•°æ®æº è¾“å…¥ Map é˜¶æ®µçš„æ•°æ®æºï¼Œå¿…é¡»ç»è¿‡åˆ†ç‰‡å’Œæ ¼å¼åŒ–æ“ä½œã€‚ åˆ†ç‰‡æ“ä½œï¼šæŒ‡çš„æ˜¯å°†æºæ–‡ä»¶åˆ’åˆ†ä¸ºå¤§å°ç›¸ç­‰çš„å°æ•°æ®å—(Hadoop 2.x ä¸­é»˜è®¤ 128MB)ï¼Œä¹Ÿå°±æ˜¯åˆ†ç‰‡(split)ï¼ŒHadoop ä¼šä¸ºæ¯ä¸€ä¸ªåˆ†ç‰‡æ„å»ºä¸€ä¸ª Map ä»»åŠ¡ï¼Œå¹¶ç”±è¯¥ä»»åŠ¡è¿è¡Œè‡ªå®šä¹‰çš„ map() å‡½æ•°ï¼Œä»è€Œå¤„ç†åˆ†ç‰‡é‡Œçš„æ¯ä¸€æ¡è®°å½•; æ ¼å¼åŒ–æ“ä½œï¼šå°†åˆ’åˆ†å¥½çš„åˆ†ç‰‡(split)æ ¼å¼åŒ–ä¸ºé”®å€¼å¯¹ \u003ckey,value\u003e å½¢å¼çš„æ•°æ®ï¼Œå…¶ä¸­ï¼Œkey ä»£è¡¨åç§»é‡ï¼Œvalue ä»£è¡¨æ¯ä¸€è¡Œå†…å®¹ã€‚ ","date":"2022-12-07","objectID":"/mapreduce/:2:1","tags":["æ•°ä»“"],"title":"å›¾æ–‡è¯¦è§£ MapReduce å·¥ä½œæµç¨‹","uri":"/mapreduce/"},{"categories":["å­¦ä¹ "],"content":"æ‰§è¡Œ MapTask æ¯ä¸ª Map ä»»åŠ¡éƒ½æœ‰ä¸€ä¸ªå†…å­˜ç¼“å†²åŒºç¼“å†²åŒºå¤§å°100MBï¼Œè¾“å…¥çš„åˆ†ç‰‡splitæ•°æ®ç»è¿‡ Map ä»»åŠ¡å¤„ç†åçš„ä¸­é—´ç»“æœä¼šå†™å…¥å†…å­˜ç¼“å†²åŒºä¸­ã€‚ å¦‚æœå†™å…¥çš„æ•°æ®è¾¾åˆ°å†…å­˜ç¼“å†²çš„é˜ˆå€¼80MBï¼Œä¼šå¯åŠ¨ä¸€ä¸ªçº¿ç¨‹å°†å†…å­˜ä¸­çš„æº¢å‡ºæ•°æ®å†™å…¥ç£ç›˜ï¼ŒåŒæ—¶ä¸å½±å“ Map ä¸­é—´ç»“æœç»§ç»­å†™å…¥ç¼“å†²åŒºã€‚ åœ¨æº¢å†™è¿‡ç¨‹ä¸­ï¼Œ MapReduce æ¡†æ¶ä¼šå¯¹ key è¿›è¡Œæ’åºï¼Œå¦‚æœä¸­é—´ç»“æœæ¯”è¾ƒå¤§ï¼Œä¼šå½¢æˆå¤šä¸ªæº¢å†™æ–‡ä»¶ï¼Œæœ€åçš„ç¼“å†²åŒºæ•°æ®ä¹Ÿä¼šå…¨éƒ¨æº¢å†™å…¥ç£ç›˜å½¢æˆä¸€ä¸ªæº¢å†™æ–‡ä»¶ï¼Œå¦‚æœæ˜¯å¤šä¸ªæº¢å†™æ–‡ä»¶ï¼Œåˆ™æœ€ååˆå¹¶æ‰€æœ‰çš„æº¢å†™æ–‡ä»¶ä¸ºä¸€ä¸ªæ–‡ä»¶ã€‚ ","date":"2022-12-07","objectID":"/mapreduce/:2:2","tags":["æ•°ä»“"],"title":"å›¾æ–‡è¯¦è§£ MapReduce å·¥ä½œæµç¨‹","uri":"/mapreduce/"},{"categories":["å­¦ä¹ "],"content":"æ‰§è¡Œ Shuffle è¿‡ç¨‹ MapReduce å·¥ä½œè¿‡ç¨‹ä¸­ï¼Œ Map é˜¶æ®µå¤„ç†çš„æ•°æ®å¦‚ä½•ä¼ é€’ç»™ Reduce é˜¶æ®µï¼Œè¿™æ˜¯ MapReduce æ¡†æ¶ä¸­å…³é”®çš„ä¸€ä¸ªè¿‡ç¨‹ï¼Œè¿™ä¸ªè¿‡ç¨‹å«ä½œ Shuffleã€‚ Shuffle ä¼šå°† MapTask è¾“å‡ºçš„å¤„ç†ç»“æœæ•°æ®åˆ†å‘ç»™ ReduceTaskï¼Œå¹¶åœ¨åˆ†å‘çš„è¿‡ç¨‹ä¸­ï¼Œå¯¹æ•°æ®æŒ‰ key è¿›è¡Œåˆ†åŒºå’Œæ’åºã€‚ ","date":"2022-12-07","objectID":"/mapreduce/:2:3","tags":["æ•°ä»“"],"title":"å›¾æ–‡è¯¦è§£ MapReduce å·¥ä½œæµç¨‹","uri":"/mapreduce/"},{"categories":["å­¦ä¹ "],"content":"æ‰§è¡Œ ReduceTask è¾“å…¥ ReduceTask çš„æ•°æ®æµæ˜¯ \u003ckey, {value list}\u003e å½¢å¼ï¼Œç”¨æˆ·å¯ä»¥è‡ªå®šä¹‰ reduce() æ–¹æ³•è¿›è¡Œé€»è¾‘å¤„ç†ï¼Œæœ€ç»ˆä»¥ \u003ckey, value\u003e çš„å½¢å¼è¾“å‡ºã€‚ ","date":"2022-12-07","objectID":"/mapreduce/:2:4","tags":["æ•°ä»“"],"title":"å›¾æ–‡è¯¦è§£ MapReduce å·¥ä½œæµç¨‹","uri":"/mapreduce/"},{"categories":["å­¦ä¹ "],"content":"å†™å…¥æ–‡ä»¶ MapReduce æ¡†æ¶ä¼šè‡ªåŠ¨æŠŠ ReduceTask ç”Ÿæˆçš„ \u003ckey, value\u003e ä¼ å…¥ OutputFormat çš„ write æ–¹æ³•ï¼Œå®ç°æ–‡ä»¶çš„å†™å…¥æ“ä½œã€‚ ","date":"2022-12-07","objectID":"/mapreduce/:2:5","tags":["æ•°ä»“"],"title":"å›¾æ–‡è¯¦è§£ MapReduce å·¥ä½œæµç¨‹","uri":"/mapreduce/"},{"categories":["å­¦ä¹ "],"content":"MapTask MapTask Read é˜¶æ®µï¼šMapTask é€šè¿‡ç”¨æˆ·ç¼–å†™çš„ RecordReaderï¼Œä»è¾“å…¥çš„ InputSplit ä¸­è§£æå‡ºä¸€ä¸ªä¸ª key / value ã€‚ Map é˜¶æ®µï¼šå°†è§£æå‡ºçš„ key / value äº¤ç»™ç”¨æˆ·ç¼–å†™çš„ Map() å‡½æ•°å¤„ç†ï¼Œå¹¶äº§ç”Ÿä¸€ç³»åˆ—æ–°çš„ key / valueã€‚ Collect é˜¶æ®µï¼šåœ¨ç”¨æˆ·ç¼–å†™çš„ map() å‡½æ•°ä¸­ï¼Œæ•°æ®å¤„ç†å®Œæˆåï¼Œä¸€èˆ¬ä¼šè°ƒç”¨ outputCollector.collect() è¾“å‡ºç»“æœï¼Œåœ¨è¯¥å‡½æ•°å†…éƒ¨ï¼Œå®ƒä¼šå°†ç”Ÿæˆçš„ key / value åˆ†ç‰‡(é€šè¿‡è°ƒç”¨ partitioner)ï¼Œå¹¶å†™å…¥ä¸€ä¸ªç¯å½¢å†…å­˜ç¼“å†²åŒºä¸­(è¯¥ç¼“å†²åŒºé»˜è®¤å¤§å°æ˜¯ 100MB )ã€‚ Spill é˜¶æ®µï¼šå³â€œæº¢å†™â€ï¼Œå½“ç¼“å†²åŒºå¿«è¦æº¢å‡ºæ—¶(é»˜è®¤è¾¾åˆ°ç¼“å†²åŒºå¤§å°çš„ 80 %)ï¼Œä¼šåœ¨æœ¬åœ°æ–‡ä»¶ç³»ç»Ÿåˆ›å»ºä¸€ä¸ªæº¢å‡ºæ–‡ä»¶ï¼Œå°†è¯¥ç¼“å†²åŒºçš„æ•°æ®å†™å…¥è¿™ä¸ªæ–‡ä»¶ã€‚ å°†æ•°æ®å†™å…¥æœ¬åœ°ç£ç›˜å‰ï¼Œå…ˆè¦å¯¹æ•°æ®è¿›è¡Œä¸€æ¬¡æœ¬åœ°æ’åºï¼Œå¹¶åœ¨å¿…è¦æ—¶å¯¹æ•°æ®è¿›è¡Œåˆå¹¶ã€å‹ç¼©ç­‰æ“ä½œã€‚ å†™å…¥ç£ç›˜ä¹‹å‰ï¼Œçº¿ç¨‹ä¼šæ ¹æ® ReduceTask çš„æ•°é‡ï¼Œå°†æ•°æ®åˆ†åŒºï¼Œä¸€ä¸ª Reduce ä»»åŠ¡å¯¹åº”ä¸€ä¸ªåˆ†åŒºçš„æ•°æ®ã€‚ è¿™æ ·åšçš„ç›®çš„æ˜¯ä¸ºäº†é¿å…æœ‰äº› Reduce ä»»åŠ¡åˆ†é…åˆ°å¤§é‡æ•°æ®ï¼Œè€Œæœ‰äº› Reduce ä»»åŠ¡åˆ†åˆ°å¾ˆå°‘çš„æ•°æ®ï¼Œç”šè‡³æ²¡æœ‰åˆ†åˆ°æ•°æ®çš„å°´å°¬å±€é¢ã€‚ å¦‚æœæ­¤æ—¶è®¾ç½®äº† Combiner ï¼Œå°†æ’åºåçš„ç»“æœè¿›è¡Œ Combine æ“ä½œï¼Œè¿™æ ·åšçš„ç›®çš„æ˜¯å°½å¯èƒ½å°‘åœ°æ‰§è¡Œæ•°æ®å†™å…¥ç£ç›˜çš„æ“ä½œã€‚ Combine é˜¶æ®µï¼šå½“æ‰€æœ‰æ•°æ®å¤„ç†å®Œæˆä»¥åï¼Œ MapTask ä¼šå¯¹æ‰€æœ‰ä¸´æ—¶æ–‡ä»¶è¿›è¡Œä¸€æ¬¡åˆå¹¶ï¼Œä»¥ç¡®ä¿æœ€ç»ˆåªä¼šç”Ÿæˆä¸€ä¸ªæ•°æ®æ–‡ä»¶ ","date":"2022-12-07","objectID":"/mapreduce/:3:0","tags":["æ•°ä»“"],"title":"å›¾æ–‡è¯¦è§£ MapReduce å·¥ä½œæµç¨‹","uri":"/mapreduce/"},{"categories":["å­¦ä¹ "],"content":"ReduceTask ReduceTask Copy é˜¶æ®µï¼š Reduce ä¼šä»å„ä¸ª MapTask ä¸Šè¿œç¨‹å¤åˆ¶ä¸€ç‰‡æ•°æ®ï¼ˆæ¯ä¸ª MapTask ä¼ æ¥çš„æ•°æ®éƒ½æ˜¯æœ‰åºçš„ï¼‰ï¼Œå¹¶é’ˆå¯¹æŸä¸€ç‰‡æ•°æ®ï¼Œå¦‚æœå…¶å¤§å°è¶…è¿‡ä¸€å®šåœ‹å€¼ï¼Œåˆ™å†™åˆ°ç£ç›˜ä¸Šï¼Œå¦åˆ™ç›´æ¥æ”¾åˆ°å†…å­˜ä¸­ Merge é˜¶æ®µï¼šåœ¨è¿œç¨‹å¤åˆ¶æ•°æ®çš„åŒæ—¶ï¼Œ ReduceTask ä¼šå¯åŠ¨ä¸¤ä¸ªåå°çº¿ç¨‹ï¼Œåˆ†åˆ«å¯¹å†…å­˜å’Œç£ç›˜ä¸Šçš„æ–‡ä»¶è¿›è¡Œåˆå¹¶ï¼Œä»¥é˜²æ­¢å†…å­˜ä½¿ç”¨è¿‡å¤šæˆ–è€…ç£ç›˜æ–‡ä»¶è¿‡å¤šã€‚ Sort é˜¶æ®µï¼šç”¨æˆ·ç¼–å†™ reduce() æ–¹æ³•è¾“å…¥æ•°æ®æ˜¯æŒ‰ key è¿›è¡Œèšé›†çš„ä¸€ç»„æ•°æ®ã€‚ ä¸ºäº†å°† key ç›¸åŒçš„æ•°æ®èšåœ¨ä¸€èµ·ï¼Œ Hadoop é‡‡ç”¨äº†åŸºäºæ’åºçš„ç­–ç•¥ã€‚ ç”±äºå„ä¸ª MapTask å·²ç»å®ç°å¯¹è‡ªå·±çš„å¤„ç†ç»“æœè¿›è¡Œäº†å±€éƒ¨æ’åºï¼Œå› æ­¤ï¼Œ ReduceTask åªéœ€å¯¹æ‰€æœ‰æ•°æ®è¿›è¡Œä¸€æ¬¡å½’å¹¶æ’åºå³å¯ã€‚ Reduce é˜¶æ®µï¼šå¯¹æ’åºåçš„é”®å€¼å¯¹è°ƒç”¨ reduce() æ–¹æ³•ï¼Œé”®ç›¸ç­‰çš„é”®å€¼å¯¹è°ƒç”¨ä¸€æ¬¡ reduce()æ–¹æ³•ï¼Œæ¯æ¬¡è°ƒç”¨ä¼šäº§ç”Ÿé›¶ä¸ªæˆ–è€…å¤šä¸ªé”®å€¼å¯¹ï¼Œæœ€åæŠŠè¿™äº›è¾“å‡ºçš„é”®å€¼å¯¹å†™å…¥åˆ° HDFS ä¸­ Write é˜¶æ®µï¼šreduce() å‡½æ•°å°†è®¡ç®—ç»“æœå†™åˆ° HDFS ä¸Šã€‚ åˆå¹¶çš„è¿‡ç¨‹ä¸­ä¼šäº§ç”Ÿè®¸å¤šçš„ä¸­é—´æ–‡ä»¶(å†™å…¥ç£ç›˜äº†)ï¼Œä½† MapReduce ä¼šè®©å†™å…¥ç£ç›˜çš„æ•°æ®å°½å¯èƒ½åœ°å°‘ï¼Œå¹¶ä¸”æœ€åä¸€æ¬¡åˆå¹¶çš„ç»“æœå¹¶æ²¡æœ‰å†™å…¥ç£ç›˜ï¼Œè€Œæ˜¯ç›´æ¥è¾“å…¥åˆ° Reduce å‡½æ•°ã€‚ ","date":"2022-12-07","objectID":"/mapreduce/:4:0","tags":["æ•°ä»“"],"title":"å›¾æ–‡è¯¦è§£ MapReduce å·¥ä½œæµç¨‹","uri":"/mapreduce/"},{"categories":["å­¦ä¹ "],"content":"SQL-è‹±é›„å‡ºåœºæ’åtop3çš„å‡ºåœºæ¬¡æ•°åŠå‡ºåœºç‡","date":"2022-12-07","objectID":"/sql-hero-top/","tags":["SQL"],"title":"SQL-è‹±é›„å‡ºåœºæ’åtop3çš„å‡ºåœºæ¬¡æ•°åŠå‡ºåœºç‡","uri":"/sql-hero-top/"},{"categories":["å­¦ä¹ "],"content":"æ±‚è‹±é›„çš„å‡ºåœºæ’å top3 çš„å‡ºåœºæ¬¡æ•°åŠå‡ºåœºç‡ã€‚names ä»£è¡¨è‹±é›„åå­—ã€‚ id names 1 aa,bb,cc,dd,ee 2 aa,bb,ff,ww,qq 3 aa,cc,rr,yy 4 aa,bb,dd,oo,pp select name, cnt, cast(cnt/all_cnt as decimal(3,1)) as ratio from ( select name, cnt, sum(cnt) over () as all_cnt, dense_rank() over (order by cnt desc) as rn from ( select name, count(1) as cnt from tmp_2022120501 lateral view explode(split(my_str, ',')) t as name group by 1 ) a ) a where rn \u003c= 3; ","date":"2022-12-07","objectID":"/sql-hero-top/:0:0","tags":["SQL"],"title":"SQL-è‹±é›„å‡ºåœºæ’åtop3çš„å‡ºåœºæ¬¡æ•°åŠå‡ºåœºç‡","uri":"/sql-hero-top/"},{"categories":["å­¦ä¹ "],"content":"SQL-åˆ—è½¬è¡Œ","date":"2022-12-07","objectID":"/sql-row-col/","tags":["SQL"],"title":"SQL-åˆ—è½¬è¡Œ","uri":"/sql-row-col/"},{"categories":["å­¦ä¹ "],"content":"å¸¸ç”¨æ“ä½œåˆ—è½¬è¡Œçš„å‡ ç§æ–¹æ³•ã€‚ ","date":"2022-12-07","objectID":"/sql-row-col/:0:0","tags":["SQL"],"title":"SQL-åˆ—è½¬è¡Œ","uri":"/sql-row-col/"},{"categories":["å­¦ä¹ "],"content":"æ•°æ®å‡†å¤‡ create table t1 as select '1' as id ,'mike' as name ,'22' as age,'0' as gender union all select '2' as id ,'kangkang' as name ,'19' as age,'1' as gender ","date":"2022-12-07","objectID":"/sql-row-col/:1:0","tags":["SQL"],"title":"SQL-åˆ—è½¬è¡Œ","uri":"/sql-row-col/"},{"categories":["å­¦ä¹ "],"content":"ä½¿ç”¨ union select id,'name' as type,name as value from t1 union all select id,'age' as type,age as value from t1 union all select id,'gender' as type,gender as value from t1 order by id ","date":"2022-12-07","objectID":"/sql-row-col/:2:0","tags":["SQL"],"title":"SQL-åˆ—è½¬è¡Œ","uri":"/sql-row-col/"},{"categories":["å­¦ä¹ "],"content":"é‡‡ç”¨concat_ws() + posexplode()æ–¹æ³• select id, type, value from ( select t.id, t1.pos1, t1.value1 as value, t2.pos2, t2.type2 as type from ( select id, concat_ws(',', name, age, gender) as value, array('name', 'age', 'gender') as type from t1 ) t lateral view posexplode(split(t.value, ',')) t1 as pos1, value1 lateral view posexplode(t.type) t2 as pos2, type2 ) t where t.pos1 = t.pos2 SQLç®€åŒ–å¦‚ä¸‹ï¼š select id, b.type2 as type, a.value1 as value from t1 lateral view posexplode(split(concat_ws(',', t1.name, t1.age, t1.gender), ',')) a as pos1, value1 lateral view posexplode(array('name', 'age', 'gender')) b as pos2, type2 where a.pos1 = b.pos2 ","date":"2022-12-07","objectID":"/sql-row-col/:3:0","tags":["SQL"],"title":"SQL-åˆ—è½¬è¡Œ","uri":"/sql-row-col/"},{"categories":["å­¦ä¹ "],"content":"é‡‡ç”¨explode()+case whenæ–¹æ³• select id, type, case type when 'name' then name when 'age' then age when 'gender' then gender else null end as value from t1 lateral view explode(array('name', 'age', 'gender')) t2 as type ","date":"2022-12-07","objectID":"/sql-row-col/:4:0","tags":["SQL"],"title":"SQL-åˆ—è½¬è¡Œ","uri":"/sql-row-col/"},{"categories":["å­¦ä¹ "],"content":"SQL-è¿ç»­ 7 å¤©éƒ½ç™»é™†å¹³å°","date":"2022-12-07","objectID":"/sql-7d-login/","tags":["SQL"],"title":"SQL-è¿ç»­ 7 å¤©éƒ½ç™»é™†å¹³å°","uri":"/sql-7d-login/"},{"categories":["å­¦ä¹ "],"content":"æ‰¾å‡ºè¿ç»­ 7 å¤©éƒ½ç™»é™†å¹³å°çš„ç”¨æˆ·ã€‚ ç°æœ‰ç”¨æˆ·ç™»é™†è¡¨ user_login_table å¦‚ä¸‹ï¼š user_name ç”¨æˆ·å date ç”¨æˆ·ç™»é™†æ—¶é—´ ç°åœ¨è€æ¿æƒ³çŸ¥é“è¿ç»­ 7 å¤©éƒ½ç™»é™†å¹³å°çš„é‡è¦ç”¨æˆ·ã€‚ è¾“å‡ºè¦æ±‚å¦‚ä¸‹ï¼š user_name ç”¨æˆ·åï¼ˆè¿ç»­ 7 å¤©éƒ½ç™»é™†çš„ç”¨æˆ·æ•°ï¼‰ æ€è·¯1 é¦–å…ˆåˆ©ç”¨åç§»çª—å£å‡½æ•° lead æ±‚å¾—æ¯ä¸ªç”¨æˆ·åœ¨æ¯ä¸ªç™»é™†æ—¶é—´å‘ååç§» 7 è¡Œçš„ç™»é™†æ—¶é—´ï¼Œå†è®¡ç®—æ¯ä¸ªç”¨æˆ·åœ¨æ¯ä¸ªç™»é™†æ—¶é—´æ»å 7 å¤©çš„ç™»é™†æ—¶é—´ï¼Œå¦‚æœæ¯ä¸ªç”¨æˆ·å‘ååç§» 7 è¡Œçš„ç™»é™†æ—¶é—´æ­£å¥½ç­‰äºæ»å 7 å¤©çš„æ—¶é—´ï¼Œè¯´æ˜è¯¥ç”¨æˆ·è¿ç»­ç™»é™†äº† 7 å¤©ã€‚ select user_name from ( select user_name, log_date, lead(log_date, 7) over (partition by user_name order by log_date) log_date_7 from ( select 'A' user_name, '2020-01-01' log_date union all select 'A' user_name, '2020-01-02' log_date union all select 'A' user_name, '2020-01-03' log_date union all select 'A' user_name, '2020-01-04' log_date union all select 'A' user_name, '2020-01-05' log_date union all select 'A' user_name, '2020-01-06' log_date union all select 'A' user_name, '2020-01-07' log_date union all select 'A' user_name, '2020-01-08' log_date union all select 'A' user_name, '2020-01-19' log_date ) ) where log_date_7 is not null and date_add(log_date, 7) = log_date_7; æ€è·¯2 æŠŠç”¨æˆ·æ¯å¤©ç™»é™†çš„æ—¥æœŸè¿›è¡Œæ’åºï¼Œå¦‚æœç”¨å½“å‰å¤©æ•°å‡å»åºå·ï¼Œè¿ç»­ 3 å¤©çš„è¯ç›¸åŒçš„æ•°æ®å°±æœ‰ 7 ä¸ª select user_id, count(1) cnt from ( select user_id, login_date, row_number() over(partition by user_id order by login_date) rn from tab1 ) group by user_id,date_sub(login_date, rn) having count(1) \u003e= 7; ","date":"2022-12-07","objectID":"/sql-7d-login/:0:0","tags":["SQL"],"title":"SQL-è¿ç»­ 7 å¤©éƒ½ç™»é™†å¹³å°","uri":"/sql-7d-login/"},{"categories":["å­¦ä¹ "],"content":"SQL-æ”¯ä»˜é‡‘é¢åœ¨å‰ 20% çš„ç”¨æˆ·","date":"2022-12-07","objectID":"/sql-20-per/","tags":["SQL"],"title":"SQL-æ”¯ä»˜é‡‘é¢åœ¨å‰ 20% çš„ç”¨æˆ·","uri":"/sql-20-per/"},{"categories":["å­¦ä¹ "],"content":"æ‰¾å‡ºæ”¯ä»˜é‡‘é¢åœ¨å‰ 20% çš„ç”¨æˆ·ã€‚ æ€è·¯ åˆ©ç”¨ ntile select user_name from ( select user_name, ntile(5) over(order by sum(pay_amt) desc) as level from ( select 'A' user_name, 100 pay_amt union all select 'A' user_name, 10 pay_amt union all select 'A' user_name, 300 pay_amt union all select 'B' user_name, 100 pay_amt union all select 'B' user_name, 1090 pay_amt union all select 'C' user_name, 1030 pay_amt union all select 'D' user_name, 70 pay_amt union all select 'F' user_name, 770 pay_amt union all select 'G' user_name, 710 pay_amt union all select 'E' user_name, 800 pay_amt ) group by 1 ) where level = 1; ","date":"2022-12-07","objectID":"/sql-20-per/:0:0","tags":["SQL"],"title":"SQL-æ”¯ä»˜é‡‘é¢åœ¨å‰ 20% çš„ç”¨æˆ·","uri":"/sql-20-per/"},{"categories":["å­¦ä¹ "],"content":"å¦‚ä½•è®¾ç½®ReduceTaskå¹¶è¡Œåº¦","date":"2022-12-06","objectID":"/mr-reduce/","tags":["æ•°ä»“"],"title":"å¦‚ä½•è®¾ç½®ReduceTaskå¹¶è¡Œåº¦","uri":"/mr-reduce/"},{"categories":["å­¦ä¹ "],"content":"å¦‚æœ ReduceTask æ•°é‡è¿‡å¤šï¼Œä¸€ä¸ª ReduceTask ä¼šäº§ç”Ÿä¸€ä¸ªç»“æœæ–‡ä»¶ï¼Œè¿™æ ·å°±ä¼šç”Ÿæˆå¾ˆå¤šå°æ–‡ä»¶ï¼Œé‚£ä¹ˆå¦‚æœè¿™äº›ç»“æœæ–‡ä»¶ä¼šä½œä¸ºä¸‹ä¸€ä¸ª Job çš„è¾“å…¥ï¼Œåˆ™ä¼šå‡ºç°å°æ–‡ä»¶éœ€è¦è¿›è¡Œåˆå¹¶çš„é—®é¢˜ï¼Œè€Œä¸”å¯åŠ¨å’Œåˆå§‹åŒ– ReduceTask éœ€è¦è€—è´¹èµ„æºã€‚1 å¦‚æœ ReduceTask æ•°é‡è¿‡å°‘ï¼Œè¿™æ ·ä¸€ä¸ª ReduceTask å°±éœ€è¦å¤„ç†å¤§é‡çš„æ•°æ®ï¼Œå¹¶ä¸”è¿˜æœ‰å¯èƒ½ä¼šå‡ºç°æ•°æ®å€¾æ–œçš„é—®é¢˜ï¼Œä½¿å¾—æ•´ä¸ªæŸ¥è¯¢è€—æ—¶é•¿ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼ŒHive åˆ†é…çš„ reducer ä¸ªæ•°ç”±ä¸‹åˆ—å‚æ•°å†³å®šï¼š Hadoop MapReduce ç¨‹åºä¸­ï¼ŒReducerTask ä¸ªæ•°çš„è®¾å®šæå¤§å½±å“æ‰§è¡Œæ•ˆç‡ï¼ŒReducerTask æ•°é‡ä¸è¾“å‡ºæ–‡ä»¶çš„æ•°é‡ç›¸å…³ã€‚å¦‚æœ ReducerTask æ•°å¤ªå¤šï¼Œä¼šäº§ç”Ÿå¤§é‡å°æ–‡ä»¶ï¼Œå¯¹ HDFS é€ æˆå‹åŠ›ã€‚å¦‚æœ ReducerTask æ•°å¤ªå°‘ï¼Œæ¯ä¸ª ReducerTask è¦å¤„ç†å¾ˆå¤šæ•°æ®ï¼Œå®¹æ˜“æ‹–æ…¢è¿è¡Œæ—¶é—´æˆ–è€…é€ æˆ OOMã€‚è¿™ä½¿å¾— Hive æ€æ ·å†³å®š ReducerTask ä¸ªæ•°æˆä¸ºä¸€ä¸ªå…³é”®é—®é¢˜ã€‚é—æ†¾çš„æ˜¯ Hive çš„ä¼°è®¡æœºåˆ¶å¾ˆå¼±ï¼Œä¸æŒ‡å®š ReducerTask ä¸ªæ•°çš„æƒ…å†µä¸‹ï¼ŒHive ä¼šçŒœæµ‹ç¡®å®šä¸€ä¸ª ReducerTask ä¸ªæ•°ï¼ŒåŸºäºä»¥ä¸‹ä¸¤ä¸ªè®¾å®šï¼š å‚æ•°1ï¼šhive.exec.reducers.bytes.per.reducer (é»˜è®¤256M) å‚æ•°2ï¼šhive.exec.reducers.max (é»˜è®¤ä¸º1009) å‚æ•°3ï¼šmapreduce.job.reduces (é»˜è®¤å€¼ä¸º-1ï¼Œè¡¨ç¤ºæ²¡æœ‰è®¾ç½®ï¼Œé‚£ä¹ˆå°±æŒ‰ç…§ä»¥ä¸Šä¸¤ä¸ªå‚æ•°è¿›è¡Œè®¾ç½®) ReduceTask çš„è®¡ç®—å…¬å¼ä¸º: $N = Math.min(å‚æ•°2ï¼Œæ€»è¾“å…¥æ•°æ®å¤§å° / å‚æ•°1)$ å¯ä»¥é€šè¿‡æ”¹å˜ä¸Šè¿°ä¸¤ä¸ªå‚æ•°çš„å€¼æ¥æ§åˆ¶ ReduceTask çš„æ•°é‡ã€‚ä¹Ÿå¯ä»¥é€šè¿‡ set mapred.map.tasks=10; set mapreduce.job.reduces=10; é€šå¸¸æƒ…å†µä¸‹ï¼Œæœ‰å¿…è¦æ‰‹åŠ¨æŒ‡å®š ReduceTask ä¸ªæ•°ã€‚è€ƒè™‘åˆ° Mapper é˜¶æ®µçš„è¾“å‡ºæ•°æ®é‡é€šå¸¸ä¼šæ¯”è¾“å…¥æœ‰å¤§å¹…å‡å°‘ï¼Œå› æ­¤å³ä½¿ä¸è®¾å®š ReduceTask ä¸ªæ•°ï¼Œé‡è®¾å‚æ•°2è¿˜æ˜¯å¿…è¦çš„ã€‚ä¾æ®ç»éªŒï¼Œå¯ä»¥å°†å‚æ•°2è®¾å®šä¸º $M * (0.95 * N)$ (N ä¸ºé›†ç¾¤ä¸­ NodeManager ä¸ªæ•°)ã€‚ä¸€èˆ¬æ¥è¯´ï¼ŒNodeManage å’Œ DataNode çš„ä¸ªæ•°æ˜¯ä¸€æ ·çš„ã€‚ å¦‚ä½•è®¾ç½®ReduceTaskå¹¶è¡Œåº¦Â â†©ï¸ ","date":"2022-12-06","objectID":"/mr-reduce/:0:0","tags":["æ•°ä»“"],"title":"å¦‚ä½•è®¾ç½®ReduceTaskå¹¶è¡Œåº¦","uri":"/mr-reduce/"},{"categories":["å­¦ä¹ "],"content":"MRä¸­å¦‚ä½•æ§åˆ¶mapçš„æ•°é‡","date":"2022-12-06","objectID":"/mr-map/","tags":["æ•°ä»“"],"title":"MRä¸­å¦‚ä½•æ§åˆ¶mapçš„æ•°é‡","uri":"/mr-map/"},{"categories":["å­¦ä¹ "],"content":"hadooop æä¾›äº†ä¸€ä¸ªè®¾ç½® map ä¸ªæ•°çš„å‚æ•° mapred.map.tasksï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡è¿™ä¸ªå‚æ•°æ¥æ§åˆ¶ map çš„ä¸ªæ•°ã€‚ä½†æ˜¯é€šè¿‡è¿™ç§æ–¹å¼è®¾ç½® map çš„ä¸ªæ•°ï¼Œå¹¶ä¸æ˜¯æ¯æ¬¡éƒ½æœ‰æ•ˆçš„ã€‚åŸå› æ˜¯ mapred.map.tasks åªæ˜¯ä¸€ä¸ª hadoop çš„å‚è€ƒæ•°å€¼ï¼Œæœ€ç»ˆ map çš„ä¸ªæ•°ï¼Œè¿˜å–å†³äºå…¶ä»–çš„å› ç´ ã€‚1 ä¸ºäº†æ–¹ä¾¿ä»‹ç»ï¼Œå…ˆæ¥çœ‹å‡ ä¸ªåè¯ï¼š block_size : hdfs çš„æ–‡ä»¶å—å¤§å°ï¼Œé»˜è®¤ä¸º 128Mï¼Œå¯ä»¥é€šè¿‡å‚æ•° hdfs.block.size è®¾ç½® total_size : è¾“å…¥æ–‡ä»¶æ•´ä½“çš„å¤§å° input_file_num : è¾“å…¥æ–‡ä»¶çš„ä¸ªæ•° ","date":"2022-12-06","objectID":"/mr-map/:0:0","tags":["æ•°ä»“"],"title":"MRä¸­å¦‚ä½•æ§åˆ¶mapçš„æ•°é‡","uri":"/mr-map/"},{"categories":["å­¦ä¹ "],"content":"é»˜è®¤ map ä¸ªæ•° å¦‚æœä¸è¿›è¡Œä»»ä½•è®¾ç½®ï¼Œé»˜è®¤çš„ map ä¸ªæ•°æ˜¯å’Œ blcok_size ç›¸å…³çš„ã€‚ default_num = total_size / block_size ","date":"2022-12-06","objectID":"/mr-map/:1:0","tags":["æ•°ä»“"],"title":"MRä¸­å¦‚ä½•æ§åˆ¶mapçš„æ•°é‡","uri":"/mr-map/"},{"categories":["å­¦ä¹ "],"content":"æœŸæœ›å¤§å° å¯ä»¥é€šè¿‡å‚æ•° mapred.map.tasks æ¥è®¾ç½®æœŸæœ›çš„ map ä¸ªæ•°ï¼Œä½†æ˜¯è¿™ä¸ªä¸ªæ•°åªæœ‰åœ¨å¤§äº default_num çš„æ—¶å€™ï¼Œæ‰ä¼šç”Ÿæ•ˆã€‚ goal_num = mapred.map.tasksï¼ˆé»˜è®¤ä¸º2ï¼‰ ","date":"2022-12-06","objectID":"/mr-map/:2:0","tags":["æ•°ä»“"],"title":"MRä¸­å¦‚ä½•æ§åˆ¶mapçš„æ•°é‡","uri":"/mr-map/"},{"categories":["å­¦ä¹ "],"content":"è®¾ç½®å¤„ç†çš„æ–‡ä»¶å¤§å° å¯ä»¥é€šè¿‡ mapred.min.split.size è®¾ç½®æ¯ä¸ª task å¤„ç†çš„æ–‡ä»¶å¤§å°ï¼Œä½†æ˜¯è¿™ä¸ªå¤§å°åªæœ‰åœ¨å¤§äº block_size çš„æ—¶å€™æ‰ä¼šç”Ÿæ•ˆã€‚ split_size = max(mapred.min.split.size, block_size) split_num = total_size / split_size ","date":"2022-12-06","objectID":"/mr-map/:3:0","tags":["æ•°ä»“"],"title":"MRä¸­å¦‚ä½•æ§åˆ¶mapçš„æ•°é‡","uri":"/mr-map/"},{"categories":["å­¦ä¹ "],"content":"è®¡ç®—çš„mapä¸ªæ•° compute_map_num = min(split_num, max(default_num, goal_num)) é™¤äº†è¿™äº›é…ç½®ä»¥å¤–ï¼Œmapreduce è¿˜è¦éµå¾ªä¸€äº›åŸåˆ™ã€‚ mapreduce çš„æ¯ä¸€ä¸ª map å¤„ç†çš„æ•°æ®æ˜¯ä¸èƒ½è·¨è¶Šæ–‡ä»¶çš„ï¼Œä¹Ÿå°±æ˜¯è¯´ min_map_num \u003e= input_file_numã€‚ æ‰€ä»¥ï¼Œæœ€ç»ˆçš„ map ä¸ªæ•°åº”è¯¥ä¸ºï¼š final_map_num = max(compute_map_num, input_file_num) ","date":"2022-12-06","objectID":"/mr-map/:4:0","tags":["æ•°ä»“"],"title":"MRä¸­å¦‚ä½•æ§åˆ¶mapçš„æ•°é‡","uri":"/mr-map/"},{"categories":["å­¦ä¹ "],"content":"æ€»ç»“ ç»è¿‡ä»¥ä¸Šçš„åˆ†æï¼Œåœ¨è®¾ç½® map ä¸ªæ•°çš„æ—¶å€™ï¼Œå¯ä»¥ç®€å•çš„æ€»ç»“ä¸ºä»¥ä¸‹å‡ ç‚¹ï¼š å¦‚æœæƒ³å¢åŠ  map ä¸ªæ•°ï¼Œåˆ™è®¾ç½® mapred.map.tasks ä¸ºä¸€ä¸ªè¾ƒå¤§çš„å€¼ã€‚ å¦‚æœæƒ³å‡å° map ä¸ªæ•°ï¼Œåˆ™è®¾ç½® mapred.min.split.size ä¸ºä¸€ä¸ªè¾ƒå¤§çš„å€¼ã€‚ å¦‚æœè¾“å…¥ä¸­æœ‰å¾ˆå¤šå°æ–‡ä»¶ï¼Œä¾ç„¶æƒ³å‡å°‘ map ä¸ªæ•°ï¼Œåˆ™éœ€è¦å°†å°æ–‡ä»¶ merger ä¸ºå¤§æ–‡ä»¶ï¼Œç„¶åä½¿ç”¨å‡†åˆ™ 2ã€‚ MRä¸­å¦‚ä½•æ§åˆ¶mapçš„æ•°é‡Â â†©ï¸ ","date":"2022-12-06","objectID":"/mr-map/:5:0","tags":["æ•°ä»“"],"title":"MRä¸­å¦‚ä½•æ§åˆ¶mapçš„æ•°é‡","uri":"/mr-map/"},{"categories":["åˆ·é¢˜"],"content":"Python çº¿æ€§æŸ¥æ‰¾","date":"2022-12-06","objectID":"/python-linear-search/","tags":["æŸ¥æ‰¾"],"title":"Python çº¿æ€§æŸ¥æ‰¾ ","uri":"/python-linear-search/"},{"categories":["åˆ·é¢˜"],"content":"çº¿æ€§æŸ¥æ‰¾æŒ‡æŒ‰ä¸€å®šçš„é¡ºåºæ£€æŸ¥æ•°ç»„ä¸­æ¯ä¸€ä¸ªå…ƒç´ ï¼Œç›´åˆ°æ‰¾åˆ°æ‰€è¦å¯»æ‰¾çš„ç‰¹å®šå€¼ä¸ºæ­¢ã€‚1 çº¿æ€§æŸ¥æ‰¾ def linearSearch(s, x): for i in range(len(s)): if s[i] == x: return i return -1 Python çº¿æ€§æŸ¥æ‰¾Â â†©ï¸ ","date":"2022-12-06","objectID":"/python-linear-search/:0:0","tags":["æŸ¥æ‰¾"],"title":"Python çº¿æ€§æŸ¥æ‰¾ ","uri":"/python-linear-search/"},{"categories":["åˆ·é¢˜"],"content":"Python äºŒåˆ†æŸ¥æ‰¾","date":"2022-12-06","objectID":"/python-binary-search/","tags":["æŸ¥æ‰¾"],"title":"Python äºŒåˆ†æŸ¥æ‰¾ ","uri":"/python-binary-search/"},{"categories":["åˆ·é¢˜"],"content":"äºŒåˆ†æœç´¢æ˜¯ä¸€ç§åœ¨æœ‰åºæ•°ç»„ä¸­æŸ¥æ‰¾æŸä¸€ç‰¹å®šå…ƒç´ çš„æœç´¢ç®—æ³•ã€‚1 æœç´¢è¿‡ç¨‹ä»æ•°ç»„çš„ä¸­é—´å…ƒç´ å¼€å§‹ï¼Œå¦‚æœä¸­é—´å…ƒç´ æ­£å¥½æ˜¯è¦æŸ¥æ‰¾çš„å…ƒç´ ï¼Œåˆ™æœç´¢è¿‡ç¨‹ç»“æŸï¼› å¦‚æœæŸä¸€ç‰¹å®šå…ƒç´ å¤§äºæˆ–è€…å°äºä¸­é—´å…ƒç´ ï¼Œåˆ™åœ¨æ•°ç»„å¤§äºæˆ–å°äºä¸­é—´å…ƒç´ çš„é‚£ä¸€åŠä¸­æŸ¥æ‰¾ï¼Œè€Œä¸”è·Ÿå¼€å§‹ä¸€æ ·ä»ä¸­é—´å…ƒç´ å¼€å§‹æ¯”è¾ƒã€‚ å¦‚æœåœ¨æŸä¸€æ­¥éª¤æ•°ç»„ä¸ºç©ºï¼Œåˆ™ä»£è¡¨æ‰¾ä¸åˆ°ã€‚ è¿™ç§æœç´¢ç®—æ³•æ¯ä¸€æ¬¡æ¯”è¾ƒéƒ½ä½¿æœç´¢èŒƒå›´ç¼©å°ä¸€åŠã€‚ å†’æ³¡æ’åº def bubbleSort(s): n = len(s) for i in range(n): for j in range(n-i-1): if s[j+1] \u003c s[j]: s[j+1], s[j] = s[j], s[j+1] return s Python äºŒåˆ†æŸ¥æ‰¾Â â†©ï¸ ","date":"2022-12-06","objectID":"/python-binary-search/:0:0","tags":["æŸ¥æ‰¾"],"title":"Python äºŒåˆ†æŸ¥æ‰¾ ","uri":"/python-binary-search/"},{"categories":["åˆ·é¢˜"],"content":"Python å†’æ³¡æ’åº","date":"2022-12-06","objectID":"/python-bubble-sort/","tags":["æ’åº"],"title":"Python å†’æ³¡æ’åº ","uri":"/python-bubble-sort/"},{"categories":["åˆ·é¢˜"],"content":"å†’æ³¡æ’åºï¼ˆBubble Sortï¼‰ä¹Ÿæ˜¯ä¸€ç§ç®€å•ç›´è§‚çš„æ’åºç®—æ³•ã€‚1 å®ƒé‡å¤åœ°èµ°è®¿è¿‡è¦æ’åºçš„æ•°åˆ—ï¼Œä¸€æ¬¡æ¯”è¾ƒä¸¤ä¸ªå…ƒç´ ï¼Œå¦‚æœä»–ä»¬çš„é¡ºåºé”™è¯¯å°±æŠŠä»–ä»¬äº¤æ¢è¿‡æ¥ã€‚ èµ°è®¿æ•°åˆ—çš„å·¥ä½œæ˜¯é‡å¤åœ°è¿›è¡Œç›´åˆ°æ²¡æœ‰å†éœ€è¦äº¤æ¢ï¼Œä¹Ÿå°±æ˜¯è¯´è¯¥æ•°åˆ—å·²ç»æ’åºå®Œæˆã€‚ è¿™ä¸ªç®—æ³•çš„åå­—ç”±æ¥æ˜¯å› ä¸ºè¶Šå°çš„å…ƒç´ ä¼šç»ç”±äº¤æ¢æ…¢æ…¢â€œæµ®â€åˆ°æ•°åˆ—çš„é¡¶ç«¯ã€‚ å†’æ³¡æ’åº def bubbleSort(s): n = len(s) for i in range(n): for j in range(n-i-1): if s[j+1] \u003c s[j]: s[j+1], s[j] = s[j], s[j+1] return s Python å†’æ³¡æ’åºÂ â†©ï¸ ","date":"2022-12-06","objectID":"/python-bubble-sort/:0:0","tags":["æ’åº"],"title":"Python å†’æ³¡æ’åº ","uri":"/python-bubble-sort/"},{"categories":["åˆ·é¢˜"],"content":"Python æ’å…¥æ’åº","date":"2022-12-06","objectID":"/python-insertion-sort/","tags":["æ’åº"],"title":"Python æ’å…¥æ’åº ","uri":"/python-insertion-sort/"},{"categories":["åˆ·é¢˜"],"content":"æ’å…¥æ’åºï¼ˆè‹±è¯­ï¼šInsertion Sortï¼‰æ˜¯ä¸€ç§ç®€å•ç›´è§‚çš„æ’åºç®—æ³•ã€‚å®ƒçš„å·¥ä½œåŸç†æ˜¯é€šè¿‡æ„å»ºæœ‰åºåºåˆ—ï¼Œå¯¹äºæœªæ’åºæ•°æ®ï¼Œåœ¨å·²æ’åºåºåˆ—ä¸­ä»åå‘å‰æ‰«æï¼Œæ‰¾åˆ°ç›¸åº”ä½ç½®å¹¶æ’å…¥ã€‚1 æ’å…¥æ’åº def insertionSort(arr): for i in range(1, len(arr)): key = arr[i] j = i - 1 while j \u003e= 0 and key \u003c arr[j]: arr[j+1] = arr[j] j -= 1 arr[j+1] = key return arr Python æ’å…¥æ’åºÂ â†©ï¸ ","date":"2022-12-06","objectID":"/python-insertion-sort/:0:0","tags":["æ’åº"],"title":"Python æ’å…¥æ’åº ","uri":"/python-insertion-sort/"},{"categories":["åˆ·é¢˜"],"content":"Python é€‰æ‹©æ’åº","date":"2022-12-06","objectID":"/python-selection-sort/","tags":["æ’åº"],"title":"Python é€‰æ‹©æ’åº ","uri":"/python-selection-sort/"},{"categories":["åˆ·é¢˜"],"content":"é€‰æ‹©æ’åºï¼ˆSelection sortï¼‰æ˜¯ä¸€ç§ç®€å•ç›´è§‚çš„æ’åºç®—æ³•ã€‚å®ƒçš„å·¥ä½œåŸç†å¦‚ä¸‹ã€‚1 é¦–å…ˆåœ¨æœªæ’åºåºåˆ—ä¸­æ‰¾åˆ°æœ€å°ï¼ˆå¤§ï¼‰å…ƒç´ ï¼Œå­˜æ”¾åˆ°æ’åºåºåˆ—çš„èµ·å§‹ä½ç½®ï¼Œ ç„¶åï¼Œå†ä»å‰©ä½™æœªæ’åºå…ƒç´ ä¸­ç»§ç»­å¯»æ‰¾æœ€å°ï¼ˆå¤§ï¼‰å…ƒç´ ï¼Œç„¶åæ”¾åˆ°å·²æ’åºåºåˆ—çš„æœ«å°¾ã€‚ ä»¥æ­¤ç±»æ¨ï¼Œç›´åˆ°æ‰€æœ‰å…ƒç´ å‡æ’åºå®Œæ¯•ã€‚ é€‰æ‹©æ’åº def selectionSort(s): n = len(s) for i in range(n): min_idx = i for j in range(i+1, n): if s[j] \u003c s[min_idx]: min_idx = j s[i], s[min_idx] = s[min_idx], s[i] return s Python é€‰æ‹©æ’åºÂ â†©ï¸ ","date":"2022-12-06","objectID":"/python-selection-sort/:0:0","tags":["æ’åº"],"title":"Python é€‰æ‹©æ’åº ","uri":"/python-selection-sort/"},{"categories":["åˆ·é¢˜"],"content":"åŠ›æ‰£-å•è¯æ‹†åˆ†","date":"2022-12-06","objectID":"/word-break/","tags":["åŠ›æ‰£"],"title":"åŠ›æ‰£-å•è¯æ‹†åˆ† ","uri":"/word-break/"},{"categories":["åˆ·é¢˜"],"content":"ğŸ”— é¢˜ç›®é“¾æ¥ ç»™ä½ ä¸€ä¸ªå­—ç¬¦ä¸² s å’Œä¸€ä¸ªå­—ç¬¦ä¸²åˆ—è¡¨ wordDict ä½œä¸ºå­—å…¸ã€‚è¯·ä½ åˆ¤æ–­æ˜¯å¦å¯ä»¥åˆ©ç”¨å­—å…¸ä¸­å‡ºç°çš„å•è¯æ‹¼æ¥å‡º sã€‚ æ³¨æ„ï¼šä¸è¦æ±‚å­—å…¸ä¸­å‡ºç°çš„å•è¯å…¨éƒ¨éƒ½ä½¿ç”¨ï¼Œå¹¶ä¸”å­—å…¸ä¸­çš„å•è¯å¯ä»¥é‡å¤ä½¿ç”¨ã€‚ ç¤ºä¾‹ 1ï¼š è¾“å…¥ï¼šs = â€œleetcodeâ€, wordDict = [â€œleetâ€, â€œcodeâ€] è¾“å‡ºï¼štrue è§£é‡Šï¼šè¿”å› true å› ä¸º â€œleetcodeâ€ å¯ä»¥ç”± â€œleetâ€ å’Œ â€œcodeâ€ æ‹¼æ¥æˆã€‚ ç¤ºä¾‹ 2ï¼š è¾“å…¥ï¼šs = â€œapplepenappleâ€, wordDict = [â€œappleâ€, â€œpenâ€] è¾“å‡ºï¼štrue è§£é‡Šï¼šè¿”å› true å› ä¸º â€œapplepenappleâ€ å¯ä»¥ç”± â€œappleâ€ â€œpenâ€ â€œappleâ€ æ‹¼æ¥æˆã€‚æ³¨æ„ï¼Œä½ å¯ä»¥é‡å¤ä½¿ç”¨å­—å…¸ä¸­çš„å•è¯ã€‚ ç¤ºä¾‹ 3ï¼š è¾“å…¥ï¼šs = â€œcatsandogâ€, wordDict = [â€œcatsâ€, â€œdogâ€, â€œsandâ€, â€œandâ€, â€œcatâ€] è¾“å‡ºfalse æç¤ºï¼š $1 \u003c= s.length \u003c= 300$ $1 \u003c= wordDict.length \u003c= 1000$ $1 \u003c= wordDict[i].length \u003c= 20$ s å’Œ wordDict[i] ä»…æœ‰å°å†™è‹±æ–‡å­—æ¯ç»„æˆ wordDict ä¸­çš„æ‰€æœ‰å­—ç¬¦ä¸²äº’ä¸ç›¸åŒ åŠ¨æ€è§„åˆ’+è®°å¿†åŒ–å›æº¯ é€è¡Œè§£é‡Š python31 ","date":"2022-12-06","objectID":"/word-break/:0:0","tags":["åŠ›æ‰£"],"title":"åŠ›æ‰£-å•è¯æ‹†åˆ† ","uri":"/word-break/"},{"categories":["åˆ·é¢˜"],"content":"åŠ¨æ€è§„åˆ’ åŠ¨æ€è§„åˆ’ åˆå§‹åŒ– $dp=[False,â‹¯,False]$ï¼Œé•¿åº¦ä¸º $n+1$ã€‚$n$ ä¸ºå­—ç¬¦ä¸²é•¿åº¦ã€‚$dp[i]$ è¡¨ç¤º $s$ çš„å‰ $i$ ä½æ˜¯å¦å¯ä»¥ç”¨ $wordDict$ ä¸­çš„å•è¯è¡¨ç¤ºã€‚ åˆå§‹åŒ– $dp[0]=True$ï¼Œç©ºå­—ç¬¦å¯ä»¥è¢«è¡¨ç¤ºã€‚ éå†å­—ç¬¦ä¸²çš„æ‰€æœ‰å­ä¸²ï¼Œéå†å¼€å§‹ç´¢å¼• $i$ï¼Œéå†åŒºé—´ $[0,n)$ï¼š éå†ç»“æŸç´¢å¼• $j$ï¼Œéå†åŒºé—´ $[i+1,n+1)$ï¼š è‹¥ $dp[i]=True$ ä¸” $s[i,â‹¯,j)$ åœ¨ $wordlistword$ ä¸­ï¼š$dp[j]=True$ã€‚è§£é‡Šï¼š$dp[i]=True$ è¯´æ˜ $s$ çš„å‰ $i$ ä½å¯ä»¥ç”¨ $wordDict$ è¡¨ç¤ºï¼Œåˆ™ $s[i,â‹¯,j)$ å‡ºç°åœ¨ $wordDict$ ä¸­ï¼Œè¯´æ˜ $s$ çš„å‰ $j$ ä½å¯ä»¥è¡¨ç¤ºã€‚ è¿”å› $dp[n]$ ä»£ç  def wordBreak(s, wordDict): n = len(s) dp = [False]*(n+1) dp[0] = True for i in range(n): for j in range(i+1, n+1): if(dp[i] and (s[i:j] in wordDict)): dp[j] = True return dp[-1] å¤æ‚åº¦åˆ†æ æ—¶é—´å¤æ‚åº¦ï¼š$O(n^{2})$ ç©ºé—´å¤æ‚åº¦ï¼š$O(n)$ åŠ¨æ€è§„åˆ’+è®°å¿†åŒ–å›æº¯ é€è¡Œè§£é‡Š python3Â â†©ï¸ ","date":"2022-12-06","objectID":"/word-break/:1:0","tags":["åŠ›æ‰£"],"title":"åŠ›æ‰£-å•è¯æ‹†åˆ† ","uri":"/word-break/"},{"categories":["åˆ·é¢˜"],"content":"åŠ›æ‰£-æŸ¥è¯¢ä¸¤ä¸ªå­—ç¬¦ä¸²çš„æœ€é•¿å…¬å…±å­ä¸²","date":"2022-12-05","objectID":"/longest/","tags":["åŠ›æ‰£"],"title":"åŠ›æ‰£-æŸ¥è¯¢ä¸¤ä¸ªå­—ç¬¦ä¸²çš„æœ€é•¿å…¬å…±å­ä¸² ","uri":"/longest/"},{"categories":["åˆ·é¢˜"],"content":"æŸ¥è¯¢ä¸¤ä¸ªå­—ç¬¦ä¸²çš„æœ€é•¿å…¬å…±å­ä¸²ã€‚ ç”¨ Python å®ç°æŸ¥æ‰¾ä¸¤ä¸ªå­—ç¬¦ä¸² a,b ä¸­çš„æœ€é•¿å…¬å…±å­ä¸²1 Pythonâ€”â€”æŸ¥è¯¢ä¸¤ä¸ªå­—ç¬¦ä¸²çš„æœ€é•¿å…¬å…±å­ä¸²2 ","date":"2022-12-05","objectID":"/longest/:0:0","tags":["åŠ›æ‰£"],"title":"åŠ›æ‰£-æŸ¥è¯¢ä¸¤ä¸ªå­—ç¬¦ä¸²çš„æœ€é•¿å…¬å…±å­ä¸² ","uri":"/longest/"},{"categories":["åˆ·é¢˜"],"content":"å¾ªç¯æŸ¥æ‰¾ æ€è·¯ï¼š é€šè¿‡å­—ç¬¦ä¸²1ä»å…¨é•¿å¼€å§‹åˆ¤æ–­æ˜¯å¦å­˜åœ¨äºå­—ç¬¦ä¸²2ä¸­ï¼Œå¦‚æœä¸å­˜åœ¨åˆ™è¿­ä»£è‡³åªæœ‰1ä½å­—ç¬¦ é€šè¿‡åˆ—è¡¨æ¥ä¿å­˜ç»“æœï¼Œä»¥å…å‡ºç°æœ‰å¤šä¸ªåŒé•¿çš„æœ€é•¿å­ä¸²æƒ…å†µ é€‰æ‹©é•¿åº¦çŸ­çš„å­—ç¬¦ä¸²ä½œä¸ºæ“ä½œå­—ç¬¦ä¸²ï¼Œä»¥æå‡æ•ˆç‡ def getLongestSameStr(str1, str2): # åˆ¤æ–­ä¸¤ä¸ªå­—ç¬¦ä¸²é•¿çŸ­ï¼Œå–çŸ­çš„é‚£ä¸ªè¿›è¡Œæ“ä½œ if len(str1) \u003e len(str2): str1, str2 = str2, str1 f = [] for i in range(len(str1), 0, -1): for j in range(len(str1) + 1 - i): e = str1[j:j + i] if e in str2: f.append(e) # åˆ¤æ–­å½“å‰é•¿åº¦ä¸‹ï¼Œæ˜¯å¦å­˜åœ¨å­ä¸² if f: break f1 = \",\".join(f) return f1 ç”¨Pythonå®ç°æŸ¥æ‰¾ä¸¤ä¸ªå­—ç¬¦ä¸²a,bä¸­çš„æœ€é•¿å…¬å…±å­ä¸²ï¼‰Â â†©ï¸ Pythonâ€”â€”æŸ¥è¯¢ä¸¤ä¸ªå­—ç¬¦ä¸²çš„æœ€é•¿å…¬å…±å­ä¸²Â â†©ï¸ ","date":"2022-12-05","objectID":"/longest/:1:0","tags":["åŠ›æ‰£"],"title":"åŠ›æ‰£-æŸ¥è¯¢ä¸¤ä¸ªå­—ç¬¦ä¸²çš„æœ€é•¿å…¬å…±å­ä¸² ","uri":"/longest/"},{"categories":["å­¦ä¹ "],"content":"rddé‡Œé¢groupbyå’Œreducebyæœ‰ä»€ä¹ˆåŒºåˆ«","date":"2022-12-04","objectID":"/reduceby/","tags":["æ•°ä»“"],"title":"groupbyå’Œreducebyçš„åŒºåˆ«","uri":"/reduceby/"},{"categories":["å­¦ä¹ "],"content":"rdd é‡Œé¢ groupby å’Œ reduceby æœ‰ä»€ä¹ˆåŒºåˆ«ã€‚ reduceByKey çš„æ³›å‹å‚æ•°æ˜¯ [V]ï¼Œè€Œ groupByKey çš„æ³›å‹å‚æ•°æ˜¯ [CompactBuffer[V]]ã€‚è¿™ç›´æ¥å¯¼è‡´äº† reduceByKey å’Œ groupByKey çš„è¿”å›å€¼ä¸åŒï¼Œå‰è€…æ˜¯ RDD[(K, V)]ï¼Œè€Œåè€…æ˜¯ RDD[(K, Iterable[V])] ç„¶åå°±æ˜¯ mapSideCombine=false äº†ï¼Œè¿™ä¸ª mapSideCombine å‚æ•°çš„é»˜è®¤æ˜¯ true çš„ã€‚è¿™ä¸ªå€¼æœ‰ä»€ä¹ˆç”¨å‘¢ï¼Œä¸Šé¢ä¹Ÿè¯´äº†ï¼Œè¿™ä¸ªå‚æ•°çš„ä½œç”¨æ˜¯æ§åˆ¶è¦ä¸è¦åœ¨ mapç«¯è¿›è¡Œåˆæ­¥åˆå¹¶Combineã€‚å¯ä»¥çœ‹çœ‹ä¸‹é¢å…·ä½“çš„ä¾‹å­ã€‚ groupbykey reducebykey ä»åŠŸèƒ½ä¸Šæ¥è¯´ï¼Œå¯ä»¥å‘ç° ReduceByKey å…¶å®å°±æ˜¯ä¼šåœ¨æ¯ä¸ªèŠ‚ç‚¹å…ˆè¿›è¡Œä¸€æ¬¡åˆå¹¶çš„æ“ä½œï¼Œè€Œ groupByKey æ²¡æœ‰ã€‚ è¿™ä¹ˆæ¥çœ‹ ReduceByKey çš„æ€§èƒ½ä¼šæ¯” groupByKey å¥½å¾ˆå¤šï¼Œå› ä¸ºæœ‰äº›å·¥ä½œåœ¨èŠ‚ç‚¹å·²ç»å¤„ç†äº†ã€‚ reduceByKeyï¼šæŒ‰ç…§ key è¿›è¡Œèšåˆï¼Œåœ¨ shuffle ä¹‹å‰æœ‰combineï¼ˆé¢„èšåˆï¼‰æ“ä½œï¼Œè¿”å›ç»“æœæ˜¯ RDD[k,v]ã€‚ groupByKeyï¼šæŒ‰ç…§ key è¿›è¡Œåˆ†ç»„ï¼Œç›´æ¥è¿›è¡Œ shuffleã€‚ å¼€å‘æŒ‡å¯¼ï¼šreduceByKey æ¯” groupByKeyï¼Œå»ºè®®ä½¿ç”¨ã€‚ä½†æ˜¯éœ€è¦æ³¨æ„æ˜¯å¦ä¼šå½±å“ä¸šåŠ¡é€»è¾‘ã€‚ ","date":"2022-12-04","objectID":"/reduceby/:0:0","tags":["æ•°ä»“"],"title":"groupbyå’Œreducebyçš„åŒºåˆ«","uri":"/reduceby/"},{"categories":["å­¦ä¹ "],"content":"æŠ€æœ¯é€‰å‹ï¼šKylinã€Druidã€ClickHouseå¦‚ä½•é€‰æ‹©ï¼Ÿ","date":"2022-12-04","objectID":"/olap/","tags":["æ•°ä»“"],"title":"æŠ€æœ¯é€‰å‹ï¼šKylinã€Druidã€ClickHouseå¦‚ä½•é€‰æ‹©ï¼Ÿ","uri":"/olap/"},{"categories":["å­¦ä¹ "],"content":"Kylinã€Druidã€ClickHouse æ˜¯ç›®å‰ä¸»æµçš„ OLAP å¼•æ“ï¼Œæœ¬æ–‡å°è¯•ä»æ•°æ®æ¨¡å‹å’Œç´¢å¼•ç»“æ„ä¸¤ä¸ªè§’åº¦ï¼Œåˆ†æè¿™å‡ ä¸ªå¼•æ“çš„æ ¸å¿ƒæŠ€æœ¯ï¼Œå¹¶åšç®€å•å¯¹æ¯”ã€‚åœ¨é˜…è¯»æœ¬æ–‡ä¹‹å‰å¸Œæœ›èƒ½å¯¹ Kylinã€Druidã€ClickHouse æœ‰æ‰€ç†è§£ã€‚ ","date":"2022-12-04","objectID":"/olap/:0:0","tags":["æ•°ä»“"],"title":"æŠ€æœ¯é€‰å‹ï¼šKylinã€Druidã€ClickHouseå¦‚ä½•é€‰æ‹©ï¼Ÿ","uri":"/olap/"},{"categories":["å­¦ä¹ "],"content":"Kylin ","date":"2022-12-04","objectID":"/olap/:1:0","tags":["æ•°ä»“"],"title":"æŠ€æœ¯é€‰å‹ï¼šKylinã€Druidã€ClickHouseå¦‚ä½•é€‰æ‹©ï¼Ÿ","uri":"/olap/"},{"categories":["å­¦ä¹ "],"content":"Kylin æ•°æ®æ¨¡å‹ Kylin çš„æ•°æ®æ¨¡å‹æœ¬è´¨ä¸Šæ˜¯å°†äºŒç»´è¡¨ï¼ˆHiveè¡¨ï¼‰è½¬æ¢ä¸º Cubeï¼Œç„¶åå°† Cube å­˜å‚¨åˆ° HBase è¡¨ä¸­ï¼Œä¹Ÿå°±æ˜¯ä¸¤æ¬¡è½¬æ¢ã€‚ ç¬¬ä¸€æ¬¡è½¬æ¢ï¼Œå…¶å®å°±æ˜¯ä¼ ç»Ÿæ•°æ®åº“çš„ Cube åŒ–ï¼ŒCube ç”± CuboId ç»„æˆï¼Œä¸‹å›¾æ¯ä¸ªèŠ‚ç‚¹éƒ½è¢«ç§°ä¸ºä¸€ä¸ª CuboIdï¼ŒCuboId è¡¨ç¤ºå›ºå®šåˆ—çš„æ•°æ®æ•°æ®é›†åˆï¼Œæ¯”å¦‚ â€œABâ€ ä¸¤ä¸ªç»´åº¦ç»„æˆçš„ CuboId çš„æ•°æ®é›†åˆç­‰ä»·äºä»¥ä¸‹ SQL çš„æ•°æ®é›†åˆï¼š select A, B, sum(M), sum(N) from table group by A, B kylin ç¬¬äºŒæ¬¡è½¬æ¢ï¼Œæ˜¯å°† Cubeä¸­ çš„æ•°æ®å­˜å‚¨åˆ° HBase ä¸­ï¼Œè½¬æ¢çš„æ—¶å€™ CuboId å’Œç»´åº¦ä¿¡æ¯åºåˆ—åŒ–åˆ° rowkeyï¼Œåº¦é‡åˆ—ç»„æˆåˆ—ç°‡ã€‚åœ¨è½¬æ¢çš„æ—¶å€™æ•°æ®è¿›è¡Œäº†é¢„èšåˆã€‚ä¸‹å›¾å±•ç¤ºäº† Cube æ•°æ®åœ¨ HBase ä¸­çš„å­˜å‚¨æ–¹å¼ã€‚ kylin ","date":"2022-12-04","objectID":"/olap/:1:1","tags":["æ•°ä»“"],"title":"æŠ€æœ¯é€‰å‹ï¼šKylinã€Druidã€ClickHouseå¦‚ä½•é€‰æ‹©ï¼Ÿ","uri":"/olap/"},{"categories":["å­¦ä¹ "],"content":"Kylinç´¢å¼•ç»“æ„ å› ä¸º Kylin å°†æ•°æ®å­˜å‚¨åˆ° HBase ä¸­ï¼Œæ‰€ä»¥ kylin çš„æ•°æ®ç´¢å¼•å°±æ˜¯ HBase çš„ç´¢å¼•ã€‚HBase çš„ç´¢å¼•æ˜¯ç®€åŒ–ç‰ˆæœ¬çš„ B+æ ‘ï¼Œç›¸æ¯”äº B+æ ‘ï¼ŒHFile æ²¡æœ‰å¯¹æ•°æ®æ–‡ä»¶çš„æ›´æ–°æ“ä½œã€‚ HFile çš„ç´¢å¼•æ˜¯æŒ‰ç…§ rowkey æ’åºçš„èšç°‡ç´¢å¼•ï¼Œç´¢å¼•æ ‘ä¸€èˆ¬ä¸ºäºŒå±‚æˆ–è€…ä¸‰å±‚ï¼Œç´¢å¼•èŠ‚ç‚¹æ¯” MySQL çš„ B+æ ‘å¤§ï¼Œé»˜è®¤æ˜¯64KBã€‚æ•°æ®æŸ¥æ‰¾çš„æ—¶å€™é€šè¿‡æ ‘å½¢ç»“æ„å®šä½åˆ°èŠ‚ç‚¹ï¼ŒèŠ‚ç‚¹å†…éƒ¨æ•°æ®æ˜¯æŒ‰ç…§ rowkey æœ‰åºçš„ï¼Œå¯ä»¥é€šè¿‡äºŒåˆ†æŸ¥æ‰¾å¿«é€Ÿå®šä½åˆ°ç›®æ ‡ã€‚ kylin ","date":"2022-12-04","objectID":"/olap/:1:2","tags":["æ•°ä»“"],"title":"æŠ€æœ¯é€‰å‹ï¼šKylinã€Druidã€ClickHouseå¦‚ä½•é€‰æ‹©ï¼Ÿ","uri":"/olap/"},{"categories":["å­¦ä¹ "],"content":"Kylinå°ç»“ é€‚ç”¨äºèšåˆæŸ¥è¯¢åœºæ™¯ï¼› å› ä¸ºæ•°æ®é¢„èšåˆï¼ŒKylin å¯ä»¥è¯´æ˜¯æœ€å¿«çš„æŸ¥è¯¢å¼•æ“ï¼ˆgroup-by æŸ¥è¯¢è¿™æ ·çš„å¤æ‚æŸ¥è¯¢ï¼Œå¯èƒ½åªéœ€è¦æ‰«æ 1 æ¡æ•°æ®ï¼‰ï¼› Kylin æŸ¥è¯¢æ•ˆç‡å–å†³äºæ˜¯å¦å‘½ä¸­ CuboIdï¼ŒæŸ¥è¯¢æ³¢åŠ¨è¾ƒå¤§ï¼› HBase ç´¢å¼•æœ‰ç‚¹ç±»ä¼¼ MySQL ä¸­çš„è”åˆç´¢å¼•ï¼Œç»´åº¦åœ¨ rowkey ä¸­çš„æ’åºå’ŒæŸ¥è¯¢ç»´åº¦ç»„åˆå¯¹æŸ¥è¯¢æ•ˆç‡å½±å“å·¨å¤§ï¼› æ‰€ä»¥ Kylin å»ºè¡¨éœ€è¦ä¸šåŠ¡ä¸“å®¶å‚ä¸ã€‚ ","date":"2022-12-04","objectID":"/olap/:1:3","tags":["æ•°ä»“"],"title":"æŠ€æœ¯é€‰å‹ï¼šKylinã€Druidã€ClickHouseå¦‚ä½•é€‰æ‹©ï¼Ÿ","uri":"/olap/"},{"categories":["å­¦ä¹ "],"content":"Druid ","date":"2022-12-04","objectID":"/olap/:2:0","tags":["æ•°ä»“"],"title":"æŠ€æœ¯é€‰å‹ï¼šKylinã€Druidã€ClickHouseå¦‚ä½•é€‰æ‹©ï¼Ÿ","uri":"/olap/"},{"categories":["å­¦ä¹ "],"content":"Druid æ•°æ®æ¨¡å‹ Druid æ•°æ®æ¨¡å‹æ¯”è¾ƒç®€å•ï¼Œå®ƒå°†æ•°æ®è¿›è¡Œé¢„èšåˆï¼Œåªä¸è¿‡é¢„èšåˆçš„æ–¹å¼ä¸ Kylin ä¸åŒï¼ŒKylin æ˜¯ Cube åŒ–ï¼ŒDruid çš„é¢„èšåˆæ–¹å¼æ˜¯å°†æ‰€æœ‰ç»´åº¦è¿›è¡Œ Group-byï¼Œå¯ä»¥å‚è€ƒä¸‹å›¾ï¼š Druid ","date":"2022-12-04","objectID":"/olap/:2:1","tags":["æ•°ä»“"],"title":"æŠ€æœ¯é€‰å‹ï¼šKylinã€Druidã€ClickHouseå¦‚ä½•é€‰æ‹©ï¼Ÿ","uri":"/olap/"},{"categories":["å­¦ä¹ "],"content":"Druidç´¢å¼•ç»“æ„ Druid ç´¢å¼•ç»“æ„ä½¿ç”¨è‡ªå®šä¹‰çš„æ•°æ®ç»“æ„ï¼Œæ•´ä½“ä¸Šå®ƒæ˜¯ä¸€ç§åˆ—å¼å­˜å‚¨ç»“æ„ï¼Œæ¯ä¸ªåˆ—ç‹¬ç«‹ä¸€ä¸ªé€»è¾‘æ–‡ä»¶ï¼ˆå®é™…ä¸Šæ˜¯ä¸€ä¸ªç‰©ç†æ–‡ä»¶ï¼Œåœ¨ç‰©ç†æ–‡ä»¶å†…éƒ¨æ ‡è®°äº†æ¯ä¸ªåˆ—çš„startå’Œoffsetï¼‰ã€‚å¯¹äºç»´åº¦åˆ—è®¾è®¡äº†ç´¢å¼•ï¼Œå®ƒçš„ç´¢å¼•ä»¥ Bitmap ä¸ºæ ¸å¿ƒã€‚ ä¸‹å›¾ä¸º â€œcityâ€ åˆ—çš„ç´¢å¼•ç»“æ„ï¼š Druid é¦–å…ˆå°†è¯¥åˆ—æ‰€æœ‰çš„å”¯ä¸€å€¼æ’åºï¼Œå¹¶ç”Ÿæˆä¸€ä¸ªå­—å…¸ï¼Œç„¶åå¯¹äºæ¯ä¸ªå”¯ä¸€å€¼ç”Ÿæˆä¸€ä¸ª Bitmapï¼ŒBitmap çš„é•¿åº¦ä¸ºæ•°æ®é›†çš„æ€»è¡Œæ•°ï¼Œæ¯ä¸ª bit ä»£è¡¨å¯¹åº”çš„è¡Œçš„æ•°æ®æ˜¯å¦æ˜¯è¯¥å€¼ã€‚Bitmap çš„ä¸‹æ ‡ä½ç½®å’Œè¡Œå·æ˜¯ä¸€ä¸€å¯¹åº”çš„ï¼Œæ‰€ä»¥å¯ä»¥å®šä½åˆ°åº¦é‡åˆ—ï¼ŒBitmap å¯ä»¥è¯´æ˜¯åå‘ç´¢å¼•ã€‚åŒæ—¶æ•°æ®ç»“æ„ä¸­ä¿ç•™äº†å­—å…¸ç¼–ç åçš„æ‰€æœ‰åˆ—å€¼ï¼Œå…¶ä¸ºæ­£å‘çš„ç´¢å¼•ã€‚ é‚£ä¹ˆæŸ¥è¯¢å¦‚ä½•ä½¿ç”¨ç´¢å¼•å‘¢ï¼Ÿä»¥ä»¥ä¸‹æŸ¥è¯¢ä¸ºä¾‹ï¼š select site, sum(pv) from xx where date = 2020-01-01 and city = 'bj' group by site city åˆ—ä¸­äºŒåˆ†æŸ¥æ‰¾ dictionaryå¹¶æ‰¾åˆ° 'bj' å¯¹åº”çš„ bitmap éå† city åˆ—ï¼Œå¯¹äºæ¯ä¸€ä¸ªå­—å…¸å€¼å¯¹åº”çš„ bitmap ä¸ 'bj' çš„ bitmap åšä¸æ“ä½œ æ¯ä¸ªç›¸ä¸åçš„ bitmap å³ä¸º city = 'bj' æŸ¥è¯¢æ¡ä»¶ä¸‹çš„ site çš„ä¸€ä¸ª group çš„ pv çš„ç´¢å¼• é€šè¿‡ç´¢å¼•åœ¨ pv åˆ—ä¸­æŸ¥æ‰¾åˆ°ç›¸åº”çš„è¡Œï¼Œå¹¶åš agg åç»­è®¡ç®— ","date":"2022-12-04","objectID":"/olap/:2:2","tags":["æ•°ä»“"],"title":"æŠ€æœ¯é€‰å‹ï¼šKylinã€Druidã€ClickHouseå¦‚ä½•é€‰æ‹©ï¼Ÿ","uri":"/olap/"},{"categories":["å­¦ä¹ "],"content":"Druidå°ç»“ Druid é€‚ç”¨äºèšåˆæŸ¥è¯¢åœºæ™¯ä½†æ˜¯ä¸é€‚åˆæœ‰è¶…é«˜åŸºç»´åº¦çš„åœºæ™¯ï¼›å­˜å‚¨å…¨ç»´åº¦ group-by åçš„æ•°æ®ï¼Œç›¸å½“äºåªå­˜å‚¨äº† Kylin Cube çš„ Base-CuboIDï¼›æ¯ä¸ªç»´åº¦éƒ½æœ‰åˆ›å»ºç´¢å¼•ï¼Œæ‰€ä»¥æ¯ä¸ªæŸ¥è¯¢éƒ½å¾ˆå¿«ï¼Œå¹¶ä¸”æ²¡æœ‰ç±»ä¼¼ Kylin çš„å·¨å¤§çš„æŸ¥è¯¢æ•ˆç‡æ³¢åŠ¨ã€‚ ","date":"2022-12-04","objectID":"/olap/:2:3","tags":["æ•°ä»“"],"title":"æŠ€æœ¯é€‰å‹ï¼šKylinã€Druidã€ClickHouseå¦‚ä½•é€‰æ‹©ï¼Ÿ","uri":"/olap/"},{"categories":["å­¦ä¹ "],"content":"ClickHouse ","date":"2022-12-04","objectID":"/olap/:3:0","tags":["æ•°ä»“"],"title":"æŠ€æœ¯é€‰å‹ï¼šKylinã€Druidã€ClickHouseå¦‚ä½•é€‰æ‹©ï¼Ÿ","uri":"/olap/"},{"categories":["å­¦ä¹ "],"content":"Clickhouse ç´¢å¼•ç»“æ„ æ­¤å¤„åªè®¨è®º MergeTree å¼•æ“ã€‚ å› ä¸º Clickhouse æ•°æ®æ¨¡å‹å°±æ˜¯æ™®é€šäºŒç»´è¡¨ï¼Œè¿™é‡Œä¸åšä»‹ç»ï¼Œåªè®¨è®ºç´¢å¼•ç»“æ„ã€‚æ•´ä½“ä¸Š Clickhouse çš„ç´¢å¼•ä¹Ÿæ˜¯åˆ—å¼ç´¢å¼•ç»“æ„ï¼Œæ¯ä¸ªåˆ—ä¸€ä¸ªæ–‡ä»¶ã€‚ Clickhouseç´¢å¼•çš„å¤§è‡´æ€è·¯æ˜¯ï¼š é¦–å…ˆé€‰å–éƒ¨åˆ†åˆ—ä½œä¸ºç´¢å¼•åˆ—ï¼Œæ•´ä¸ªæ•°æ®æ–‡ä»¶çš„æ•°æ®æŒ‰ç…§ç´¢å¼•åˆ—æœ‰åºï¼Œè¿™ç‚¹ç±»ä¼¼ MySQL çš„è”åˆç´¢å¼• å…¶æ¬¡å°†æ’åºåçš„æ•°æ®æ¯éš” 8194 è¡Œé€‰å–å‡ºä¸€è¡Œï¼Œè®°å½•å…¶ç´¢å¼•å€¼å’Œåºå·ï¼Œæ³¨æ„è¿™é‡Œçš„åºå·ä¸æ˜¯è¡Œå·ï¼Œåºå·æ˜¯ä»é›¶å¼€å§‹å¹¶é€’å¢çš„ï¼ŒClickhouse ä¸­åºå·è¢«ç§°ä½œ Markâ€™s number ç„¶åå¯¹äºæ¯ä¸ªåˆ—ï¼ˆç´¢å¼•åˆ—å’Œéç´¢å¼•åˆ—ï¼‰ï¼Œè®°å½• Markâ€™s number ä¸å¯¹åº”è¡Œçš„æ•°æ®çš„ offsetã€‚ ä¸‹å›¾ä¸­ä»¥ä¸€ä¸ªäºŒç»´è¡¨ï¼ˆdate, city, actionï¼‰ä¸ºä¾‹ä»‹ç»äº†æ•´ä¸ªç´¢å¼•ç»“æ„ï¼Œå…¶ä¸­ï¼ˆdate,cityï¼‰æ˜¯ç´¢å¼•åˆ—ã€‚ Clickhouse é‚£ä¹ˆæŸ¥è¯¢å¦‚ä½•ä½¿ç”¨ç´¢å¼•å‘¢ï¼Ÿä»¥ä»¥ä¸‹æŸ¥è¯¢ä¸ºä¾‹ï¼š select count(distinct action) where date = toDate(2020-01-01) and city = 'bj' äºŒåˆ†æŸ¥æ‰¾ primary.idx å¹¶æ‰¾åˆ°å¯¹åº”çš„ markâ€™s numberé›†åˆï¼ˆå³æ•°æ® block é›†åˆï¼‰ åœ¨ä¸Šä¸€æ­¥éª¤ä¸­çš„ block ä¸­ï¼Œåœ¨ date å’Œ city åˆ—ä¸­æŸ¥æ‰¾å¯¹åº”çš„å€¼çš„è¡Œå·é›†åˆï¼Œå¹¶åšäº¤é›†ï¼Œç¡®è®¤è¡Œå·é›†åˆ å°†è¡Œå·è½¬æ¢ä¸º markâ€™s number å’Œ offset in blockï¼ˆæ³¨æ„è¿™é‡Œçš„ offset ä»¥è¡Œä¸ºå•ä½è€Œä¸æ˜¯ byteï¼‰ åœ¨ action åˆ—ä¸­ï¼Œæ ¹æ® markâ€™s number å’Œ ``.markæ–‡ä»¶ç¡®è®¤æ•°æ®blockåœ¨binæ–‡ä»¶ä¸­çš„offsetï¼Œç„¶åæ ¹æ® offset in block` å®šä½åˆ°å…·ä½“çš„åˆ—å€¼ã€‚ åç»­è®¡ç®— è¯¥å®ä¾‹ä¸­åŒ…å«äº†å¯¹äºåˆ—çš„æ­£åä¸¤ä¸ªæ–¹å‘çš„æŸ¥æ‰¾è¿‡ç¨‹ã€‚ åå‘ï¼šæŸ¥æ‰¾ date = toDate(2020-01-01) and city = â€˜bjâ€™ æ•°æ®çš„è¡Œå·ï¼› æ­£å‘ï¼šæ ¹æ®è¡Œå·æŸ¥æ‰¾ action åˆ—çš„å€¼ã€‚ å¯¹äºåå‘æŸ¥æ‰¾ï¼Œåªæœ‰åœ¨æŸ¥æ‰¾æ¡ä»¶åŒ¹é…æœ€å·¦å‰ç¼€çš„æ—¶å€™ï¼Œæ‰èƒ½å‰ªææ‰å¤§é‡æ•°æ®ï¼Œå…¶å®ƒæ—¶å€™å¹¶ä¸é«˜æ•ˆã€‚ ","date":"2022-12-04","objectID":"/olap/:3:1","tags":["æ•°ä»“"],"title":"æŠ€æœ¯é€‰å‹ï¼šKylinã€Druidã€ClickHouseå¦‚ä½•é€‰æ‹©ï¼Ÿ","uri":"/olap/"},{"categories":["å­¦ä¹ "],"content":"Clickhouseå°ç»“ MergeTree Family ä½œä¸ºä¸»è¦å¼•æ“ç³»åˆ—ï¼Œå…¶ä¸­åŒ…å«é€‚åˆæ˜ç»†æ•°æ®çš„åœºæ™¯å’Œé€‚åˆèšåˆæ•°æ®çš„åœºæ™¯ï¼› Clickhouse çš„ç´¢å¼•æœ‰ç‚¹ç±»ä¼¼ MySQL çš„è”åˆç´¢å¼•ï¼Œå½“æŸ¥è¯¢å‰ç¼€å…ƒç»„èƒ½å‘½ä¸­çš„æ—¶å€™æ•ˆç‡æœ€é«˜ï¼Œå¯æ˜¯ä¸€æ—¦ä¸èƒ½å‘½ä¸­ï¼Œå‡ ä¹ä¼šæ‰«ææ•´ä¸ªè¡¨ï¼Œæ•ˆç‡æ³¢åŠ¨å·¨å¤§ï¼› æ‰€ä»¥å»ºè¡¨éœ€è¦ä¸šåŠ¡ä¸“å®¶ï¼Œè¿™ä¸€ç‚¹è·Ÿ Kylin ç±»ä¼¼ã€‚ ","date":"2022-12-04","objectID":"/olap/:3:2","tags":["æ•°ä»“"],"title":"æŠ€æœ¯é€‰å‹ï¼šKylinã€Druidã€ClickHouseå¦‚ä½•é€‰æ‹©ï¼Ÿ","uri":"/olap/"},{"categories":["å­¦ä¹ "],"content":"æ€»ç»“ Kylinã€Druid åªé€‚åˆèšåˆåœºæ™¯ï¼ŒClickHouse é€‚åˆæ˜ç»†å’Œèšåˆåœºæ™¯ èšåˆåœºæ™¯ï¼ŒæŸ¥è¯¢æ•ˆç‡æ’åºï¼šKylin \u003e Druid \u003e ClickHouse Kylinã€ClickHouse å»ºè¡¨éƒ½éœ€è¦ä¸šåŠ¡ä¸“å®¶å‚ä¸ Kylinã€ClickHouse æŸ¥è¯¢æ•ˆç‡éƒ½å¯èƒ½äº§ç”Ÿå·¨å¤§å·®å¼‚ ClickHouse åœ¨å‘é‡åŒ–æ–¹é¢åšå¾—çš„æœ€å¥½ï¼ŒDruid å°‘é‡ç®—å­æ”¯æŒå‘é‡åŒ–ã€Kylin ç›®å‰è¿˜ä¸æ”¯æŒå‘é‡åŒ–è®¡ç®— ","date":"2022-12-04","objectID":"/olap/:4:0","tags":["æ•°ä»“"],"title":"æŠ€æœ¯é€‰å‹ï¼šKylinã€Druidã€ClickHouseå¦‚ä½•é€‰æ‹©ï¼Ÿ","uri":"/olap/"},{"categories":["åˆ·é¢˜"],"content":"åŠ›æ‰£-æœ€é•¿å›æ–‡å­ä¸²","date":"2022-12-03","objectID":"/longest-palindromic-substring/","tags":["åŠ›æ‰£"],"title":"åŠ›æ‰£-æœ€é•¿å›æ–‡å­ä¸² ","uri":"/longest-palindromic-substring/"},{"categories":["åˆ·é¢˜"],"content":"ğŸ”— é¢˜ç›®é“¾æ¥ ç»™ä½ ä¸€ä¸ªå­—ç¬¦ä¸² sï¼Œæ‰¾åˆ° s ä¸­æœ€é•¿çš„å›æ–‡å­ä¸²ã€‚ ç¤ºä¾‹ 1ï¼š è¾“å…¥ï¼šs = â€œbabadâ€ è¾“å‡ºï¼šâ€œbabâ€ è§£é‡Šï¼šâ€œabaâ€ åŒæ ·æ˜¯ç¬¦åˆé¢˜æ„çš„ç­”æ¡ˆã€‚ ç¤ºä¾‹ 2ï¼š è¾“å…¥ï¼šs = â€œcbbdâ€ è¾“å‡ºï¼šâ€œbbâ€ æç¤ºï¼š $1 \u003c= s.length \u003c= 1000$ s ä»…ç”±æ•°å­—å’Œè‹±æ–‡å­—æ¯ç»„æˆ ","date":"2022-12-03","objectID":"/longest-palindromic-substring/:0:0","tags":["åŠ›æ‰£"],"title":"åŠ›æ‰£-æœ€é•¿å›æ–‡å­ä¸² ","uri":"/longest-palindromic-substring/"},{"categories":["åˆ·é¢˜"],"content":"æ€è·¯ä¸€ ä»ä¸­å¿ƒå‘ä¸¤ç«¯æ‰©æ•£çš„åŒæŒ‡é’ˆ1 å¦‚æœå›æ–‡ä¸²çš„é•¿åº¦ä¸ºå¥‡æ•°ï¼Œåˆ™å®ƒæœ‰ä¸€ä¸ªä¸­å¿ƒå­—ç¬¦ï¼›å¦‚æœå›æ–‡ä¸²çš„é•¿åº¦ä¸ºå¶æ•°ï¼Œåˆ™å¯ä»¥è®¤ä¸ºå®ƒæœ‰ä¸¤ä¸ªä¸­å¿ƒå­—ç¬¦ã€‚ é‚£ä¹ˆå¯ä»¥äº‹å…ˆå†™ä¸€ä¸ªå‡½æ•°ï¼Œåœ¨ s ä¸­å¯»æ‰¾ä»¥ s[l] å’Œ s[r] ä¸ºä¸­å¿ƒçš„æœ€é•¿å›æ–‡ä¸²ï¼ˆå³ s[l]==s[r]ï¼Œç„¶ååœ¨ä¸è¶Šç•Œçš„å‰æä¸‹å·¦ç§» lï¼Œå³ç§» rï¼‰ï¼Œè¿™æ ·ï¼Œå¦‚æœè¾“å…¥ç›¸åŒçš„ l å’Œ rï¼Œå°±ç›¸å½“äºå¯»æ‰¾é•¿åº¦ä¸ºå¥‡æ•°çš„å›æ–‡ä¸²ï¼Œå¦‚æœè¾“å…¥ç›¸é‚»çš„ l å’Œ rï¼Œåˆ™ç›¸å½“äºå¯»æ‰¾é•¿åº¦ä¸ºå¶æ•°çš„å›æ–‡ä¸²ï¼š def palindrome(s, l, r): # é˜²æ­¢ç´¢å¼•è¶Šç•Œ while l \u003e= 0 and r \u003c len(s) and s[l] == s[r]: # åŒæŒ‡é’ˆï¼Œå‘ä¸¤è¾¹å±•å¼€ï¼Œå·¦å¾€å·¦ï¼Œå³å¾€å³ l -= 1 r += 1 # è¿”å›ä»¥ s[l] å’Œ s[r] ä¸ºä¸­å¿ƒçš„æœ€é•¿å›æ–‡ä¸² return s[l+1: r] # ç»“æŸå¾ªç¯æ—¶læ¯”å›æ–‡ä¸²çš„å†…å®¹å¤šå·¦ç§»äº†ä¸€ä¸ª rå¤šå³ç§»äº†ä¸€ä¸ª é‚£ä¹ˆæ±‚æœ€é•¿å›æ–‡ä¸²ï¼Œå°±ç›¸å½“äºæ˜¯ï¼š for i in range(len(s)): æ‰¾åˆ°ä»¥ s[i] ä¸ºä¸­å¿ƒçš„å›æ–‡ä¸² æ‰¾åˆ°ä»¥ s[i]å’Œs[i+1] ä¸ºä¸­å¿ƒçš„å›æ–‡ä¸² æ›´æ–°ç­”æ¡ˆ ä»£ç ï¼š def longestPalindrome(s: str) -\u003e str: def palindrome(s, l, r): while l \u003e= 0 and r \u003c len(s) and s[l] == s[r]: l -= 1 r += 1 return s[l+1:r] res = '' for i in range(len(s)): sub1 = palindrome(s, i, i) sub2 = palindrome(s, i, i+1) res = sub1 if len(sub1) \u003e len(res) else res res = sub2 if len(sub2) \u003e len(res) else res return res ä»ä¸­å¿ƒå‘ä¸¤ç«¯æ‰©æ•£çš„åŒæŒ‡é’ˆÂ â†©ï¸ ","date":"2022-12-03","objectID":"/longest-palindromic-substring/:1:0","tags":["åŠ›æ‰£"],"title":"åŠ›æ‰£-æœ€é•¿å›æ–‡å­ä¸² ","uri":"/longest-palindromic-substring/"},{"categories":["åˆ·é¢˜"],"content":"åŠ›æ‰£-å¹³æ–¹æ•°ä¹‹å’Œ","date":"2022-12-02","objectID":"/sum-of-square-numbers/","tags":["åŠ›æ‰£"],"title":"åŠ›æ‰£-å¹³æ–¹æ•°ä¹‹å’Œ ","uri":"/sum-of-square-numbers/"},{"categories":["åˆ·é¢˜"],"content":"ğŸ”— é¢˜ç›®é“¾æ¥ ç»™å®šä¸€ä¸ªéè´Ÿæ•´æ•° $c$ï¼Œä½ è¦åˆ¤æ–­æ˜¯å¦å­˜åœ¨ä¸¤ä¸ªæ•´æ•° $a$ å’Œ $b$ï¼Œä½¿å¾— $a^2 + b^2 = c$ã€‚ ç¤ºä¾‹ 1ï¼š è¾“å…¥ï¼šc = 5 è¾“å‡ºï¼štrue è§£é‡Šï¼š1 * 1 + 2 * 2 = 5 ç¤ºä¾‹ 2ï¼š è¾“å…¥ï¼šc = 3 è¾“å‡ºï¼šfalse æç¤ºï¼š $0 \u003c= c \u003c= 2^{31} - 1$ è§£é¢˜æ€è·¯ ä¸ºä»€ä¹ˆåŒæŒ‡é’ˆä¸ä¼šé”™è¿‡æ­£ç¡®ç­”æ¡ˆï¼ŸåŒæŒ‡é’ˆçš„æœ¬è´¨ã€‚1 çœ‹äº†å®˜æ–¹é¢˜è§£çš„åŒæŒ‡é’ˆç®—æ³•ï¼Œä¸å…äº§ç”Ÿä¸€ä¸ªç–‘é—®ï¼Œå‡è®¾åˆå§‹åŒ–æ—¶ï¼Œå·¦æŒ‡é’ˆ $low = 0$ï¼Œå³æŒ‡é’ˆ $high = sqrt(c)$ã€‚ ä¸ºä»€ä¹ˆ $low^2+high^2\u003cc$ æ—¶ï¼Œè¦è®© low++ è€Œä¸æ˜¯ high++ å‘¢ï¼Ÿæˆ–è€…è¯´ä¸ºä»€ä¹ˆè®© low++ å¯ä»¥ä¿è¯ä¸é”™è¿‡æ­£ç¡®ç­”æ¡ˆå‘¢ï¼Ÿ åŒç†ï¼Œä¸ºä»€ä¹ˆ $low^2+high^2\u003ec$ æ—¶ï¼Œè¦è®© high-- è€Œä¸æ˜¯ low-- å‘¢ï¼Ÿæˆ–è€…è¯´ä¸ºä»€ä¹ˆè®© high-- å¯ä»¥ä¿è¯ä¸é”™è¿‡æ­£ç¡®ç­”æ¡ˆå‘¢ï¼Ÿ å…¶å®æˆ‘ä»¬å¯ä»¥æŠŠåŒæŒ‡é’ˆçš„è¿‡ç¨‹çœ‹æˆåœ¨ä¸€ä¸ªçŸ©é˜µä¸­æœå¯»çš„è¿‡ç¨‹ã€‚ä¸¾ä¸ªä¾‹å­ï¼Œc = 18ï¼Œåˆå§‹åŒ– low = 0ï¼Œhigh = 4ï¼Œé‚£ä¹ˆçœ‹å¦‚ä¸‹çŸ©é˜µï¼š çŸ©é˜µ çŸ©é˜µæ²¿ä¸»å¯¹è§’çº¿å¯¹ç§° ($low\u003c=high$)ï¼Œå…¶ä¸­çš„å…ƒç´ è¡¨ç¤º $low^2+high^2$ çš„å€¼ï¼Œé»„è‰²æ ¼å­è¡¨ç¤ºå½“å‰çš„ $low^2+high^2$ï¼Œç»¿è‰²æ ¼å­è¡¨ç¤ºç›®æ ‡ cï¼Œlow++ ç›¸å½“äºè®©é»„è‰²æ ¼å­ä¸‹ç§»ï¼Œhigh-- åˆ™ç›¸å½“äºè®©é»„è‰²æ ¼å­å·¦ç§»ã€‚è¿™é‡ŒçŸ©é˜µçš„æ€§è´¨å’Œæœç´¢çš„è¿‡ç¨‹å…¶å®å’Œæœç´¢äºŒç»´çŸ©é˜µ IIæ˜¯ä¸€æ ·çš„ã€‚æ¯ä¸€åˆ—ä»ä¸Šåˆ°ä¸‹å‡åºï¼Œæ¯ä¸€è¡Œä»å·¦åˆ°å³å‡åºã€‚ æŸ¥æ‰¾çš„è¿‡ç¨‹å…·æœ‰å¦‚ä¸‹æ€§è´¨ï¼š åˆå§‹åŒ–æ—¶é»„è‰²æ ¼å­å¿…å®šåœ¨çŸ©é˜µçš„å³ä¸Šè§’ã€‚ æ¯æ¬¡æ¯”è¾ƒ $low^2+high^2$ å¯ä»¥æ’é™¤çŸ©é˜µçš„ä¸€è¡Œæˆ–ä¸€åˆ—ã€‚ å¦‚ä¸‹å›¾ï¼š çŸ©é˜µ ç”±äºä»¥ä¸Šæ€§è´¨ï¼Œå½“å‰é»„è‰²æ ¼å­çš„ä¸Šæ–¹å’Œå³è¾¹çš„æ‰€æœ‰å…ƒç´ ä¸€å®šæ˜¯å·²ç»è¢«æ’é™¤çš„ï¼Œæ‰€ä»¥é»„è‰²æ ¼å­åœ¨æœç´¢è¿‡ç¨‹ä¸­åªæœ‰ä¸¤ç§è¡Œä¸ºï¼š å°äº ccc ï¼šå·¦è¾¹çš„å…ƒç´ éƒ½å°äºå½“å‰å…ƒç´ ï¼Œåªèƒ½ä¸‹ç§»ï¼Œç›¸å½“äº low++ã€‚æ­¤æ—¶æ’é™¤çš„æ˜¯é»„è‰²æ ¼å­ä»¥åŠå·¦è¾¹åŒè¡Œçš„å…ƒç´ ï¼Œéƒ½å°äº ccc ï¼Œæ‰€ä»¥ä¸ä¼šé”™è¿‡æ­£ç¡®ç­”æ¡ˆã€‚ å¤§äº ccc ï¼šä¸‹é¢çš„å…ƒç´ éƒ½å¤§äºå½“å‰å…ƒç´ ï¼Œåªèƒ½å·¦ç§»ï¼Œç›¸å½“äº high--ã€‚æ­¤æ—¶æ’é™¤çš„æ˜¯é»„è‰²æ ¼å­ä»¥åŠä¸‹æ–¹åŒåˆ—çš„å…ƒç´ ï¼Œéƒ½å¤§äº ccc ï¼Œæ‰€ä»¥ä¸ä¼šé”™è¿‡æ­£ç¡®ç­”æ¡ˆã€‚ å¦‚æ­¤ä¸€æ¥ï¼ŒåŒæŒ‡é’ˆè¿™ä¸ªæ“ä½œå°±ååˆ†è‡ªç„¶äº†ã€‚ def judgeSquareSum(c: int) -\u003e bool: low, high = 0, int(c**0.5) while low \u003c= high: sumOf = low*low + high*high if sumOf == c: return True elif sumOf \u003c c: low += 1 else: high -= 1 return False å¤æ‚åº¦åˆ†æ çŸ©é˜µçš„è¡Œæ•°å’Œåˆ—æ•°éƒ½æ˜¯ $\\sqrt{c}$ï¼Œæ‰€ä»¥æ—¶é—´å¤æ‚åº¦ä¸º $O(\\sqrt{c})$ã€‚ ä¸ºä»€ä¹ˆåŒæŒ‡é’ˆä¸ä¼šé”™è¿‡æ­£ç¡®ç­”æ¡ˆï¼ŸåŒæŒ‡é’ˆçš„æœ¬è´¨ã€‚Â â†©ï¸ ","date":"2022-12-02","objectID":"/sum-of-square-numbers/:0:0","tags":["åŠ›æ‰£"],"title":"åŠ›æ‰£-å¹³æ–¹æ•°ä¹‹å’Œ ","uri":"/sum-of-square-numbers/"},{"categories":["åˆ·é¢˜"],"content":"åŠ›æ‰£-å­—ç¬¦ä¸²ç›¸åŠ ","date":"2022-12-02","objectID":"/add-strings/","tags":["åŠ›æ‰£"],"title":"åŠ›æ‰£-å­—ç¬¦ä¸²ç›¸åŠ  ","uri":"/add-strings/"},{"categories":["åˆ·é¢˜"],"content":"ğŸ”— é¢˜ç›®é“¾æ¥ ç»™å®šä¸¤ä¸ªå­—ç¬¦ä¸²å½¢å¼çš„éè´Ÿæ•´æ•° num1 å’Œ num2ï¼Œè®¡ç®—å®ƒä»¬çš„å’Œå¹¶åŒæ ·ä»¥å­—ç¬¦ä¸²å½¢å¼è¿”å›ã€‚ ä½ ä¸èƒ½ä½¿ç”¨ä»»ä½•å…§å»ºçš„ç”¨äºå¤„ç†å¤§æ•´æ•°çš„åº“ï¼ˆæ¯”å¦‚ BigIntegerï¼‰ï¼Œ ä¹Ÿä¸èƒ½ç›´æ¥å°†è¾“å…¥çš„å­—ç¬¦ä¸²è½¬æ¢ä¸ºæ•´æ•°å½¢å¼ã€‚ ç¤ºä¾‹ 1ï¼š è¾“å…¥ï¼šnum1 = â€œ11â€, num2 = â€œ123â€ è¾“å‡ºï¼šâ€œ134â€ ç¤ºä¾‹ 2ï¼š è¾“å…¥ï¼šnum1 = â€œ456â€, num2 = â€œ77â€ è¾“å‡ºï¼šâ€œ533â€ ç¤ºä¾‹ 3ï¼š è¾“å…¥ï¼šnum1 = â€œ0â€, num2 = â€œ0â€ è¾“å‡ºï¼šâ€œ0â€ æç¤ºï¼š $1 \u003c= num1.length, num2.length \u003c= 10^4$ num1 å’Œ num2 éƒ½åªåŒ…å«æ•°å­— 0-9 num1 å’Œ num2 éƒ½ä¸åŒ…å«ä»»ä½•å‰å¯¼é›¶ ","date":"2022-12-02","objectID":"/add-strings/:0:0","tags":["åŠ›æ‰£"],"title":"åŠ›æ‰£-å­—ç¬¦ä¸²ç›¸åŠ  ","uri":"/add-strings/"},{"categories":["åˆ·é¢˜"],"content":"ç®—æ³•æµç¨‹ å­—ç¬¦ä¸²ç›¸åŠ  ï¼ˆåŒæŒ‡é’ˆï¼Œæ¸…æ™°å›¾è§£ï¼‰1 è®¾å®š iï¼Œj ä¸¤æŒ‡é’ˆåˆ†åˆ«æŒ‡å‘ num1ï¼Œnum2 å°¾éƒ¨ï¼Œæ¨¡æ‹Ÿäººå·¥åŠ æ³•ï¼› è®¡ç®—è¿›ä½ï¼š è®¡ç®— carry = tmp // 10ï¼Œä»£è¡¨å½“å‰ä½ç›¸åŠ æ˜¯å¦äº§ç”Ÿè¿›ä½ï¼› æ·»åŠ å½“å‰ä½ï¼š è®¡ç®— tmp = n1 + n2 + carryï¼Œå¹¶å°†å½“å‰ä½ tmp % 10 æ·»åŠ è‡³ res å¤´éƒ¨ï¼› ç´¢å¼•æº¢å‡ºå¤„ç†ï¼š å½“æŒ‡é’ˆ i æˆ– j èµ°è¿‡æ•°å­—é¦–éƒ¨åï¼Œç»™ n1ï¼Œn2 èµ‹å€¼ä¸º 0ï¼Œç›¸å½“äºç»™ num1ï¼Œnum2 ä¸­é•¿åº¦è¾ƒçŸ­çš„æ•°å­—å‰é¢å¡« 0ï¼Œä»¥ä¾¿åç»­è®¡ç®—ã€‚ å½“éå†å®Œ num1ï¼Œnum2 åè·³å‡ºå¾ªç¯ï¼Œå¹¶æ ¹æ® carry å€¼å†³å®šæ˜¯å¦åœ¨å¤´éƒ¨æ·»åŠ è¿›ä½ 1ï¼Œæœ€ç»ˆè¿”å› res å³å¯ã€‚ def addStrings(num1: str, num2: str) -\u003e str: res = \"\" i, j, carry = len(num1) - 1, len(num2) - 1, 0 while i \u003e= 0 or j \u003e= 0: n1 = int(num1[i]) if i \u003e= 0 else 0 n2 = int(num2[j]) if j \u003e= 0 else 0 tmp = n1 + n2 + carry carry = tmp // 10 res = str(tmp % 10) + res i, j = i - 1, j - 1 return \"1\" + res if carry else res å¤æ‚åº¦åˆ†æ æ—¶é—´å¤æ‚åº¦ $O(max(M,N))$ï¼šå…¶ä¸­ $M$ï¼Œ$N$ ä¸º $2$ æ•°å­—é•¿åº¦ï¼ŒæŒ‰ä½éå†ä¸€éæ•°å­—ï¼ˆä»¥è¾ƒé•¿çš„æ•°å­—ä¸ºå‡†ï¼‰ï¼› ç©ºé—´å¤æ‚åº¦ $O(1)$ï¼šæŒ‡é’ˆä¸å˜é‡ä½¿ç”¨å¸¸æ•°å¤§å°ç©ºé—´ã€‚ å­—ç¬¦ä¸²ç›¸åŠ  ï¼ˆåŒæŒ‡é’ˆï¼Œæ¸…æ™°å›¾è§£ï¼‰Â â†©ï¸ ","date":"2022-12-02","objectID":"/add-strings/:1:0","tags":["åŠ›æ‰£"],"title":"åŠ›æ‰£-å­—ç¬¦ä¸²ç›¸åŠ  ","uri":"/add-strings/"},{"categories":["åˆ·é¢˜"],"content":"åŠ›æ‰£-xçš„å¹³æ–¹æ ¹","date":"2022-12-02","objectID":"/sqrtx/","tags":["åŠ›æ‰£"],"title":"åŠ›æ‰£-xçš„å¹³æ–¹æ ¹ ","uri":"/sqrtx/"},{"categories":["åˆ·é¢˜"],"content":"ğŸ”— é¢˜ç›®é“¾æ¥ ç»™ä½ ä¸€ä¸ªéè´Ÿæ•´æ•° x ï¼Œè®¡ç®—å¹¶è¿”å› x çš„ç®—æœ¯å¹³æ–¹æ ¹ã€‚ ç”±äºè¿”å›ç±»å‹æ˜¯æ•´æ•°ï¼Œç»“æœåªä¿ç•™æ•´æ•°éƒ¨åˆ†ï¼Œå°æ•°éƒ¨åˆ†å°†è¢«èˆå»ã€‚ æ³¨æ„ï¼šä¸å…è®¸ä½¿ç”¨ä»»ä½•å†…ç½®æŒ‡æ•°å‡½æ•°å’Œç®—ç¬¦ï¼Œä¾‹å¦‚ pow(x, 0.5) æˆ–è€… x ** 0.5ã€‚ ç¤ºä¾‹ 1ï¼š è¾“å…¥ï¼šx = 4 è¾“å‡ºï¼š2 ç¤ºä¾‹ 2ï¼š è¾“å…¥ï¼šx = 8 è¾“å‡ºï¼š2 è§£é‡Šï¼š8 çš„ç®—æœ¯å¹³æ–¹æ ¹æ˜¯ 2.82842â€¦, ç”±äºè¿”å›ç±»å‹æ˜¯æ•´æ•°ï¼Œå°æ•°éƒ¨åˆ†å°†è¢«èˆå»ã€‚ æç¤ºï¼š $0 \u003c= x \u003c= 2^{31} - 1$ ","date":"2022-12-02","objectID":"/sqrtx/:0:0","tags":["åŠ›æ‰£"],"title":"åŠ›æ‰£-xçš„å¹³æ–¹æ ¹ ","uri":"/sqrtx/"},{"categories":["åˆ·é¢˜"],"content":"äºŒåˆ†æŸ¥æ‰¾ å‚è€ƒé“¾æ¥ï¼šx çš„å¹³æ–¹æ ¹1 ç”±äº $x$ å¹³æ–¹æ ¹çš„æ•´æ•°éƒ¨åˆ† $ans$ æ˜¯æ»¡è¶³ $k^2 \\leq x$ çš„æœ€å¤§ $k$ å€¼ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥å¯¹ $k$ è¿›è¡ŒäºŒåˆ†æŸ¥æ‰¾ï¼Œä»è€Œå¾—åˆ°ç­”æ¡ˆã€‚ äºŒåˆ†æŸ¥æ‰¾çš„ä¸‹ç•Œä¸º $0$ï¼Œä¸Šç•Œå¯ä»¥ç²—ç•¥åœ°è®¾å®šä¸º $x$ã€‚åœ¨äºŒåˆ†æŸ¥æ‰¾çš„æ¯ä¸€æ­¥ä¸­ï¼Œæˆ‘ä»¬åªéœ€è¦æ¯”è¾ƒä¸­é—´å…ƒç´  $mid$ çš„å¹³æ–¹ä¸ $x$ çš„å¤§å°å…³ç³»ï¼Œå¹¶é€šè¿‡æ¯”è¾ƒçš„ç»“æœè°ƒæ•´ä¸Šä¸‹ç•Œçš„èŒƒå›´ã€‚ç”±äºæˆ‘ä»¬æ‰€æœ‰çš„è¿ç®—éƒ½æ˜¯æ•´æ•°è¿ç®—ï¼Œä¸ä¼šå­˜åœ¨è¯¯å·®ï¼Œå› æ­¤åœ¨å¾—åˆ°æœ€ç»ˆçš„ç­”æ¡ˆ $ans$ åï¼Œä¹Ÿå°±ä¸éœ€è¦å†å»å°è¯• $ans + 1$ äº†ã€‚ def mySqrt(x): l, r, ans = 0, x, -1 while l \u003c= r: mid = (l + r) // 2 if mid * mid \u003c= x: ans = mid l = mid + 1 else: r = mid - 1 return ans å¤æ‚åº¦åˆ†æ æ—¶é—´å¤æ‚åº¦ï¼š$O(logâ¡x)$ï¼Œå³ä¸ºäºŒåˆ†æŸ¥æ‰¾éœ€è¦çš„æ¬¡æ•°ã€‚ ç©ºé—´å¤æ‚åº¦ï¼š$O(1)$ã€‚ x çš„å¹³æ–¹æ ¹Â â†©ï¸ ","date":"2022-12-02","objectID":"/sqrtx/:1:0","tags":["åŠ›æ‰£"],"title":"åŠ›æ‰£-xçš„å¹³æ–¹æ ¹ ","uri":"/sqrtx/"},{"categories":["å­¦ä¹ "],"content":"ä»€ä¹ˆæ˜¯åˆ†åŒºåˆ†æ¡¶ï¼Ÿ","date":"2022-12-01","objectID":"/bucket/","tags":["æ•°ä»“"],"title":"ä»€ä¹ˆæ˜¯åˆ†åŒºåˆ†æ¡¶ï¼Ÿ","uri":"/bucket/"},{"categories":["å­¦ä¹ "],"content":"åˆ†åŒºå’Œåˆ†æ¡¶é¢è¯•è¿‡ç¨‹ä¸­ä¼šç»å¸¸è€ƒå¯Ÿï¼Œéœ€è¦é‡ç‚¹æŒæ¡ã€‚ ","date":"2022-12-01","objectID":"/bucket/:0:0","tags":["æ•°ä»“"],"title":"ä»€ä¹ˆæ˜¯åˆ†åŒºåˆ†æ¡¶ï¼Ÿ","uri":"/bucket/"},{"categories":["å­¦ä¹ "],"content":"åˆ†åŒº åˆ†åŒº ","date":"2022-12-01","objectID":"/bucket/:1:0","tags":["æ•°ä»“"],"title":"ä»€ä¹ˆæ˜¯åˆ†åŒºåˆ†æ¡¶ï¼Ÿ","uri":"/bucket/"},{"categories":["å­¦ä¹ "],"content":"ä»€ä¹ˆæ˜¯åˆ†åŒº å°†æ•´ä¸ªè¡¨çš„æ•°æ®åœ¨å­˜å‚¨æ—¶ï¼ŒæŒ‰ç…§ â€œåˆ†åŒºé”®çš„åˆ—å€¼â€ åˆ’åˆ†æˆå¤šä¸ªå­ç›®å½•æ¥å­˜å‚¨ã€‚åŒºä»å½¢å¼ä¸Šå¯ä»¥ç†è§£ä¸ºæ–‡ä»¶å¤¹ã€‚ æ³¨æ„ï¼šå­ç›®å½•åç§°å°±æ˜¯åˆ†åŒºåï¼ˆåˆ†åŒºé”®çš„åˆ—å€¼ï¼‰ã€‚ ","date":"2022-12-01","objectID":"/bucket/:1:1","tags":["æ•°ä»“"],"title":"ä»€ä¹ˆæ˜¯åˆ†åŒºåˆ†æ¡¶ï¼Ÿ","uri":"/bucket/"},{"categories":["å­¦ä¹ "],"content":"ä¸ºä»€ä¹ˆè¦åˆ†åŒº éšç€ç³»ç»Ÿè¿è¡Œæ—¶é—´çš„å¢åŠ ï¼Œè¡¨çš„æ•°æ®é‡ä¼šè¶Šæ¥è¶Šå¤§ï¼Œè€Œ Hive æŸ¥è¯¢æ•°æ®çš„æ•°æ®çš„æ—¶å€™é€šå¸¸ä½¿ç”¨çš„æ˜¯â€œå…¨è¡¨æ‰«æâ€ï¼Œè¿™æ ·å°†ä¼šå¯¼è‡´æŸ¥è¯¢æ•ˆç‡å¤§å¤§çš„é™ä½ã€‚ Hive å¼•è¿›çš„åˆ†åŒºæŠ€æœ¯ï¼Œèƒ½é¿å… Hive å…¨è¡¨æ‰«æï¼Œæå‡æŸ¥è¯¢æ•ˆç‡ã€‚ æ¯”å¦‚æˆ‘ä»¬è¦æ”¶é›†æŸä¸ªå¤§å‹ç½‘ç«™çš„æ—¥å¿—æ•°æ®ï¼Œä¸€ä¸ªç½‘ç«™æ¯å¤©çš„æ—¥å¿—æ•°æ®å­˜åœ¨åŒä¸€å¼ è¡¨ä¸Šï¼Œç”±äºæ¯å¤©ä¼šç”Ÿæˆå¤§é‡çš„æ—¥å¿—ï¼Œå¯¼è‡´æ•°æ®è¡¨çš„å†…å®¹å·¨å¤§ï¼Œåœ¨æŸ¥è¯¢æ—¶è¿›è¡Œå…¨è¡¨æ‰«æè€—è´¹çš„èµ„æºéå¸¸å¤šã€‚é‚£å…¶å®è¿™ä¸ªæƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å¯ä»¥æŒ‰ç…§æ—¥æœŸå¯¹æ•°æ®è¡¨è¿›è¡Œåˆ†åŒºï¼Œä¸åŒæ—¥æœŸçš„æ•°æ®å­˜æ”¾åœ¨ä¸åŒçš„åˆ†åŒºï¼Œåœ¨æŸ¥è¯¢æ—¶åªè¦æŒ‡å®šåˆ†åŒºå­—æ®µçš„å€¼å°±å¯ä»¥ç›´æ¥ä»è¯¥åˆ†åŒºæŸ¥æ‰¾ã€‚ ","date":"2022-12-01","objectID":"/bucket/:1:2","tags":["æ•°ä»“"],"title":"ä»€ä¹ˆæ˜¯åˆ†åŒºåˆ†æ¡¶ï¼Ÿ","uri":"/bucket/"},{"categories":["å­¦ä¹ "],"content":"åˆ›å»ºåˆ†åŒºè¡¨ åˆ›å»ºåˆ†åŒºè¡¨çš„æ—¶å€™ï¼Œè¦é€šè¿‡å…³é”®å­— partitioned by (name string) å£°æ˜è¯¥è¡¨æ˜¯åˆ†åŒºè¡¨ï¼Œå¹¶ä¸”æ˜¯æŒ‰ç…§å­—æ®µ name è¿›è¡Œåˆ†åŒºï¼Œname å€¼ä¸€è‡´çš„æ‰€æœ‰è®°å½•å­˜æ”¾åœ¨ä¸€ä¸ªåˆ†åŒºä¸­ï¼Œåˆ†åŒºå±æ€§ name çš„ç±»å‹æ˜¯ string ç±»å‹ã€‚å½“ç„¶ï¼Œå¯ä»¥ä¾æ®å¤šä¸ªåˆ—è¿›è¡Œåˆ†åŒºï¼Œå³å¯¹æŸä¸ªåˆ†åŒºçš„æ•°æ®æŒ‰ç…§æŸäº›åˆ—ç»§ç»­åˆ†åŒºã€‚ æ³¨æ„ åƒä¸‡ä¸è¦ä»¥ä¸ºæ˜¯å¯¹å±æ€§è¡¨ä¸­çœŸæ­£å­˜åœ¨çš„åˆ—æŒ‰ç…§å±æ€§å€¼çš„å¼‚åŒè¿›è¡Œåˆ†åŒºã€‚æ¯”å¦‚ä¸Šé¢çš„åˆ†åŒºä¾æ®çš„åˆ— name å¹¶ä¸çœŸæ­£çš„å­˜åœ¨äºæ•°æ®è¡¨ä¸­ï¼Œæ˜¯æˆ‘ä»¬ä¸ºäº†æ–¹ä¾¿ç®¡ç†æ·»åŠ çš„ä¸€ä¸ªä¼ªåˆ—ï¼Œè¿™ä¸ªåˆ—çš„å€¼ä¹Ÿæ˜¯æˆ‘ä»¬äººä¸ºè§„å®šçš„ï¼Œä¸æ˜¯ä»æ•°æ®è¡¨ä¸­è¯»å–ä¹‹åæ ¹æ®å€¼çš„ä¸åŒå°†å…¶åˆ†åŒºã€‚æˆ‘ä»¬å¹¶ä¸èƒ½æŒ‰ç…§æŸä¸ªæ•°æ®è¡¨ä¸­çœŸå®å­˜åœ¨çš„åˆ—ï¼Œå¦‚useridæ¥åˆ†åŒºã€‚ ","date":"2022-12-01","objectID":"/bucket/:1:3","tags":["æ•°ä»“"],"title":"ä»€ä¹ˆæ˜¯åˆ†åŒºåˆ†æ¡¶ï¼Ÿ","uri":"/bucket/"},{"categories":["å­¦ä¹ "],"content":"åˆ†æ¡¶ ","date":"2022-12-01","objectID":"/bucket/:2:0","tags":["æ•°ä»“"],"title":"ä»€ä¹ˆæ˜¯åˆ†åŒºåˆ†æ¡¶ï¼Ÿ","uri":"/bucket/"},{"categories":["å­¦ä¹ "],"content":"ä»€ä¹ˆæ˜¯åˆ†æ¡¶ åˆ†æ¡¶æ˜¯ç›¸å¯¹åˆ†åŒºè¿›è¡Œæ›´ç»†ç²’åº¦çš„åˆ’åˆ†ã€‚æ¡¶æ˜¯é€šè¿‡å¯¹æŒ‡å®šåˆ—è¿›è¡Œå“ˆå¸Œè®¡ç®—æ¥å®ç°çš„ï¼Œé€šè¿‡å“ˆå¸Œå€¼å°†ä¸€ä¸ªåˆ—åä¸‹çš„æ•°æ®åˆ‡åˆ†ä¸ºä¸€ç»„æ¡¶ï¼Œå¹¶ä½¿æ¯ä¸ªæ¡¶å¯¹åº”äºè¯¥åˆ—åä¸‹çš„ä¸€ä¸ªå­˜å‚¨æ–‡ä»¶ã€‚ æ³¨æ„ï¼šåœ¨ hdfs ç›®å½•ä¸Šï¼Œæ¡¶æ˜¯ä»¥æ–‡ä»¶çš„å½¢å¼å­˜åœ¨çš„ï¼Œè€Œä¸æ˜¯åƒåˆ†åŒºé‚£æ ·ä»¥æ–‡ä»¶å¤¹çš„å½¢å¼å­˜åœ¨ã€‚ ","date":"2022-12-01","objectID":"/bucket/:2:1","tags":["æ•°ä»“"],"title":"ä»€ä¹ˆæ˜¯åˆ†åŒºåˆ†æ¡¶ï¼Ÿ","uri":"/bucket/"},{"categories":["å­¦ä¹ "],"content":"ä¸ºä»€ä¹ˆè¦åˆ†æ¡¶ åœ¨åˆ†åŒºæ•°é‡è¿‡äºåºå¤§ä»¥è‡³äºå¯èƒ½å¯¼è‡´æ–‡ä»¶ç³»ç»Ÿå´©æºƒæ—¶ï¼Œæˆ‘ä»¬å°±éœ€è¦ä½¿ç”¨åˆ†æ¡¶æ¥è§£å†³é—®é¢˜äº†ã€‚ åˆ†åŒºä¸­çš„æ•°æ®å¯ä»¥è¢«è¿›ä¸€æ­¥æ‹†åˆ†æˆæ¡¶ï¼Œä¸åŒäºåˆ†åŒºå¯¹åˆ—ç›´æ¥è¿›è¡Œæ‹†åˆ†ï¼Œæ¡¶å¾€å¾€ä½¿ç”¨åˆ—çš„å“ˆå¸Œå€¼å¯¹æ•°æ®æ‰“æ•£ï¼Œå¹¶åˆ†å‘åˆ°å„ä¸ªä¸åŒçš„æ¡¶ä¸­ä»è€Œå®Œæˆæ•°æ®çš„åˆ†æ¡¶è¿‡ç¨‹ã€‚ æ³¨æ„ hive ä½¿ç”¨å¯¹åˆ†æ¡¶æ‰€ç”¨çš„å€¼è¿›è¡Œ hashï¼Œå¹¶ç”¨ hash ç»“æœé™¤ä»¥æ¡¶çš„ä¸ªæ•°åšå–ä½™è¿ç®—çš„æ–¹å¼æ¥åˆ†æ¡¶ï¼Œä¿è¯äº†æ¯ä¸ªæ¡¶ä¸­éƒ½æœ‰æ•°æ®ï¼Œä½†æ¯ä¸ªæ¡¶ä¸­çš„æ•°æ®æ¡æ•°ä¸ä¸€å®šç›¸ç­‰ã€‚ ","date":"2022-12-01","objectID":"/bucket/:2:2","tags":["æ•°ä»“"],"title":"ä»€ä¹ˆæ˜¯åˆ†åŒºåˆ†æ¡¶ï¼Ÿ","uri":"/bucket/"},{"categories":["å­¦ä¹ "],"content":"åˆ›å»ºåˆ†æ¡¶ ä¸åˆ†åŒºä¸åŒçš„æ˜¯ï¼Œåˆ†åŒºä¾æ®çš„ä¸æ˜¯çœŸå®æ•°æ®è¡¨æ–‡ä»¶ä¸­çš„åˆ—ï¼Œè€Œæ˜¯æˆ‘ä»¬æŒ‡å®šçš„ä¼ªåˆ—ï¼Œä½†æ˜¯åˆ†æ¡¶æ˜¯ä¾æ®æ•°æ®è¡¨ä¸­çœŸå®çš„åˆ—è€Œä¸æ˜¯ä¼ªåˆ—ã€‚æ‰€ä»¥åœ¨æŒ‡å®šåˆ†åŒºä¾æ®çš„åˆ—çš„æ—¶å€™è¦æŒ‡å®šåˆ—çš„ç±»å‹ï¼Œå› ä¸ºåœ¨æ•°æ®è¡¨æ–‡ä»¶ä¸­ä¸å­˜åœ¨è¿™ä¸ªåˆ—ï¼Œç›¸å½“äºæ–°å»ºä¸€ä¸ªåˆ—ã€‚è€Œåˆ†æ¡¶ä¾æ®çš„æ˜¯è¡¨ä¸­å·²ç»å­˜åœ¨çš„åˆ—ï¼Œè¿™ä¸ªåˆ—çš„æ•°æ®ç±»å‹æ˜¾ç„¶æ˜¯å·²çŸ¥çš„ï¼Œæ‰€ä»¥ä¸éœ€è¦æŒ‡å®šåˆ—çš„ç±»å‹ã€‚ ","date":"2022-12-01","objectID":"/bucket/:2:3","tags":["æ•°ä»“"],"title":"ä»€ä¹ˆæ˜¯åˆ†åŒºåˆ†æ¡¶ï¼Ÿ","uri":"/bucket/"},{"categories":["å­¦ä¹ "],"content":"Mysql é¢è¯•é¢˜","date":"2022-12-01","objectID":"/mysql-ques/","tags":["mysql"],"title":"Mysql é¢è¯•é¢˜","uri":"/mysql-ques/"},{"categories":["å­¦ä¹ "],"content":"å²ä¸Šæœ€å…¨çš„å¤§å‚ Mysql é¢è¯•é¢˜åœ¨è¿™é‡Œã€‚ ","date":"2022-12-01","objectID":"/mysql-ques/:0:0","tags":["mysql"],"title":"Mysql é¢è¯•é¢˜","uri":"/mysql-ques/"},{"categories":["å­¦ä¹ "],"content":"MySQL ä¸­ myisam ä¸ innodbçš„åŒºåˆ« ","date":"2022-12-01","objectID":"/mysql-ques/:1:0","tags":["mysql"],"title":"Mysql é¢è¯•é¢˜","uri":"/mysql-ques/"},{"categories":["å­¦ä¹ "],"content":"é—® 5 ç‚¹ä¸åŒ InnoDB æ”¯æŒäº‹ç‰©ï¼Œè€Œ MyISAM ä¸æ”¯æŒäº‹ç‰© InnoDB æ”¯æŒè¡Œçº§é”ï¼Œè€Œ MyISAM æ”¯æŒè¡¨çº§é” InnoDB æ”¯æŒ MVCC, è€Œ MyISAM ä¸æ”¯æŒ InnoDB æ”¯æŒå¤–é”®ï¼Œè€Œ MyISAM ä¸æ”¯æŒ InnoDB ä¸æ”¯æŒå…¨æ–‡ç´¢å¼•ï¼Œè€Œ MyISAM æ”¯æŒã€‚ ","date":"2022-12-01","objectID":"/mysql-ques/:1:1","tags":["mysql"],"title":"Mysql é¢è¯•é¢˜","uri":"/mysql-ques/"},{"categories":["å­¦ä¹ "],"content":"innodb å¼•æ“çš„ 4 å¤§ç‰¹æ€§ æ’å…¥ç¼“å†²insert buffer äºŒæ¬¡å†™double write è‡ªé€‚åº”å“ˆå¸Œç´¢å¼•ahi é¢„è¯»read ahead ","date":"2022-12-01","objectID":"/mysql-ques/:1:2","tags":["mysql"],"title":"Mysql é¢è¯•é¢˜","uri":"/mysql-ques/"},{"categories":["å­¦ä¹ "],"content":"2 è€… select count(*) å“ªä¸ªæ›´å¿«ï¼Œä¸ºä»€ä¹ˆ myisam æ›´å¿«ï¼Œå› ä¸º myisam å†…éƒ¨ç»´æŠ¤äº†ä¸€ä¸ªè®¡æ•°å™¨ï¼Œå¯ä»¥ç›´æ¥è°ƒå–ã€‚ ","date":"2022-12-01","objectID":"/mysql-ques/:1:3","tags":["mysql"],"title":"Mysql é¢è¯•é¢˜","uri":"/mysql-ques/"},{"categories":["å­¦ä¹ "],"content":"å¤§æ•°æ®ä¹‹ Reduce Join","date":"2022-12-01","objectID":"/reducejoin/","tags":["æ•°ä»“"],"title":"å¤§æ•°æ®ä¹‹ Reduce Join","uri":"/reducejoin/"},{"categories":["å­¦ä¹ "],"content":"ä»‹ç» hive é‡Œçš„ Reduce Join çš„ä¸€äº›åŸç†å’Œä½¿ç”¨æŠ€å·§ã€‚ ","date":"2022-12-01","objectID":"/reducejoin/:0:0","tags":["æ•°ä»“"],"title":"å¤§æ•°æ®ä¹‹ Reduce Join","uri":"/reducejoin/"},{"categories":["å­¦ä¹ "],"content":"åº”ç”¨åœºæ™¯ é€‚åˆäºå¤§è¡¨ Join å¤§è¡¨ ","date":"2022-12-01","objectID":"/reducejoin/:1:0","tags":["æ•°ä»“"],"title":"å¤§æ•°æ®ä¹‹ Reduce Join","uri":"/reducejoin/"},{"categories":["å­¦ä¹ "],"content":"åŸç† åŸç† å°†ä¸¤å¼ è¡¨çš„æ•°æ®åœ¨ shuffle é˜¶æ®µåˆ©ç”¨ shuffle çš„åˆ†ç»„æ¥å°†æ•°æ®æŒ‰ç…§å…³è”å­—æ®µè¿›è¡Œåˆå¹¶ å¿…é¡»ç»è¿‡ shuffleï¼Œåˆ©ç”¨ Shuffle è¿‡ç¨‹ä¸­çš„åˆ†ç»„æ¥å®ç°å…³è” ","date":"2022-12-01","objectID":"/reducejoin/:2:0","tags":["æ•°ä»“"],"title":"å¤§æ•°æ®ä¹‹ Reduce Join","uri":"/reducejoin/"},{"categories":["å­¦ä¹ "],"content":"è¿‡ç¨‹ Mapé˜¶æ®µï¼šæ„å»ºï¼ˆkey(tag),valueï¼‰,key è¿™é‡Œåé¢çš„æ•°å­—æ˜¯ tagï¼Œåé¢åœ¨ reduce é˜¶æ®µç”¨æ¥åŒºåˆ†æ¥è‡ªäºé‚£ä¸ªè¡¨çš„æ•°æ®ï¼Œå¯¹ key æ±‚ hashcode è®¾ä¸º hivekeyï¼› Shuffleé˜¶æ®µï¼šå¦‚æœ key åœ¨ä¸åŒæœºå™¨ä¸Šï¼Œä¼šé€šè¿‡ç½‘ç»œä¼ è¾“æŠŠ hivekey ç›¸åŒçš„æ•°æ®æ±‡é›†åˆ°ä¸€å°æœºå™¨ï¼› Reduceé˜¶æ®µï¼šæŠŠ tag=1 çš„å†…å®¹ï¼ˆvalueï¼‰ï¼Œéƒ½åŠ åˆ° tag=0 çš„åé¢ï¼Œåˆå¹¶è¾“å‡ºã€‚ reduce joinåŸç† ","date":"2022-12-01","objectID":"/reducejoin/:3:0","tags":["æ•°ä»“"],"title":"å¤§æ•°æ®ä¹‹ Reduce Join","uri":"/reducejoin/"},{"categories":["å­¦ä¹ "],"content":"ä½¿ç”¨ Hive ä¼šè‡ªåŠ¨åˆ¤æ–­æ˜¯å¦æ»¡è¶³ Map Joinï¼Œå¦‚æœä¸æ»¡è¶³ Map Joinï¼Œåˆ™è‡ªåŠ¨æ‰§è¡Œ Reduce Joinã€‚ ","date":"2022-12-01","objectID":"/reducejoin/:4:0","tags":["æ•°ä»“"],"title":"å¤§æ•°æ®ä¹‹ Reduce Join","uri":"/reducejoin/"},{"categories":["å­¦ä¹ "],"content":"å¤§è¡¨joinå°è¡¨ï¼Œç‹¬é’Ÿçˆ±mapjoin","date":"2022-12-01","objectID":"/mapjoin/","tags":["æ•°ä»“"],"title":"å¤§è¡¨joinå°è¡¨ï¼Œç‹¬é’Ÿçˆ±mapjoin","uri":"/mapjoin/"},{"categories":["å­¦ä¹ "],"content":"åœ¨ Hive è°ƒä¼˜é‡Œé¢ï¼Œç»å¸¸ä¼šé—®åˆ°ä¸€ä¸ªå¾ˆå°çš„è¡¨å’Œä¸€ä¸ªå¤§è¡¨è¿›è¡Œ joinï¼Œå¦‚ä½•ä¼˜åŒ–ã€‚ Shuffle é˜¶æ®µä»£ä»·éå¸¸æ˜‚è´µï¼Œå› ä¸ºå®ƒéœ€è¦æ’åºå’Œåˆå¹¶ã€‚å‡å°‘ Shuffle å’Œ Reduce é˜¶æ®µçš„ä»£ä»·å¯ä»¥æé«˜ä»»åŠ¡æ€§èƒ½ã€‚ MapJoin é€šå¸¸ç”¨äºä¸€ä¸ªå¾ˆå°çš„è¡¨å’Œä¸€ä¸ªå¤§è¡¨è¿›è¡Œ join çš„åœºæ™¯ï¼Œå…·ä½“å°è¡¨æœ‰å¤šå°ï¼Œç”±å‚æ•° hive.mapjoin.smalltable.filesize æ¥å†³å®šï¼Œè¯¥å‚æ•°è¡¨ç¤ºå°è¡¨çš„æ€»å¤§å°ï¼Œé»˜è®¤å€¼ä¸º 25000000 å­—èŠ‚ï¼Œå³ 25Mã€‚ Hive0.7 ä¹‹å‰ï¼Œéœ€è¦ä½¿ç”¨ hint æç¤º /*+ mapjoin(table) */ æ‰ä¼šæ‰§è¡Œ MapJoin,å¦åˆ™æ‰§è¡Œ Common Joinï¼Œä½†åœ¨ 0.7 ç‰ˆæœ¬ä¹‹åï¼Œé»˜è®¤è‡ªåŠ¨ä¼šè½¬æ¢ Map Joinï¼Œç”±å‚æ•° hive.auto.convert.join æ¥æ§åˆ¶ï¼Œé»˜è®¤ä¸ºtrueã€‚ å‡è®¾ a è¡¨ä¸ºä¸€å¼ å¤§è¡¨ï¼Œb ä¸ºå°è¡¨ï¼Œå¹¶ä¸” hive.auto.convert.join=trueï¼Œé‚£ä¹ˆ Hive åœ¨æ‰§è¡Œæ—¶å€™ä¼šè‡ªåŠ¨è½¬åŒ–ä¸º MapJoinã€‚ MapJoin ç®€å•è¯´å°±æ˜¯ åœ¨ Map é˜¶æ®µå°†å°è¡¨æ•°æ®ä» HDFS ä¸Šè¯»å–åˆ°å†…å­˜ä¸­çš„å“ˆå¸Œè¡¨ä¸­ï¼Œè¯»å®Œåå°†å†…å­˜ä¸­çš„å“ˆå¸Œè¡¨åºåˆ—åŒ–ä¸ºå“ˆå¸Œè¡¨æ–‡ä»¶ åœ¨ä¸‹ä¸€é˜¶æ®µï¼Œå½“ MapReduce ä»»åŠ¡å¯åŠ¨æ—¶ï¼Œä¼šå°†è¿™ä¸ªå“ˆå¸Œè¡¨æ–‡ä»¶ä¸Šä¼ åˆ° Hadoop åˆ†å¸ƒå¼ç¼“å­˜ä¸­ï¼Œè¯¥ç¼“å­˜ä¼šå°†è¿™äº›æ–‡ä»¶å‘é€åˆ°æ¯ä¸ª Mapper çš„æœ¬åœ°ç£ç›˜ä¸Šã€‚ å› æ­¤ï¼Œæ‰€æœ‰ Mapper éƒ½å¯ä»¥å°†æ­¤æŒä¹…åŒ–çš„å“ˆå¸Œè¡¨æ–‡ä»¶åŠ è½½å›å†…å­˜ï¼Œå¹¶åƒä¹‹å‰ä¸€æ ·è¿›è¡Œ Joinã€‚ é¡ºåºæ‰«æå¤§è¡¨å®Œæˆ Joinã€‚å‡å°‘æ˜‚è´µçš„ shuffle æ“ä½œåŠ reduce æ“ä½œ MapJoinåˆ†ä¸ºä¸¤ä¸ªé˜¶æ®µï¼š é€šè¿‡ MapReduce Local Taskï¼Œå°†å°è¡¨è¯»å…¥å†…å­˜ï¼Œç”Ÿæˆ HashTableFiles ä¸Šä¼ è‡³ Distributed Cache ä¸­ï¼Œè¿™é‡Œä¼š HashTableFiles è¿›è¡Œå‹ç¼©ã€‚ MapReduce Job åœ¨ Map é˜¶æ®µï¼Œæ¯ä¸ª Mapper ä» Distributed Cache è¯»å– HashTableFiles åˆ°å†…å­˜ä¸­ï¼Œé¡ºåºæ‰«æå¤§è¡¨ï¼Œåœ¨ Map é˜¶æ®µç›´æ¥è¿›è¡Œ Joinï¼Œå°†æ•°æ®ä¼ é€’ç»™ä¸‹ä¸€ä¸ª MapReduce ä»»åŠ¡ mapjoin åœ¨ MapReduce ä»»åŠ¡ä¸­ï¼Œç¬¬ä¸€æ­¥å°±æ˜¯åˆ›å»ºä¸€ä¸ª MapReduce æœ¬åœ°ä»»åŠ¡ï¼Œç„¶åè¯¥ map / reduce ä»»åŠ¡ä» HDFS è¯»å–å°è¡¨çš„æ•°æ®ï¼Œç„¶åæŠŠæ•°æ®ä¿å­˜åˆ°å†…å­˜ä¸­çš„å“ˆå¸Œè¡¨ï¼Œç„¶åå†å­˜å‚¨åˆ°ä¸€ä¸ªå“ˆå¸Œè¡¨æ–‡ä»¶ã€‚æ¥ç€ï¼Œå½“ MapReduce join ä»»åŠ¡å¯åŠ¨çš„æ—¶å€™ï¼Œå®ƒä¼šæŠŠå“ˆå¸Œè¡¨æ–‡ä»¶ç§»åˆ° Hadoop åˆ†å¸ƒå¼å†…å­˜ä¸­ï¼Œå¹¶æŠŠå“ˆå¸Œè¡¨æ–‡ä»¶å­˜å‚¨åˆ°æ¯ä¸ª mapper çš„æœ¬åœ°ç£ç›˜ä¸Šã€‚æ‰€æœ‰çš„ mapper éƒ½èƒ½æŠŠè¿™ä¸ªå“ˆå¸Œè¡¨æ–‡ä»¶åŠ è½½åˆ°å†…å­˜ï¼Œç„¶ååœ¨ map é˜¶æ®µåš join æ“ä½œã€‚1 Hive map JoinÂ â†©ï¸ ","date":"2022-12-01","objectID":"/mapjoin/:0:0","tags":["æ•°ä»“"],"title":"å¤§è¡¨joinå°è¡¨ï¼Œç‹¬é’Ÿçˆ±mapjoin","uri":"/mapjoin/"},{"categories":["å­¦ä¹ "],"content":"order by,sort by,distribute by,cluster byçš„åŒºåˆ«","date":"2022-12-01","objectID":"/orderby/","tags":["æ•°ä»“"],"title":"order by,sort by,distribute by,cluster byçš„åŒºåˆ«","uri":"/orderby/"},{"categories":["å­¦ä¹ "],"content":"æ·±å…¥æ¢ç©¶ order by,sort by,distribute by,cluster by çš„åŒºåˆ«ï¼Œå¹¶ç”¨æ•°æ®å¾æœä½ ã€‚ ","date":"2022-12-01","objectID":"/orderby/:0:0","tags":["æ•°ä»“"],"title":"order by,sort by,distribute by,cluster byçš„åŒºåˆ«","uri":"/orderby/"},{"categories":["å­¦ä¹ "],"content":"å‡†å¤‡å·¥ä½œ ","date":"2022-12-01","objectID":"/orderby/:1:0","tags":["æ•°ä»“"],"title":"order by,sort by,distribute by,cluster byçš„åŒºåˆ«","uri":"/orderby/"},{"categories":["å­¦ä¹ "],"content":"å»ºè¡¨ drop table if exists wedw_dw.province_city_info; create table wedw_dw.province_city_info( proinve_name string COMMENT 'çœä»½å' ,city_name string COMMENT 'å¸‚å' ,pc_cnt bigint COMMENT 'äººå£æ•°(å•ä½ï¼šä¸‡)' ,in_come decimal(16,2) COMMENT 'æ”¶å…¥(å•ä½ï¼šäº¿)' ) row format delimited fields terminated by ','; ","date":"2022-12-01","objectID":"/orderby/:1:1","tags":["æ•°ä»“"],"title":"order by,sort by,distribute by,cluster byçš„åŒºåˆ«","uri":"/orderby/"},{"categories":["å­¦ä¹ "],"content":"æ•°æ®å‡†å¤‡ æ•°æ®å‡†å¤‡ ","date":"2022-12-01","objectID":"/orderby/:1:2","tags":["æ•°ä»“"],"title":"order by,sort by,distribute by,cluster byçš„åŒºåˆ«","uri":"/orderby/"},{"categories":["å­¦ä¹ "],"content":"order by å‡åº: asc é™åº: desc é»˜è®¤å‡åº order by ä¼šå¯¹è¾“å…¥åšå…¨å±€æ’åºï¼Œå› æ­¤åªæœ‰ä¸€ä¸ª reducer(å¤šä¸ª reducer æ— æ³•ä¿è¯å…¨å±€æœ‰åº)ï¼Œç„¶è€Œåªæœ‰ä¸€ä¸ª Reducer ä¼šå¯¼è‡´å½“è¾“å…¥è§„æ¨¡è¾ƒå¤§æ—¶ï¼Œæ¶ˆè€—è¾ƒé•¿çš„è®¡ç®—æ—¶é—´ã€‚ select * from wedw_dw.province_city_info order by in_come desc; order by ","date":"2022-12-01","objectID":"/orderby/:2:0","tags":["æ•°ä»“"],"title":"order by,sort by,distribute by,cluster byçš„åŒºåˆ«","uri":"/orderby/"},{"categories":["å­¦ä¹ "],"content":"sort by sort by ä¸æ˜¯å…¨å±€æ’åºï¼Œå…¶åœ¨æ•°æ®è¿›å…¥ reducer å‰å®Œæˆæ’åºï¼Œå› æ­¤ï¼Œå¦‚æœç”¨ sort by è¿›è¡Œæ’åºå¹¶ä¸”è®¾ç½® mapped.reduce.tasks \u003e 1ï¼Œåˆ™ sort by åªä¼šä¿è¯æ¯ä¸ª reducerçš„è¾“å‡ºæœ‰åºï¼Œå¹¶ä¸ä¿è¯å…¨å±€æœ‰åºã€‚(å…¨æ’åºå®ç°:å…ˆç”¨ sortby ä¿è¯æ¯ä¸ª reducer è¾“å‡ºæœ‰åºï¼Œç„¶ååœ¨è¿›è¡Œ order by å½’å¹¶ä¸‹å‰é¢æ‰€æœ‰çš„ reducer è¾“å‡ºè¿›è¡Œå•ä¸ª reduceræ’åºï¼Œå®ç°å…¨å±€æœ‰åºã€‚) åœ¨ sort by ä¹‹å‰æˆ‘ä»¬è¿˜æœ‰é…ç½®å±æ€§: //é…ç½®ruduceæ•°é‡ set mapreduce.job.reduces=4; select * from wedw_dw.province_city_info sort by in_come desc; sort by ","date":"2022-12-01","objectID":"/orderby/:3:0","tags":["æ•°ä»“"],"title":"order by,sort by,distribute by,cluster byçš„åŒºåˆ«","uri":"/orderby/"},{"categories":["å­¦ä¹ "],"content":"distribute by distribute by æ˜¯æ§åˆ¶åœ¨ map ç«¯å¦‚ä½•æ‹†åˆ†æ•°æ®ç»™ reduce ç«¯çš„ã€‚hive ä¼šæ ¹æ® distribute by åé¢åˆ—ï¼Œå¯¹åº” reduce çš„ä¸ªæ•°è¿›è¡Œåˆ†å‘ï¼Œé»˜è®¤æ˜¯é‡‡ç”¨ hash ç®—æ³•ã€‚ sort by ä¸ºæ¯ä¸ª reduce äº§ç”Ÿä¸€ä¸ªæ’åºæ–‡ä»¶ã€‚åœ¨æœ‰äº›æƒ…å†µä¸‹ï¼Œä½ éœ€è¦æ§åˆ¶æŸä¸ªç‰¹å®šè¡Œåº”è¯¥åˆ°å“ªä¸ª reducerï¼Œè¿™é€šå¸¸æ˜¯ä¸ºäº†è¿›è¡Œåç»­çš„èšé›†æ“ä½œã€‚ distribute by åˆšå¥½å¯ä»¥åšè¿™ä»¶äº‹ã€‚å› æ­¤ï¼Œdistribute by ç»å¸¸å’Œ sort by é…åˆä½¿ç”¨ã€‚ distribute by çš„åˆ†åŒºè§„åˆ™æ˜¯æ ¹æ®åˆ†åŒºå­—æ®µçš„ hash ç ä¸ reduce çš„ä¸ªæ•°è¿›è¡Œæ¨¡é™¤åï¼Œä½™æ•°ç›¸åŒçš„åˆ†åˆ°ä¸€ä¸ªåŒºã€‚1 Hive è¦æ±‚ DISTRIBUTE BY è¯­å¥è¦å†™åœ¨ SORT BY è¯­å¥ä¹‹å‰ã€‚ select * from wedw_dw.province_city_info distribute by proinve_name; distribute by distribute by ç»å¸¸å’Œ sort by é…åˆä½¿ç”¨ã€‚ distribute by å’Œ sort by é…åˆ ","date":"2022-12-01","objectID":"/orderby/:4:0","tags":["æ•°ä»“"],"title":"order by,sort by,distribute by,cluster byçš„åŒºåˆ«","uri":"/orderby/"},{"categories":["å­¦ä¹ "],"content":"cluster by å½“ distribute by å’Œ sort by æ‰€æŒ‡å®šçš„å­—æ®µç›¸åŒæ—¶ï¼Œå³å¯ä»¥ä½¿ç”¨ cluster byã€‚ select * from wedw_dw.province_city_info distribute by in_come sort by in_come asc; æ‰€æŒ‡å®šçš„å­—æ®µç›¸åŒ æ³¨æ„ cluster by æŒ‡å®šçš„åˆ—åªèƒ½æ˜¯å‡åºï¼Œä¸èƒ½æŒ‡å®š asc å’Œ descã€‚ select * from wedw_dw.province_city_info cluster by in_come; cluster by order by, sort by, distribute by, cluster by åŒºåˆ«Â â†©ï¸ ","date":"2022-12-01","objectID":"/orderby/:5:0","tags":["æ•°ä»“"],"title":"order by,sort by,distribute by,cluster byçš„åŒºåˆ«","uri":"/orderby/"},{"categories":["åˆ·é¢˜"],"content":"dubè€å¸ˆç»™æ»´é¢˜ç›®å‡†å¤‡","date":"2022-11-30","objectID":"/dub-exercise/","tags":["é¢è¯•"],"title":"dubè€å¸ˆç»™æ»´é¢˜ç›®å‡†å¤‡","uri":"/dub-exercise/"},{"categories":["åˆ·é¢˜"],"content":"å¤´æ¡å¤§ä½¬ dubhe è€å¸ˆç»™çš„é¢˜ç›®å‡†å¤‡ï¼Œå¥½å¥½åˆ·ä¸€ä¸‹ã€‚ ","date":"2022-11-30","objectID":"/dub-exercise/:0:0","tags":["é¢è¯•"],"title":"dubè€å¸ˆç»™æ»´é¢˜ç›®å‡†å¤‡","uri":"/dub-exercise/"},{"categories":["åˆ·é¢˜"],"content":"SQL ç±»å‹ ","date":"2022-11-30","objectID":"/dub-exercise/:1:0","tags":["é¢è¯•"],"title":"dubè€å¸ˆç»™æ»´é¢˜ç›®å‡†å¤‡","uri":"/dub-exercise/"},{"categories":["åˆ·é¢˜"],"content":"æˆç»©æ’å å­¦ç”Ÿæˆç»©è¡¨ student,course,scoreï¼Œè®°å½•æ¯ä¸ªå­¦ç”Ÿæ¯é—¨è¯¾ç¨‹ï¼ˆå…±è¯­æ–‡ã€æ•°å­¦ã€è‹±è¯­ 3 é—¨è¯¾ï¼‰çš„æˆç»©ï¼Œè¯·ç”¨ SQL æ‰¾å‡ºæ¯é—¨è¯¾ç¨‹æˆç»©æ’åå‰ 5 çš„å­¦ç”Ÿã€‚ select a.course, a.student from ( select scoure, student, row_number() over (partition by course order by socre desc) rn from tab1 ) as a where a.rn \u003c= 5; ","date":"2022-11-30","objectID":"/dub-exercise/:1:1","tags":["é¢è¯•"],"title":"dubè€å¸ˆç»™æ»´é¢˜ç›®å‡†å¤‡","uri":"/dub-exercise/"},{"categories":["åˆ·é¢˜"],"content":"å¹³å‡åˆ†å’Œæ€»åˆ†æœ€é«˜ table1: student_id,class table2: student_id,course,score æ±‚å„ä¸ªç­çº§ï¼Œæ¯ä¸€é—¨è¯¾ç¨‹çš„å¹³å‡åˆ† æ±‚å„ä¸ªç­çº§ï¼Œæ€»åˆ†æœ€é«˜çš„å­¦ç”Ÿ select a.class, b.course, avg(b.score) as score_avg from table1 as a left join table2 as b on a.student_id = b.student_id group by 1,2 select a.class, a.student_id, a.score_sum from ( select a.class, a.student_id, a.score_sum, row_number() over (partition by a.class order by a.score_sum desc) as rn from ( select a.class, a.student_id, sum(b.score) as score_sum from table1 as a left join table2 as b on a.student_id = b.student_id group by 1,2 ) as a ) as a where a.rn = 1 ","date":"2022-11-30","objectID":"/dub-exercise/:1:2","tags":["é¢è¯•"],"title":"dubè€å¸ˆç»™æ»´é¢˜ç›®å‡†å¤‡","uri":"/dub-exercise/"},{"categories":["åˆ·é¢˜"],"content":"ip è®¿é—®æ¬¡æ•°å‰ 5 ç»™å®š hive è¡¨ t1ï¼ŒåŒ…å«ä¸‰åˆ—ï¼Œuser_idã€ipã€timeï¼šè¡¨ç¤º user_id åœ¨æ—¶é—´ time è®¿é—®è¿‡ä¸€æ¬¡ ipã€‚è¯·åˆ©ç”¨ hive-sql è®¡ç®—æ¯ä¸ª ip è®¿é—®æ¬¡æ•°æ’åå‰ 5 çš„ user_idã€‚ select a.ip, a.user_id, a.cnt from ( select a.ip, a.user_id, a.cnt, row_number() over (partition by a.ip order by a.cnt desc) as rn from ( select ip, user_id, count(time) as cnt from t1 group by 1,2 ) as a ) as a where a.rn \u003c= 5 ","date":"2022-11-30","objectID":"/dub-exercise/:1:3","tags":["é¢è¯•"],"title":"dubè€å¸ˆç»™æ»´é¢˜ç›®å‡†å¤‡","uri":"/dub-exercise/"},{"categories":["åˆ·é¢˜"],"content":"æ•°æ®æ¸…æ´— å®¢æˆ·ç«¯æ¯éš”å‡ åˆ†é’Ÿéƒ½ä¼šä¸ŠæŠ¥ä¸€æ¡è®°å½•ï¼Œå½¢å¼å¦‚ uidã€timeï¼Œæˆ‘ä»¬åšæ•°æ®æ¸…æ´—çš„æ—¶å€™è¦æ±‚ï¼šå¦‚æœ 10 åˆ†é’Ÿå†…ä¸ŠæŠ¥å¤šæ¡çš„è¯ï¼Œå°±åªä¿ç•™æœ€æ—©çš„ä¸€æ¡ã€‚è¯·é—®æ€ä¹ˆç”¨ SQL å®ç°ã€‚ // å°†ä¸€ä¸ªæ—¶é—´ç»´è¡¨(åˆ†é’Ÿç»´åº¦å­˜å‚¨æŒ‰ç…§ 10 åˆ†é’Ÿè¿›è¡Œ N ç­‰åˆ†) with time_tmp as ( select time_format, // æ ¼å¼ 12:10 ntile(24*60/10) over (order by time) as time_rn from dim_time ) select a.uid, a.time from ( select a.uid, a.time, row_number() over (partition by b.time_rn order by a.time) rn from table1 as a left join time_tmp as b on concat(hour(a.time), ':', minute(a.time)) = b.time_format ) as a where a.rn = 1 ","date":"2022-11-30","objectID":"/dub-exercise/:1:4","tags":["é¢è¯•"],"title":"dubè€å¸ˆç»™æ»´é¢˜ç›®å‡†å¤‡","uri":"/dub-exercise/"},{"categories":["åˆ·é¢˜"],"content":"å……å€¼é¢æœ€å¤§çš„è´¦å· å‡è®¾æœ‰ä¸€ä¸ªç”¨æˆ·å……å€¼æ—¥å¿—è¡¨ Aï¼Œå­—æ®µå¦‚ä¸‹ å­—æ®µ ç±»å‹ å«ä¹‰ dist_id int åŒºç»„id account string è´¦å· money int å……å€¼é‡‘é¢ create_time string è®¢å•æ—¶é—´ æ±‚è§£ï¼šç»Ÿè®¡æŸä¸€å¤©å„åŒºç»„ä¸‹å……å€¼é¢æœ€å¤§çš„è´¦å·ä»¥åŠé‡‘é¢ã€‚ select a.dist_id, a.account, a.money from ( select a.dist_id, a.account, a.money, row_number() over (partition by a.dist_id order by a.money desc) rn from tab1 as a where date(a.create_time) = '2022-10-01' ) as a where a.rn = 1 ","date":"2022-11-30","objectID":"/dub-exercise/:1:5","tags":["é¢è¯•"],"title":"dubè€å¸ˆç»™æ»´é¢˜ç›®å‡†å¤‡","uri":"/dub-exercise/"},{"categories":["åˆ·é¢˜"],"content":"è§‚çœ‹è§†é¢‘ æ ¹æ®è¦æ±‚å†™å‡ºå¯¹åº”çš„ sql è¯­å¥ è¡¨Aï¼šç”¨æˆ·æµè§ˆè§†é¢‘æ—¥å¿— user_behavior:date,user_id,video_id,start_time,end_time è¡¨Bï¼šè§†é¢‘ä¿¡æ¯ video_info:video_id,video_duration è¡¨Cï¼šç”¨æˆ·ä¿¡æ¯ user_info:user_id,gender é—®é¢˜ï¼š æŸä¸€å¤©ï¼ˆå¦‚20200310ï¼‰ï¼Œè§‚çœ‹ä¸åŒè§†é¢‘ä¸ªæ•°æœ€å¤šçš„å‰ 5 å user_id è§‚çœ‹è¶…è¿‡ 50 ä¸ªä¸ç”¨è§†é¢‘çš„å¥³æ€§ç”¨æˆ·ä¸­ï¼Œå®Œæ•´è§‚çœ‹ç‡æœ€é«˜çš„ 10 ä¸ª user_id select a.user_id, count(distinct a.video_id) as cnt from tab_a as a where a.date = '20200310' order by 2 desc limit 5 select a.user_id, a.video_finish_cnt / a.video_cnt as finish_rate from ( select a.user_id, count(distinct a.video_id) over (partition by a.user_id) as video_cnt, count(distinct case when unix_timestamp(a.end_time) - unix_timestamp(a.start_time) \u003e= b.video_duration then a.video_id end) over (partition by a.user_id) as video_finish_cnt, row_number() over (partition by a.user_id order by a.start_time) rn from tab_a as a left join tab_b as b on a.video_id = b.video_id left join tab_c as c on a.user_id = c.user_id where a.date = '20200310' and c.gender = 'å¥³' ) as a where a.video_cnt \u003e= 50 and a.rn = 1 order by 2 desc limit 10 ","date":"2022-11-30","objectID":"/dub-exercise/:1:6","tags":["é¢è¯•"],"title":"dubè€å¸ˆç»™æ»´é¢˜ç›®å‡†å¤‡","uri":"/dub-exercise/"},{"categories":["åˆ·é¢˜"],"content":"é¡µé¢ session æ—¶é•¿è®¡ç®— ç”¨æˆ·åœ¨æµè§ˆé¡µé¢æ—¶ï¼Œå‰ç«¯ä»¥ 1 æ¬¡/s çš„é¢‘ç‡ä¸ŠæŠ¥åç«¯ï¼Œå‡å¦‚è¿ç»­ 30s åç«¯æœªæ”¶åˆ°ä¸ŠæŠ¥ï¼Œå¯ä»¥è®¤ä¸ºä¸€æ¬¡è®¿é—® session å·²ç»ç»“æŸï¼Œä½¿ç”¨ hivesql/sparksql æ±‚æ¯æ¬¡ session çš„ä¿¡æ¯ï¼ˆåªæœ‰ä¸€æ¡è®°å½•æ—¶ä»»åŠ¡æ˜¯ 1sï¼‰ã€‚ ç¤ºä¾‹ï¼š è¡¨åä¸ºï¼špage_upload_infoï¼Œå•æ¬¡ä¸ŠæŠ¥æ•°æ®ç»“æ„å¦‚ä¸‹ï¼š user_id-\u003eç”¨æˆ·idï¼Œcreate_ts-\u003eä¸ŠæŠ¥æ—¶é—´æˆ³ï¼ˆå•ä½ï¼šç§’ï¼‰ï¼Œå‡å¦‚æœ‰ä¸‹æ•°æ®ï¼ˆæ•°æ®æœªæ’åºï¼‰ï¼š user_id-\u003e1,create_ts-\u003e10000 user_id-\u003e1,create_ts-\u003e10010 user_id-\u003e1,create_ts-\u003e10003 user_id-\u003e1,create_ts-\u003e10070 user_id-\u003e2,create_ts-\u003e10000 user_id-\u003e2,create_ts-\u003e10003 è§£ç­”ï¼šåº”è¿”å› 3 æ¡ç»“æœï¼Œåˆ†åˆ«æ˜¯ï¼š user_id-\u003e1,session-\u003e10s,start_ts-\u003e10000,end_ts-\u003e10010 user_id-\u003e1,session-\u003e1s,start_ts-\u003e10070,end_ts-\u003e10070 user_id-\u003e2,session-\u003e3s,start_ts-\u003e10000,end_ts-\u003e10003 select a.user_id, case when a.end_ts = a.create_ts then 1 else a.end_ts - a.create_ts end as session, a.start_ts, a.end_ts from ( select a.user_id, a.f_group, min(a.create_ts) as start_ts, max(a.create_ts) as end_ts from ( select a.user_id, a.create_ts, sum(f_flag) over (partition a.user_id order by a.create_ts desc) f_group from ( select a.user_id, a.create_ts, case when a.diff_create_ts \u003e= 30 or a.diff_create_ts is null then 1 else 0 end as f_flag from ( select a.user_id, a.create_ts, lead(a.create_ts, 1, null) over (partition by a.user_id order by a.create_ts) - a.create_ts as diff_create_ts from page_upload_info as a ) a ) a ) a group by 1,2 ) a ","date":"2022-11-30","objectID":"/dub-exercise/:1:7","tags":["é¢è¯•"],"title":"dubè€å¸ˆç»™æ»´é¢˜ç›®å‡†å¤‡","uri":"/dub-exercise/"},{"categories":["åˆ·é¢˜"],"content":"ç•™å­˜ï¼Œå’Œè¿ç»­æ´»è·ƒ 1ã€ç”¨æˆ·æ´»è·ƒæ¨¡å‹è¡¨ï¼šuser_daily ä»¥ imp_dateã€user_id ä¸ºä¸»é”®ï¼Œä¸€ä¸ªç”¨æˆ· 1 å¤©åªå‡ºç°ä¸€æ¬¡ï¼Œå‡ºç°å³è¡¨ç¤ºå½“æ—¥ç™»é™†å­—æ®µï¼š å­—æ®µï¼š imp_date æ—¶é—´ï¼Œuser_id ç”¨æˆ·idï¼Œis_new æ˜¯å¦æ–°ç”¨æˆ·ï¼Œ0-è€ç”¨æˆ·ï¼Œ1-æ–°ç”¨æˆ· 2ã€çº¢åŒ…é¢†å–æ—¥å¿—ï¼šmoney_flow å­—æ®µï¼š imp_date æ—¶é—´ï¼Œreport_time çº¢åŒ…é¢†å–æ—¶é—´æˆ³ï¼Œç”¨æˆ·idï¼Œadd_money é¢†å–é‡‘é¢ é¢˜ç›®1ï¼šæœ€è¿‘ 1 ä¸ªæœˆæ¯æ—¥æœªé¢†çº¢åŒ…ç”¨æˆ·çš„æ¬¡æ—¥ç•™å­˜ç‡å’Œ 7 æ—¥ç•™å­˜ é¢˜ç›®2ï¼šæœ€è¿‘ 1 ä¸ªæœˆï¼Œæ¯æ—¥ DAU ä¸­ï¼Œ3 å¤©è¿ç»­æ´»è·ƒç”¨æˆ·çš„å æ¯” select a.imp_date, count(case when b.user_id is not null then a.user_id end)/count(a.user_id) as f_remain_1d_rate, count(case when c.user_id is not null then a.user_id end)/count(a.user_id) as f_remain_7d_rate from ( select a.imp_date, a.user_id from user_daily as a left join money_flow as b on a.imp_date = b.imp_date and a.user_id = b.user_id where date_diff(current_date, a.imp_date) \u003c= 30 and date_diff(current_date, b.imp_date) \u003c= 30 and b.user_id is null ) a left join user_daily b on date_diff(b.imp_date, a.imp_date) = 1 and a.user_id = b.user_id left join user_daily c on date_diff(c.imp_date, a.imp_date) = 7 and a.user_id = c.user_id group by 1 select a.imp_date, count(case when b.user_id is not null and c.user_id is not null then a.user_id end)/count(a.user_id) as f_3d_continue_rate from user_daily as a left join user_daily as b on date_diff(a.imp_date, b.imp_date) = 1 and a.user_id = b.user_id left join user_daily as c on date_diff(a.imp_date, c.imp_date) = 2 and a.user_id = c.user_id where date_diff(current_date, a.imp_date) \u003c= 30 group by 1 ","date":"2022-11-30","objectID":"/dub-exercise/:1:8","tags":["é¢è¯•"],"title":"dubè€å¸ˆç»™æ»´é¢˜ç›®å‡†å¤‡","uri":"/dub-exercise/"},{"categories":["åˆ·é¢˜"],"content":"ç®—æ³•é¢˜ ","date":"2022-11-30","objectID":"/dub-exercise/:2:0","tags":["é¢è¯•"],"title":"dubè€å¸ˆç»™æ»´é¢˜ç›®å‡†å¤‡","uri":"/dub-exercise/"},{"categories":["åˆ·é¢˜"],"content":"xçš„å¹³æ–¹æ ¹ ğŸ”— xçš„å¹³æ–¹æ ¹ ","date":"2022-11-30","objectID":"/dub-exercise/:2:1","tags":["é¢è¯•"],"title":"dubè€å¸ˆç»™æ»´é¢˜ç›®å‡†å¤‡","uri":"/dub-exercise/"},{"categories":["åˆ·é¢˜"],"content":"å­—ç¬¦ä¸²ç›¸åŠ  ğŸ”— å­—ç¬¦ä¸²ç›¸åŠ  ","date":"2022-11-30","objectID":"/dub-exercise/:2:2","tags":["é¢è¯•"],"title":"dubè€å¸ˆç»™æ»´é¢˜ç›®å‡†å¤‡","uri":"/dub-exercise/"},{"categories":["åˆ·é¢˜"],"content":"å¹³æ–¹æ•°ä¹‹å’Œ ğŸ”— å­—ç¬¦ä¸²ç›¸åŠ  ","date":"2022-11-30","objectID":"/dub-exercise/:2:3","tags":["é¢è¯•"],"title":"dubè€å¸ˆç»™æ»´é¢˜ç›®å‡†å¤‡","uri":"/dub-exercise/"},{"categories":["åˆ·é¢˜"],"content":"æœ€é•¿å›æ–‡å­ä¸² ğŸ”— æœ€é•¿å›æ–‡å­ä¸² ","date":"2022-11-30","objectID":"/dub-exercise/:2:4","tags":["é¢è¯•"],"title":"dubè€å¸ˆç»™æ»´é¢˜ç›®å‡†å¤‡","uri":"/dub-exercise/"},{"categories":["åˆ·é¢˜"],"content":"æŸ¥è¯¢ä¸¤ä¸ªå­—ç¬¦ä¸²çš„æœ€é•¿å…¬å…±å­ä¸² ğŸ”— æŸ¥è¯¢ä¸¤ä¸ªå­—ç¬¦ä¸²çš„æœ€é•¿å…¬å…±å­ä¸² ","date":"2022-11-30","objectID":"/dub-exercise/:2:5","tags":["é¢è¯•"],"title":"dubè€å¸ˆç»™æ»´é¢˜ç›®å‡†å¤‡","uri":"/dub-exercise/"},{"categories":["åˆ·é¢˜"],"content":"å•è¯æ‹†åˆ† ğŸ”— å•è¯æ‹†åˆ† ","date":"2022-11-30","objectID":"/dub-exercise/:2:6","tags":["é¢è¯•"],"title":"dubè€å¸ˆç»™æ»´é¢˜ç›®å‡†å¤‡","uri":"/dub-exercise/"},{"categories":["åˆ·é¢˜"],"content":"ç¼–ç¨‹ç±» ","date":"2022-11-30","objectID":"/dub-exercise/:3:0","tags":["é¢è¯•"],"title":"dubè€å¸ˆç»™æ»´é¢˜ç›®å‡†å¤‡","uri":"/dub-exercise/"},{"categories":["åˆ·é¢˜"],"content":"ç»Ÿè®¡kv æœ‰ä¸€ä»½æ•°æ®æœ‰ n è¡Œï¼Œæ¯ä¸€è¡Œæ˜¯ä¸€ä¸ªç”±é€—å·ã€å†’å·é—´éš”çš„å­—ç¬¦ä¸²ï¼ˆä¾‹å¦‚ â€œa:10,b,20,c:30â€ï¼‰ï¼Œé€—å·æ‹†åˆ†åæ¯ä¸ªéƒ½æ˜¯å­—ç¬¦ä¸²ç±»å‹çš„ â€œkey:valueâ€ã€‚ç°éœ€è¦ç»Ÿè®¡æ¯ä¸ª key çš„ value æ±‚å’Œï¼Œå¯å°è¯•ç”¨ python æˆ– hive/sql æˆ– spark å®ç°ã€‚ (1) è‹¥ python å®ç°ï¼Œåˆ™è¾“å…¥ä¸ºä¸€ä¸ªlistï¼šlis1 = ['a:10,b:20,c:30', 'a:100,dog:200', 'hi:40,b:10', 'dog:20'] (2) è‹¥ hive/sql å®ç°ï¼Œåˆ™è¾“å…¥å¯è®¾ä¸ºä¸€ä¸ªè¡¨ Aï¼Œä¸”ä»…ä¸€åˆ—æ•°æ®ã€‚ info a:10,b:20,c:30 a:100,dog:200 hi:40,b:10 dog:20 â€¦â€¦ (3) è‹¥ saprk å®ç°ï¼Œåˆ™è¾“å…¥å¯è®¾ä¸ºä¸€ä¸ª rdd/dateframe æœ€ç»ˆæ±‚å¾—ï¼ša: 110, b: 30, c: 30, dog: 220, hi: 40ã€‚ ç­”ï¼š lis1 = ['a:10,b:20,c:30', 'a:100,dog:200', 'hi:40,b:10', 'dog:20'] ret_dict = {} for item in lis1: item_list = item.split(',') for i in item_list: k = i.split(':')[0] v = int(i.split(':')[1]) if k in ret_dict: ret_dict[k] += v else: ret_dict[k] = v print(ret_dict) select concat_ws(',', collect_list(concat(k,':',v))) as ret from ( select k, sum(v) as v from ( select split(value1, ':')[0] as k, cast(split(value1, ':')[1] as int) as v from tmp_2022120501 t lateral view explode(split(t.my_str, ',')) t1 as value1 ) as a group by 1 ) as a ","date":"2022-11-30","objectID":"/dub-exercise/:3:1","tags":["é¢è¯•"],"title":"dubè€å¸ˆç»™æ»´é¢˜ç›®å‡†å¤‡","uri":"/dub-exercise/"},{"categories":["å­¦ä¹ "],"content":"ã€æ•°ä»“ã€‘äº‹å®è¡¨è®¾è®¡","date":"2022-11-30","objectID":"/fact-tab/","tags":["æ•°ä»“"],"title":"ã€æ•°ä»“ã€‘äº‹å®è¡¨è®¾è®¡","uri":"/fact-tab/"},{"categories":["å­¦ä¹ "],"content":"ä»Šå¤©å­¦ä¹ ç¬¬ 11 ç« äº‹å®è¡¨è®¾è®¡ã€‚ ","date":"2022-11-30","objectID":"/fact-tab/:0:0","tags":["æ•°ä»“"],"title":"ã€æ•°ä»“ã€‘äº‹å®è¡¨è®¾è®¡","uri":"/fact-tab/"},{"categories":["å­¦ä¹ "],"content":"äº‹å®è¡¨åŸºç¡€ ","date":"2022-11-30","objectID":"/fact-tab/:1:0","tags":["æ•°ä»“"],"title":"ã€æ•°ä»“ã€‘äº‹å®è¡¨è®¾è®¡","uri":"/fact-tab/"},{"categories":["å­¦ä¹ "],"content":"äº‹å®è¡¨ç‰¹æ€§ ç²’åº¦ï¼šä¸€æ¡è®°å½•è¡¨è¾¾çš„ä¸šåŠ¡ç»†èŠ‚ç§°ä¸ºç²’åº¦ã€‚ ç»´åº¦å±æ€§ç»„åˆæ‰€è¡¨ç¤ºçš„ç»†èŠ‚ç¨‹åº¦ï¼› æ‰€è¡¨ç¤ºçš„å…·ä½“ä¸šåŠ¡å«ä¹‰ã€‚ ä½œä¸ºåº¦é‡ä¸šåŠ¡è¿‡ç¨‹çš„äº‹å®ï¼Œä¸€èˆ¬ä¸ºæ•´å‹æˆ–æµ®ç‚¹å‹æ•°å€¼ï¼Œç±»å‹ï¼š å¯åŠ æ€§äº‹å®ï¼šå¯ä»¥åœ¨ä»»æ„ç»´åº¦æ±‡æ€»ï¼› åŠå¯åŠ æ€§äº‹å®ï¼šåªèƒ½æŒ‰ç…§ç‰¹å®šç»´åº¦æ±‡æ€»ï¼Œæ¯”å¦‚åº“å­˜ï¼Œå¯ä»¥æŒ‰åœ°ç‚¹ã€å•†å“æ±‡æ€»ï¼Œä¸èƒ½æŒ‰æ—¶é—´æ±‡æ€»ï¼Œæ²¡æ„ä¹‰ã€‚ ä¸å¯åŠ æ€§äº‹å®ï¼šæ¯”å¦‚æ¯”ç‡å‹ã€‚ ä¸ç»´åº¦è¡¨ç›¸æ¯”ï¼Œäº‹å®è¡¨ç»†é•¿ï¼Œè¡Œå¢åŠ å¿«ã€‚ ç»´åº¦å±æ€§ä¹Ÿå¯ä»¥å­˜å‚¨åˆ°äº‹å®è¡¨ä¸­ï¼Œç§°ä¸ºé€€åŒ–ç»´åº¦ï¼Œä¹Ÿå¯ä»¥ç”¨äºå¯¹äº‹å®è¡¨è¿‡æ»¤æŸ¥è¯¢ã€èšåˆã€‚ ç±»å‹ï¼š äº‹åŠ¡äº‹å®è¡¨ï¼šæè¿°ä¸šåŠ¡è¿‡ç¨‹ï¼Œä¿å­˜æœ€åŸå­çš„æ•°æ® å‘¨æœŸå¿«ç…§äº‹å®è¡¨ï¼šå…·æœ‰è§„å¾‹æ€§ã€å¯é¢„è§çš„æ—¶é—´é—´éš”è®°å½•äº‹å® ç´¯è®¡å¿«ç…§äº‹å®è¡¨ï¼šè¡¨è¿°è¿‡ç¨‹å¼€å§‹å’Œç»“æŸä¹‹é—´çš„å…³é”®æ­¥éª¤äº‹ä»¶ï¼Œè¦†ç›–æ•´ä¸ªç”Ÿå‘½å‘¨æœŸï¼Œå…·æœ‰å¤šä¸ªæ—¥æœŸå­—æ®µï¼Œéšç€è¿‡ç¨‹å˜åŒ–ä¿®æ”¹ã€‚ ","date":"2022-11-30","objectID":"/fact-tab/:1:1","tags":["æ•°ä»“"],"title":"ã€æ•°ä»“ã€‘äº‹å®è¡¨è®¾è®¡","uri":"/fact-tab/"},{"categories":["å­¦ä¹ "],"content":"äº‹å®è¡¨è®¾è®¡åŸåˆ™ å°½å¯èƒ½åŒ…å«æ‰€æœ‰ä¸ä¸šåŠ¡è¿‡ç¨‹ç›¸å…³çš„äº‹å® åªé€‰æ‹©ä¸ä¸šåŠ¡è¿‡ç¨‹ç›¸å…³çš„äº‹å®ï¼šä¾‹å¦‚ä¸‹å•è¿™ä¸ªä¸šåŠ¡è¿‡ç¨‹ï¼Œä¸åº”åŒ…å«æ”¯ä»˜é‡‘é¢ï¼ˆè¿™æ˜¯æ”¯ä»˜ä¸šåŠ¡è¿‡ç¨‹ï¼‰ã€‚ åˆ†è§£ä¸å¯åŠ æ€§äº‹å®ä¸ºå¯åŠ çš„ç»„ä»¶ã€‚ä¾‹å¦‚è®¢å•ä¼˜æƒ ç‡ï¼Œåˆ†è§£ä¸ºåŸä»·ã€ä¼˜æƒ é‡‘é¢ã€‚ åœ¨é€‰æ‹©ç»´åº¦å’Œäº‹å®ä¹‹å‰å¿…é¡»å…ˆå£°æ˜ç²’åº¦ï¼šç²’åº¦ç¡®å®šäº‹å®è¡¨ä¸­ä¸€è¡Œæ‰€è¡¨ç¤ºä¸šåŠ¡çš„ç»†èŠ‚å±‚æ¬¡ï¼Œç²’åº¦è¶Šç»†è¶Šå¥½ï¼Œä»åŸå­ç²’åº¦å¼€å§‹ã€‚ åœ¨åŒä¸€ä¸ªäº‹å®è¡¨ä¸­ä¸èƒ½æœ‰å¤šç§ä¸åŒç²’åº¦çš„äº‹å®ã€‚ äº‹å®çš„å•ä½è¦ä¿æŒä¸€è‡´ã€‚ å¯¹äº‹å®çš„ null å€¼è¦å¤„ç†ã€‚å»ºè®®ç”¨é›¶å€¼å¡«å……ã€‚ ä½¿ç”¨é€€åŒ–ç»´åº¦æé«˜äº‹å®è¡¨çš„æ˜“ç”¨æ€§ã€‚ ","date":"2022-11-30","objectID":"/fact-tab/:1:2","tags":["æ•°ä»“"],"title":"ã€æ•°ä»“ã€‘äº‹å®è¡¨è®¾è®¡","uri":"/fact-tab/"},{"categories":["å­¦ä¹ "],"content":"äº‹å®è¡¨è®¾è®¡æ–¹æ³• é€‰æ‹©ä¸šåŠ¡è¿‡ç¨‹åŠç¡®å®šäº‹å®è¡¨ç±»å‹ã€‚ä¸šåŠ¡è¿‡ç¨‹é€šå¸¸ä½¿ç”¨è¡Œä¸ºåŠ¨è¯è¡¨ç¤ºï¼Œä¾‹å¦‚åˆ›å»ºè®¢å•ã€ä»˜æ¬¾ã€å‘è´§ã€ç¡®è®¤æ”¶è´§ã€‚å¦‚æœé€‰æ‹©äº†æ‰€æœ‰å››ä¸ªä¸šåŠ¡è¿‡ç¨‹ï¼Œè¿˜éœ€è¦åŒ…å«å››ä¸ªä¸šåŠ¡è¿‡ç¨‹çš„ç´¯ç§¯å¿«ç…§äº‹å®è¡¨ã€‚ å£°æ˜ç²’åº¦ã€‚å°½é‡é€‰åŸå­ç²’åº¦ã€‚æ¯”å¦‚ç”¨æˆ·ä¸€ä¸ªè®¢å•ä¹°äº†å¤šç§å•†å“ï¼Œæ¯ä¸ªå­è®¢å•å¯¹åº”ä¸€ç§å•†å“ï¼Œé‚£ä¹ˆåº”è¯¥é€‰æ‹©å­è®¢å•ã€‚ ç¡®å®šç»´åº¦ã€‚æ¯”å¦‚äº‹å®è¡¨ç²’åº¦ä¸ºå­è®¢å•ï¼Œç»´åº¦æœ‰ä¹°å®¶ã€å–å®¶ã€å•†å“ã€æ”¶è´§äººã€ä¸šåŠ¡ç±»å‹ã€è®¢å•æ—¶é—´ç­‰ã€‚ ç¡®å®šäº‹å®ã€‚äº‹å®é€šè¿‡â€œè¿‡ç¨‹çš„åº¦é‡æ˜¯ä»€ä¹ˆâ€œæ¥ç¡®å®šã€‚æ¯”å¦‚è®¢å•ä»˜æ¬¾äº‹åŠ¡äº‹å®è¡¨ï¼Œäº‹å®æœ‰æ”¯ä»˜é‡‘é¢ã€é‚®è´¹ã€ä¼˜æƒ é‡‘é¢ç­‰ã€‚ å†—ä½™ç»´åº¦ã€‚ä¼ ç»Ÿçš„æ˜Ÿå½¢æ¨¡å‹åšæ³•æ˜¯ç»´åº¦å•ç‹¬å­˜æ”¾åœ¨ç»´åº¦è¡¨ï¼Œé€šè¿‡äº‹å®è¡¨çš„å¤–é”®è·å–ç»´åº¦ã€‚ä½†è€ƒè™‘åˆ°ä¸‹æ¸¸çš„ä½¿ç”¨æ•ˆç‡ï¼Œä¼šåœ¨äº‹å®è¡¨ä¸­å†—ä½™å¸¸ç”¨ç»´åº¦ï¼Œä¾¿äºè¿‡æ»¤æŸ¥è¯¢ã€æ§åˆ¶èšåˆå±‚æ¬¡ã€æ’åºç­‰ã€‚æ¯”å¦‚è®¢å•ä»˜æ¬¾äº‹åŠ¡äº‹å®è¡¨ä¸­å†—ä½™å¸¸ç”¨ç»´åº¦å­—æ®µä»¥åŠå•†å“ç±»ç›®ã€å–å®¶åº—é“ºç­‰ç»´åº¦ã€‚ ","date":"2022-11-30","objectID":"/fact-tab/:1:3","tags":["æ•°ä»“"],"title":"ã€æ•°ä»“ã€‘äº‹å®è¡¨è®¾è®¡","uri":"/fact-tab/"},{"categories":["å­¦ä¹ "],"content":"äº‹åŠ¡äº‹å®è¡¨ ","date":"2022-11-30","objectID":"/fact-tab/:2:0","tags":["æ•°ä»“"],"title":"ã€æ•°ä»“ã€‘äº‹å®è¡¨è®¾è®¡","uri":"/fact-tab/"},{"categories":["å­¦ä¹ "],"content":"è®¾è®¡è¿‡ç¨‹ å®šä¹‰ï¼šä»»ä½•äº‹ä»¶éƒ½å¯ä»¥è¢«ç†è§£ä¸ºäº‹åŠ¡ã€‚ä¾‹å¦‚åˆ›å»ºè®¢å•ã€ä»˜æ¬¾ç­‰ã€‚ è®¾è®¡è¿‡ç¨‹ï¼š é€‰æ‹©ä¸šåŠ¡è¿‡ç¨‹ ç¡®å®šç²’åº¦ ç¡®å®šç»´åº¦ ç¡®å®šäº‹å® å†—ä½™ç»´åº¦ è®¾è®¡è¿‡ç¨‹ ","date":"2022-11-30","objectID":"/fact-tab/:2:1","tags":["æ•°ä»“"],"title":"ã€æ•°ä»“ã€‘äº‹å®è¡¨è®¾è®¡","uri":"/fact-tab/"},{"categories":["å­¦ä¹ "],"content":"å•äº‹åŠ¡äº‹å®è¡¨ é’ˆå¯¹æ¯ä¸ªä¸šåŠ¡è¿‡ç¨‹è®¾è®¡ä¸€ä¸ªäº‹å®è¡¨ã€‚ ","date":"2022-11-30","objectID":"/fact-tab/:2:2","tags":["æ•°ä»“"],"title":"ã€æ•°ä»“ã€‘äº‹å®è¡¨è®¾è®¡","uri":"/fact-tab/"},{"categories":["å­¦ä¹ "],"content":"å¤šäº‹åŠ¡äº‹å®è¡¨ å°†ä¸åŒçš„äº‹å®æ”¾åˆ°åŒä¸€ä¸ªäº‹å®è¡¨ä¸­ã€‚ä¸¤ç§å®ç°æ–¹å¼ï¼š ä¸åŒä¸šåŠ¡è¿‡ç¨‹ä½¿ç”¨ä¸åŒäº‹å®å­—æ®µå­˜æ”¾ï¼› ä¸åŒä¸šåŠ¡è¿‡ç¨‹ä½¿ç”¨ç›¸åŒäº‹å®å­—æ®µå­˜æ”¾ï¼Œä½†å¢åŠ ä¸€ä¸ªä¸šåŠ¡è¿‡ç¨‹æ ‡ç­¾ã€‚ ","date":"2022-11-30","objectID":"/fact-tab/:2:3","tags":["æ•°ä»“"],"title":"ã€æ•°ä»“ã€‘äº‹å®è¡¨è®¾è®¡","uri":"/fact-tab/"},{"categories":["å­¦ä¹ "],"content":"ä¸¤ç§äº‹å®è¡¨å¯¹æ¯” ä¸šåŠ¡è¿‡ç¨‹ï¼šå•äº‹åŠ¡äº‹å®è¡¨ä¸€ä¸ªä¸šåŠ¡è¿‡ç¨‹ä¸€ä¸ªäº‹å®è¡¨ï¼Œå¤šäº‹åŠ¡äº‹å®è¡¨åŒä¸€ä¸ªäº‹å®è¡¨åæ˜ å¤šä¸ªä¸šåŠ¡è¿‡ç¨‹ã€‚ ç²’åº¦å’Œç»´åº¦ï¼šä¸åŒä¸šåŠ¡ç²’åº¦ç›¸åŒä¸”æœ‰ç›¸ä¼¼ç»´åº¦æ—¶æ‰èƒ½ä½¿ç”¨å¤šäº‹åŠ¡äº‹å®è¡¨ã€‚ äº‹å®ï¼šå•äº‹åŠ¡äº‹å®è¡¨å¤„ç†äº‹æ—¶æ›´çµæ´»æ–¹ä¾¿ã€‚ ä¸‹æ¸¸ä¸šåŠ¡ä½¿ç”¨ï¼šå•äº‹åŠ¡äº‹å®è¡¨ä¸‹æ¸¸ç”¨æˆ·æ›´å®¹æ˜“ç†è§£ã€‚ è®¡ç®—å­˜å‚¨æˆæœ¬ï¼šå¤šäº‹åŠ¡äº‹å®è¡¨æ›´ä¼˜ã€‚ ä¸¤ç§äº‹å®è¡¨å¯¹æ¯” ","date":"2022-11-30","objectID":"/fact-tab/:2:4","tags":["æ•°ä»“"],"title":"ã€æ•°ä»“ã€‘äº‹å®è¡¨è®¾è®¡","uri":"/fact-tab/"},{"categories":["å­¦ä¹ "],"content":"çˆ¶å­äº‹å®çš„å¤„ç†æ–¹å¼ ä¾‹å¦‚ç”¨æˆ·ä¸‹å•å¤šä¸ªå•†å“ã€‚äº¤æ˜“äº‹åŠ¡äº‹å®è¡¨çš„ç²’åº¦é€‰æ‹©å­è®¢å•ï¼ˆä¸€ä¸ªè®¢å•ä¸€ç§å•†å“ï¼‰ã€‚ ","date":"2022-11-30","objectID":"/fact-tab/:2:5","tags":["æ•°ä»“"],"title":"ã€æ•°ä»“ã€‘äº‹å®è¡¨è®¾è®¡","uri":"/fact-tab/"},{"categories":["å­¦ä¹ "],"content":"äº‹å®çš„è®¾è®¡åŸåˆ™ äº‹å®å®Œæ•´æ€§ äº‹å®ä¸€è‡´æ€§ äº‹å®å¯åŠ æ€§ ","date":"2022-11-30","objectID":"/fact-tab/:2:6","tags":["æ•°ä»“"],"title":"ã€æ•°ä»“ã€‘äº‹å®è¡¨è®¾è®¡","uri":"/fact-tab/"},{"categories":["å­¦ä¹ "],"content":"å‘¨æœŸå¿«ç…§äº‹å®è¡¨ ç¡®å®šçš„äº‹ä»¶é—´éš”å†…å¯¹å®ä½“çš„åº¦é‡è¿›è¡ŒæŠ½æ ·ã€‚ ","date":"2022-11-30","objectID":"/fact-tab/:3:0","tags":["æ•°ä»“"],"title":"ã€æ•°ä»“ã€‘äº‹å®è¡¨è®¾è®¡","uri":"/fact-tab/"},{"categories":["å­¦ä¹ "],"content":"ç‰¹æ€§ ç”¨å¿«ç…§é‡‡æ ·çŠ¶æ€ï¼šå¿«ç…§äº‹å®è¡¨ä»¥é¢„å®šçš„é—´éš”é‡‡æ ·çŠ¶æ€åº¦é‡ã€‚ å¿«ç…§ç²’åº¦ï¼šå¤šç»´å£°æ˜ï¼Œå³é‡‡æ ·å‘¨æœŸä»¥åŠä»€ä¹ˆå°†è¢«é‡‡æ ·ã€‚ å¯†åº¦ä¸ç¨€ç–æ€§ï¼šå¿«ç…§äº‹å®è¡¨æ˜¯ç¨ å¯†çš„ï¼Œæ— è®ºå½“å¤©æ˜¯å¦æœ‰ä¸šåŠ¡è¿‡ç¨‹å‘ç”Ÿï¼Œéƒ½ä¼šè®°å½•ä¸€è¡Œã€‚ åŠå¯åŠ æ€§ï¼šä¸èƒ½æ ¹æ®æ—¶é—´ç»´åº¦è·å–æœ‰æ„ä¹‰çš„æ±‡æ€»ç»“æœï¼Œä½†å¯ä»¥æ±‚å¹³å‡å€¼ã€‚ ","date":"2022-11-30","objectID":"/fact-tab/:3:1","tags":["æ•°ä»“"],"title":"ã€æ•°ä»“ã€‘äº‹å®è¡¨è®¾è®¡","uri":"/fact-tab/"},{"categories":["å­¦ä¹ "],"content":"ä¸»è¦äº‹é¡¹ äº‹åŠ¡ä¸å¿«ç…§æˆå¯¹è®¾è®¡ é™„åŠ äº‹å®ï¼šå¯ä»¥é™„åŠ ä¸Šä¸€ä¸ªå‘¨æœŸçš„çŠ¶æ€åº¦é‡ï¼Œä¾¿äºåˆ†æä½¿ç”¨ å‘¨æœŸåˆ°æ—¥æœŸåº¦é‡ï¼šå¤šç§ç»Ÿè®¡å‘¨æœŸï¼Œä¾‹å¦‚è´¢å¹´è‡³ä»Šçš„ä¸‹å•é‡‘é¢ã€è‡ªç„¶å¹´è‡³ä»Šçš„ä¸‹å•é‡‘é¢ ","date":"2022-11-30","objectID":"/fact-tab/:3:2","tags":["æ•°ä»“"],"title":"ã€æ•°ä»“ã€‘äº‹å®è¡¨è®¾è®¡","uri":"/fact-tab/"},{"categories":["å­¦ä¹ "],"content":"ç´¯ç§¯å¿«ç…§äº‹å®è¡¨ ç”¨æ¥ç»Ÿè®¡ä¸‹å•åˆ°æ”¯ä»˜çš„æ—¶é•¿ã€æ”¯ä»˜åˆ°å‘è´§çš„æ—¶é•¿ã€ä¸‹å•åˆ°ç¡®è®¤æ”¶è´§çš„æ—¶é•¿ç­‰ã€‚ ","date":"2022-11-30","objectID":"/fact-tab/:4:0","tags":["æ•°ä»“"],"title":"ã€æ•°ä»“ã€‘äº‹å®è¡¨è®¾è®¡","uri":"/fact-tab/"},{"categories":["å­¦ä¹ "],"content":"è®¾è®¡è¿‡ç¨‹ åŒäº‹åŠ¡äº‹å®è¡¨ä¸€æ ·ï¼šé€‰æ‹©ä¸šåŠ¡è¿‡ç¨‹ã€ç¡®å®šç²’åº¦ã€ç¡®å®šç»´åº¦ã€ç¡®å®šäº‹å®ã€é€€åŒ–ç»´åº¦ã€‚ ","date":"2022-11-30","objectID":"/fact-tab/:4:1","tags":["æ•°ä»“"],"title":"ã€æ•°ä»“ã€‘äº‹å®è¡¨è®¾è®¡","uri":"/fact-tab/"},{"categories":["å­¦ä¹ "],"content":"ç‰¹ç‚¹ æ•°æ®ä¸æ–­æ›´æ–° å¤šä¸šåŠ¡è¿‡ç¨‹æ—¥æœŸ ","date":"2022-11-30","objectID":"/fact-tab/:4:2","tags":["æ•°ä»“"],"title":"ã€æ•°ä»“ã€‘äº‹å®è¡¨è®¾è®¡","uri":"/fact-tab/"},{"categories":["å­¦ä¹ "],"content":"ç‰¹æ®Šå¤„ç† éçº¿æ€§è¿‡ç¨‹ï¼šä¾‹å¦‚ä¸‹å•â†’æ”¯ä»˜â†’å‘è´§â†’ç¡®è®¤æ”¶è´§ï¼Œä¸ä¸€å®šéƒ½æ˜¯è¿™æ ·çš„è¿‡ç¨‹ï¼Œå¯èƒ½æ˜¯ä¸‹å•â†’å…³é—­è®¢å•ã€‚ å¤šæºè¿‡ç¨‹ï¼šæ¥è‡ªä¸åŒçš„ç³»ç»Ÿæˆ–è¡¨ã€‚ ä¸šåŠ¡è¿‡ç¨‹å–èˆï¼šç®€åŒ–ä¸€äº›ä¸šåŠ¡è¿‡ç¨‹ã€‚ ","date":"2022-11-30","objectID":"/fact-tab/:4:3","tags":["æ•°ä»“"],"title":"ã€æ•°ä»“ã€‘äº‹å®è¡¨è®¾è®¡","uri":"/fact-tab/"},{"categories":["å­¦ä¹ "],"content":"ç‰©ç†å®ç° å…¨é‡è¡¨ã€‚ä¸€èˆ¬æ˜¯æ—¥æœŸåˆ†åŒºè¡¨ å…¨é‡è¡¨çš„å˜åŒ–å½¢å¼ã€‚ç”¨äºäº‹å®è¡¨æ•°æ®é‡å¤§æ—¶ã€‚æ¯”å¦‚äº¤æ˜“è®¢å•è®¾ç½® 200 å¤©ä½œä¸ºè®¢å•äº§ç”Ÿåˆ°æ¶ˆäº¡çš„æœ€å¤§é—´éš”ï¼Œè®¾è®¡æœ€è¿‘ 200 å¤©çš„è®¢å•ç´¯ç§¯å¿«ç…§äº‹å®è¡¨ã€‚ ä»¥ä¸šåŠ¡å®ä½“çš„ç»“æŸæ—¶é—´åˆ†åŒºã€‚æ¯å¤©åˆ†åŒºæ˜¯å­˜æ”¾å½“å¤©ç»“æŸçš„æ•°æ®ï¼Œæœªç»“æŸçš„æ”¾åœ¨ä¸€ä¸ªæå¤§çš„æ—¶é—´ä¸‹é¢æ¯”å¦‚ 3000-12-31ã€‚ ","date":"2022-11-30","objectID":"/fact-tab/:4:4","tags":["æ•°ä»“"],"title":"ã€æ•°ä»“ã€‘äº‹å®è¡¨è®¾è®¡","uri":"/fact-tab/"},{"categories":["å­¦ä¹ "],"content":"ä¸‰ç§äº‹å®è¡¨çš„æ¯”è¾ƒ ä¸‰ç§äº‹å®è¡¨çš„æ¯”è¾ƒ ","date":"2022-11-30","objectID":"/fact-tab/:5:0","tags":["æ•°ä»“"],"title":"ã€æ•°ä»“ã€‘äº‹å®è¡¨è®¾è®¡","uri":"/fact-tab/"},{"categories":["å­¦ä¹ "],"content":"æ— äº‹å®çš„äº‹å®è¡¨ æ²¡æœ‰æ˜ç¡®äº‹å®ï¼Œä½†å¯ä»¥ç”¨æ¥æ”¯æŒä¸šåŠ¡è¿‡ç¨‹çš„åº¦é‡ã€‚ä¾‹å¦‚ï¼š è®°å½•äº‹ä»¶å‘ç”Ÿï¼šç”¨æˆ·æµè§ˆäº†é¡µé¢ï¼Œæ¯æ¬¡æµè§ˆäº‹å®ä¸º 1ï¼› æ¡ä»¶ã€èµ„æ ¼ã€èŒƒå›´ç±»ï¼Œä¾‹å¦‚ä¿ƒé”€èŒƒå›´ã€‚ ","date":"2022-11-30","objectID":"/fact-tab/:6:0","tags":["æ•°ä»“"],"title":"ã€æ•°ä»“ã€‘äº‹å®è¡¨è®¾è®¡","uri":"/fact-tab/"},{"categories":["å­¦ä¹ "],"content":"èšé›†å‹äº‹å®è¡¨ æŠŠé¢‘ç¹ä½¿ç”¨çš„å…¬ç”¨æ•°æ®èšé›†æ±‡æ€»è¿›è¡Œæ²‰æ·€ï¼Œè¢«ç§°ä¸ºâ€œå…¬å…±æ±‡æ€»å±‚â€œã€‚ä¾‹å¦‚å–å®¶è¿‘ N å¤©çš„äº¤æ˜“æ±‡æ€»è¡¨ã€‚ ","date":"2022-11-30","objectID":"/fact-tab/:7:0","tags":["æ•°ä»“"],"title":"ã€æ•°ä»“ã€‘äº‹å®è¡¨è®¾è®¡","uri":"/fact-tab/"},{"categories":["å­¦ä¹ "],"content":"èšé›†çš„åŸºæœ¬åŸåˆ™ ä¸€è‡´æ€§ é¿å…å•ä¸€è¡¨è®¾è®¡ èšé›†ç²’åº¦å¯ä¸åŒ ","date":"2022-11-30","objectID":"/fact-tab/:7:1","tags":["æ•°ä»“"],"title":"ã€æ•°ä»“ã€‘äº‹å®è¡¨è®¾è®¡","uri":"/fact-tab/"},{"categories":["å­¦ä¹ "],"content":"èšé›†çš„åŸºæœ¬æ­¥éª¤ ç¡®å®šèšé›†ç»´åº¦ ç¡®å®šä¸€è‡´æ€§ä¸Šé’» ç¡®å®šèšé›†äº‹å® ","date":"2022-11-30","objectID":"/fact-tab/:7:2","tags":["æ•°ä»“"],"title":"ã€æ•°ä»“ã€‘äº‹å®è¡¨è®¾è®¡","uri":"/fact-tab/"},{"categories":["åˆ·é¢˜"],"content":"åŠ›æ‰£-ä¸¤æ•°ä¹‹å’Œ","date":"2022-11-29","objectID":"/two-sum/","tags":["åŠ›æ‰£"],"title":"åŠ›æ‰£-ä¸¤æ•°ä¹‹å’Œ","uri":"/two-sum/"},{"categories":["åˆ·é¢˜"],"content":"ğŸ”— é¢˜ç›®é“¾æ¥ ç»™å®šä¸€ä¸ªæ•´æ•°æ•°ç»„ nums å’Œä¸€ä¸ªæ•´æ•°ç›®æ ‡å€¼ targetï¼Œè¯·ä½ åœ¨è¯¥æ•°ç»„ä¸­æ‰¾å‡ºå’Œä¸ºç›®æ ‡å€¼ target çš„é‚£ä¸¤ä¸ªæ•´æ•°ï¼Œå¹¶è¿”å›å®ƒä»¬çš„æ•°ç»„ä¸‹æ ‡ã€‚ ä½ å¯ä»¥å‡è®¾æ¯ç§è¾“å…¥åªä¼šå¯¹åº”ä¸€ä¸ªç­”æ¡ˆã€‚ä½†æ˜¯ï¼Œæ•°ç»„ä¸­åŒä¸€ä¸ªå…ƒç´ åœ¨ç­”æ¡ˆé‡Œä¸èƒ½é‡å¤å‡ºç°ã€‚ ä½ å¯ä»¥æŒ‰ä»»æ„é¡ºåºè¿”å›ç­”æ¡ˆã€‚ ç¤ºä¾‹ 1ï¼š è¾“å…¥ï¼šnums = [2,7,11,15], target = 9 è¾“å‡ºï¼š[0,1] è§£é‡Šï¼šå› ä¸º nums[0] + nums[1] == 9 ï¼Œè¿”å› [0, 1] ã€‚ ç¤ºä¾‹ 2ï¼š è¾“å…¥ï¼šnums = [3,2,4], target = 6 è¾“å‡ºï¼š[1,2] ç¤ºä¾‹ 2ï¼š è¾“å…¥ï¼šnums = [3,3], target = 6 è¾“å‡ºï¼š[0,1] å‚è€ƒé“¾æ¥ï¼šä¸¤æ•°ä¹‹å’Œ1 ","date":"2022-11-29","objectID":"/two-sum/:0:0","tags":["åŠ›æ‰£"],"title":"åŠ›æ‰£-ä¸¤æ•°ä¹‹å’Œ","uri":"/two-sum/"},{"categories":["åˆ·é¢˜"],"content":"æ–¹æ³•ä¸€ï¼šæš´åŠ›æšä¸¾ æ€è·¯åŠç®—æ³• æœ€å®¹æ˜“æƒ³åˆ°çš„æ–¹æ³•æ˜¯æšä¸¾æ•°ç»„ä¸­çš„æ¯ä¸€ä¸ªæ•° xï¼Œå¯»æ‰¾æ•°ç»„ä¸­æ˜¯å¦å­˜åœ¨ target - xã€‚ å½“æˆ‘ä»¬ä½¿ç”¨éå†æ•´ä¸ªæ•°ç»„çš„æ–¹å¼å¯»æ‰¾ target - x æ—¶ï¼Œéœ€è¦æ³¨æ„åˆ°æ¯ä¸€ä¸ªä½äº x ä¹‹å‰çš„å…ƒç´ éƒ½å·²ç»å’Œ x åŒ¹é…è¿‡ï¼Œå› æ­¤ä¸éœ€è¦å†è¿›è¡ŒåŒ¹é…ã€‚è€Œæ¯ä¸€ä¸ªå…ƒç´ ä¸èƒ½è¢«ä½¿ç”¨ä¸¤æ¬¡ï¼Œæ‰€ä»¥æˆ‘ä»¬åªéœ€è¦åœ¨ x åé¢çš„å…ƒç´ ä¸­å¯»æ‰¾ target - xã€‚ ä»£ç  def twoSum(nums: List[int], target: int) -\u003e List[int]: n = len(nums) for i in range(n): for j in range(i + 1, n): if nums[i] + nums[j] == target: return [i, j] return [] å¤æ‚åº¦åˆ†æ æ—¶é—´å¤æ‚åº¦ï¼š$O(N^2)$ï¼Œå…¶ä¸­ $N$ æ˜¯æ•°ç»„ä¸­çš„å…ƒç´ æ•°é‡ã€‚æœ€åæƒ…å†µä¸‹æ•°ç»„ä¸­ä»»æ„ä¸¤ä¸ªæ•°éƒ½è¦è¢«åŒ¹é…ä¸€æ¬¡ã€‚ ç©ºé—´å¤æ‚åº¦ï¼š$O(1)$ã€‚ ","date":"2022-11-29","objectID":"/two-sum/:1:0","tags":["åŠ›æ‰£"],"title":"åŠ›æ‰£-ä¸¤æ•°ä¹‹å’Œ","uri":"/two-sum/"},{"categories":["åˆ·é¢˜"],"content":"æ–¹æ³•äºŒï¼šå“ˆå¸Œè¡¨ æ€è·¯åŠç®—æ³• æ³¨æ„åˆ°æ–¹æ³•ä¸€çš„æ—¶é—´å¤æ‚åº¦è¾ƒé«˜çš„åŸå› æ˜¯å¯»æ‰¾ target - x çš„æ—¶é—´å¤æ‚åº¦è¿‡é«˜ã€‚å› æ­¤ï¼Œæˆ‘ä»¬éœ€è¦ä¸€ç§æ›´ä¼˜ç§€çš„æ–¹æ³•ï¼Œèƒ½å¤Ÿå¿«é€Ÿå¯»æ‰¾æ•°ç»„ä¸­æ˜¯å¦å­˜åœ¨ç›®æ ‡å…ƒç´ ã€‚å¦‚æœå­˜åœ¨ï¼Œæˆ‘ä»¬éœ€è¦æ‰¾å‡ºå®ƒçš„ç´¢å¼•ã€‚ ä½¿ç”¨å“ˆå¸Œè¡¨ï¼Œå¯ä»¥å°†å¯»æ‰¾ target - x çš„æ—¶é—´å¤æ‚åº¦é™ä½åˆ°ä» $O(N)$ é™ä½åˆ° $O(1)$ã€‚ è¿™æ ·æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªå“ˆå¸Œè¡¨ï¼Œå¯¹äºæ¯ä¸€ä¸ª xï¼Œæˆ‘ä»¬é¦–å…ˆæŸ¥è¯¢å“ˆå¸Œè¡¨ä¸­æ˜¯å¦å­˜åœ¨ target - xï¼Œç„¶åå°† x æ’å…¥åˆ°å“ˆå¸Œè¡¨ä¸­ï¼Œå³å¯ä¿è¯ä¸ä¼šè®© x å’Œè‡ªå·±åŒ¹é…ã€‚ ä»£ç  def twoSum(nums: List[int], target: int) -\u003e List[int]: hashtable = dict() for i, num in enumerate(nums): if target - num in hashtable: return [hashtable[target - num], i] hashtable[nums[i]] = i return [] å¤æ‚åº¦åˆ†æ æ—¶é—´å¤æ‚åº¦ï¼š$O(N)$ï¼Œå…¶ä¸­ $N$ æ˜¯æ•°ç»„ä¸­çš„å…ƒç´ æ•°é‡ã€‚å¯¹äºæ¯ä¸€ä¸ªå…ƒç´  xï¼Œæˆ‘ä»¬å¯ä»¥ $O(1)$ åœ°å¯»æ‰¾ target - xã€‚ ç©ºé—´å¤æ‚åº¦ï¼š$O(N)$ï¼Œå…¶ä¸­ $N$ æ˜¯æ•°ç»„ä¸­çš„å…ƒç´ æ•°é‡ã€‚ä¸»è¦ä¸ºå“ˆå¸Œè¡¨çš„å¼€é”€ã€‚ å‚è€ƒé“¾æ¥ï¼šä¸¤æ•°ä¹‹å’ŒÂ â†©ï¸ ","date":"2022-11-29","objectID":"/two-sum/:2:0","tags":["åŠ›æ‰£"],"title":"åŠ›æ‰£-ä¸¤æ•°ä¹‹å’Œ","uri":"/two-sum/"},{"categories":["åˆ·é¢˜"],"content":"åŠ›æ‰£-æ•°ç»„ä¸­é‡å¤çš„æ•°æ®","date":"2022-11-29","objectID":"/duplicates/","tags":["åŠ›æ‰£"],"title":"åŠ›æ‰£-æ•°ç»„ä¸­é‡å¤çš„æ•°æ®","uri":"/duplicates/"},{"categories":["åˆ·é¢˜"],"content":"ğŸ”— é¢˜ç›®é“¾æ¥ ç»™ä½ ä¸€ä¸ªé•¿åº¦ä¸º n çš„æ•´æ•°æ•°ç»„ nums ï¼Œå…¶ä¸­ nums çš„æ‰€æœ‰æ•´æ•°éƒ½åœ¨èŒƒå›´ [1, n] å†…ï¼Œä¸”æ¯ä¸ªæ•´æ•°å‡ºç°ä¸€æ¬¡æˆ–ä¸¤æ¬¡ã€‚è¯·ä½ æ‰¾å‡ºæ‰€æœ‰å‡ºç°ä¸¤æ¬¡çš„æ•´æ•°ï¼Œå¹¶ä»¥æ•°ç»„å½¢å¼è¿”å›ã€‚ ä½ å¿…é¡»è®¾è®¡å¹¶å®ç°ä¸€ä¸ªæ—¶é—´å¤æ‚åº¦ä¸º O(n) ä¸”ä»…ä½¿ç”¨å¸¸é‡é¢å¤–ç©ºé—´çš„ç®—æ³•è§£å†³æ­¤é—®é¢˜ã€‚ ç¤ºä¾‹ 1ï¼š è¾“å…¥ï¼šnums = [4,3,2,7,8,2,3,1] è¾“å‡ºï¼š[2,3] ç¤ºä¾‹ 2ï¼š è¾“å…¥ï¼šnums = [1,1,2] è¾“å‡ºï¼š[1] ç¤ºä¾‹ 3ï¼š è¾“å…¥ï¼šnums = [1] è¾“å‡ºï¼š[] å‚è€ƒé“¾æ¥ï¼šæ•°ç»„ä¸­é‡å¤çš„æ•°æ®1 ","date":"2022-11-29","objectID":"/duplicates/:0:0","tags":["åŠ›æ‰£"],"title":"åŠ›æ‰£-æ•°ç»„ä¸­é‡å¤çš„æ•°æ®","uri":"/duplicates/"},{"categories":["åˆ·é¢˜"],"content":"æ–¹æ³•ä¸€ï¼šå°†å…ƒç´ äº¤æ¢åˆ°å¯¹åº”çš„ä½ç½® æ€è·¯ä¸ç®—æ³• ç”±äºç»™å®šçš„ $n$ ä¸ªæ•°éƒ½åœ¨ $[1,n]$ çš„èŒƒå›´å†…ï¼Œå¦‚æœæœ‰æ•°å­—å‡ºç°äº†ä¸¤æ¬¡ï¼Œå°±æ„å‘³ç€ $[1,n]$ ä¸­æœ‰æ•°å­—æ²¡æœ‰å‡ºç°è¿‡ã€‚ å› æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥å°è¯•å°†æ¯ä¸€ä¸ªæ•°æ”¾åœ¨å¯¹åº”çš„ä½ç½®ã€‚ç”±äºæ•°ç»„çš„ä¸‹æ ‡èŒƒå›´æ˜¯ $[0,nâˆ’1]$ï¼Œæˆ‘ä»¬éœ€è¦å°†æ•° $i$ æ”¾åœ¨æ•°ç»„ä¸­ä¸‹æ ‡ä¸º $iâˆ’1$ çš„ä½ç½®ï¼š å¦‚æœ $i$ æ°å¥½å‡ºç°äº†ä¸€æ¬¡ï¼Œé‚£ä¹ˆå°† $i$ æ”¾åœ¨æ•°ç»„ä¸­ä¸‹æ ‡ä¸º $iâˆ’1$ çš„ä½ç½®å³å¯ï¼› å¦‚æœ $i$ å‡ºç°äº†ä¸¤æ¬¡ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¸Œæœ›å…¶ä¸­çš„ä¸€ä¸ª $i$ æ”¾åœ¨æ•°ç»„ä¸‹æ ‡ä¸­ä¸º $iâˆ’1$ çš„ä½ç½®ï¼Œå¦ä¸€ä¸ª $i$ æ”¾ç½®åœ¨ä»»æ„ã€Œä¸å†²çªã€çš„ä½ç½® $j$ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œæ•° $j+1$ æ²¡æœ‰åœ¨æ•°ç»„ä¸­å‡ºç°è¿‡ã€‚ è¿™æ ·ä¸€æ¥ï¼Œå¦‚æœæˆ‘ä»¬æŒ‰ç…§ä¸Šè¿°çš„è§„åˆ™æ”¾ç½®æ¯ä¸€ä¸ªæ•°ï¼Œé‚£ä¹ˆæˆ‘ä»¬åªéœ€è¦å¯¹æ•°ç»„è¿›è¡Œä¸€æ¬¡éå†ã€‚å½“éå†åˆ°ä½ç½® $i$ æ—¶ï¼Œå¦‚æœ $nums[i]âˆ’1 \\neq i$ï¼Œè¯´æ˜ $nums[i]$ å‡ºç°äº†ä¸¤æ¬¡ï¼ˆå¦ä¸€æ¬¡å‡ºç°åœ¨ä½ç½® $num[i]âˆ’1$ï¼‰ï¼Œæˆ‘ä»¬å°±å¯ä»¥å°† $num[i]$ æ”¾å…¥ç­”æ¡ˆã€‚ æ”¾ç½®çš„æ–¹æ³•ä¹Ÿå¾ˆç›´è§‚ï¼šæˆ‘ä»¬å¯¹æ•°ç»„è¿›è¡Œä¸€æ¬¡éå†ã€‚å½“éå†åˆ°ä½ç½® $i$ æ—¶ï¼Œæˆ‘ä»¬çŸ¥é“ $nums[i]$ åº”è¯¥è¢«æ”¾åœ¨ä½ç½® $nums[i]âˆ’1$ã€‚å› æ­¤æˆ‘ä»¬äº¤æ¢ $num[i]$ å’Œ $nums[nums[i]âˆ’1]$ å³å¯ï¼Œç›´åˆ°å¾…äº¤æ¢çš„ä¸¤ä¸ªå…ƒç´ ç›¸ç­‰ä¸ºæ­¢ã€‚ ä»£ç  def findDuplicates(nums: List[int]) -\u003e List[int]: for i in range(len(nums)): while nums[i] != nums[nums[i] - 1]: nums[nums[i] - 1], nums[i] = nums[i], nums[nums[i] - 1] return [num for i, num in enumerate(nums) if num - 1 != i] å¤æ‚åº¦åˆ†æ æ—¶é—´å¤æ‚åº¦ï¼š$O(n)$ã€‚æ¯ä¸€æ¬¡äº¤æ¢æ“ä½œä¼šä½¿å¾—è‡³å°‘ä¸€ä¸ªå…ƒç´ è¢«äº¤æ¢åˆ°å¯¹åº”çš„æ­£ç¡®ä½ç½®ï¼Œå› æ­¤äº¤æ¢çš„æ¬¡æ•°ä¸º $O(n)$ï¼Œæ€»æ—¶é—´å¤æ‚åº¦ä¸º $O(n)$ã€‚ ç©ºé—´å¤æ‚åº¦ï¼š$O(1)$ã€‚è¿”å›å€¼ä¸è®¡å…¥ç©ºé—´å¤æ‚åº¦ã€‚ ","date":"2022-11-29","objectID":"/duplicates/:1:0","tags":["åŠ›æ‰£"],"title":"åŠ›æ‰£-æ•°ç»„ä¸­é‡å¤çš„æ•°æ®","uri":"/duplicates/"},{"categories":["åˆ·é¢˜"],"content":"æ–¹æ³•äºŒï¼šä½¿ç”¨æ­£è´Ÿå·ä½œä¸ºæ ‡è®° æ€è·¯ä¸ç®—æ³• æˆ‘ä»¬ä¹Ÿå¯ä»¥ç»™ $nums[i]$ åŠ ä¸Šã€Œè´Ÿå·ã€è¡¨ç¤ºæ•° $i+1$ å·²ç»å‡ºç°è¿‡ä¸€æ¬¡ã€‚å…·ä½“åœ°ï¼Œæˆ‘ä»¬é¦–å…ˆå¯¹æ•°ç»„è¿›è¡Œä¸€æ¬¡éå†ã€‚å½“éå†åˆ°ä½ç½® $i$ æ—¶ï¼Œæˆ‘ä»¬è€ƒè™‘ $nums[nums[i]âˆ’1]$ çš„æ­£è´Ÿæ€§ï¼š å¦‚æœ $nums[nums[i]âˆ’1]$ æ˜¯æ­£æ•°ï¼Œè¯´æ˜ $nums[i]$ è¿˜æ²¡æœ‰å‡ºç°è¿‡ï¼Œæˆ‘ä»¬å°† $nums[nums[i]âˆ’1]$ åŠ ä¸Šè´Ÿå·ï¼› å¦‚æœ $nums[nums[i]âˆ’1]$ æ˜¯è´Ÿæ•°ï¼Œè¯´æ˜ $nums[i]$ å·²ç»å‡ºç°è¿‡ä¸€æ¬¡ï¼Œæˆ‘ä»¬å°† $nums[i]$ æ”¾å…¥ç­”æ¡ˆã€‚ ç»†èŠ‚ ç”±äº $nums[i]$ æœ¬èº«å¯èƒ½å·²ç»ä¸ºè´Ÿæ•°ï¼Œå› æ­¤åœ¨å°† $nums[i]$ ä½œä¸ºä¸‹æ ‡æˆ–è€…æ”¾å…¥ç­”æ¡ˆæ—¶ï¼Œéœ€è¦å–ç»å¯¹å€¼ã€‚ ä»£ç  def findDuplicates(nums: List[int]) -\u003e List[int]: ans = [] for x in nums: x = abs(x) if nums[x - 1] \u003e 0: nums[x - 1] = -nums[x - 1] else: ans.append(x) return ans å¤æ‚åº¦åˆ†æ æ—¶é—´å¤æ‚åº¦ï¼š$O(n)$ã€‚æˆ‘ä»¬åªéœ€è¦å¯¹æ•°ç»„ $nums$ è¿›è¡Œä¸€æ¬¡éå†ã€‚ ç©ºé—´å¤æ‚åº¦ï¼š$O(1)$ã€‚è¿”å›å€¼ä¸è®¡å…¥ç©ºé—´å¤æ‚åº¦ã€‚ å‚è€ƒé“¾æ¥ï¼šæ•°ç»„ä¸­é‡å¤çš„æ•°æ®Â â†©ï¸ ","date":"2022-11-29","objectID":"/duplicates/:2:0","tags":["åŠ›æ‰£"],"title":"åŠ›æ‰£-æ•°ç»„ä¸­é‡å¤çš„æ•°æ®","uri":"/duplicates/"},{"categories":["å­¦ä¹ "],"content":"Inmon èŒƒå¼å»ºæ¨¡å’Œ Kimball ç»´åº¦å»ºæ¨¡","date":"2022-11-29","objectID":"/kimball/","tags":["ç»´åº¦å»ºæ¨¡"],"title":"Inmon èŒƒå¼å»ºæ¨¡å’Œ Kimball ç»´åº¦å»ºæ¨¡","uri":"/kimball/"},{"categories":["å­¦ä¹ "],"content":"æœ¬æ–‡å¼€å§‹å…ˆç®€å•ç†è§£ä¸¤ç§å»ºæ¨¡çš„æ ¸å¿ƒæ€æƒ³ï¼Œç„¶åæ ¹æ®ä¸€ä¸ªå…·ä½“çš„ä¾‹å­ï¼Œåˆ†åˆ«ä½¿ç”¨è¿™ä¸¤ç§å»ºæ¨¡æ–¹å¼è¿›è¡Œå»ºæ¨¡ï¼Œå¤§å®¶ä¾¿ä¼šä¸€ç›®äº†ç„¶ï¼ ğŸ˜ã€‚ Inmonï¼šã€Šæ•°æ®ä»“åº“ã€‹ Kimballï¼šã€Šæ•°ä»“å·¥å…·ç®±ã€‹ èŒƒå¼å»ºæ¨¡ è‡ªä¸Šå‘ä¸‹(æ•°æ®çš„æµå‘)ï¼Œâ€œä¸Š\"å³æ•°æ®çš„ä¸Šæ¸¸ï¼Œâ€œä¸‹\"å³æ•°æ®çš„ä¸‹æ¸¸ åˆ†æ•£å¼‚æ„çš„æ•°æ®æºâ€”\u003eæ•°æ®ä»“åº“â€”\u003eæ•°æ®é›†å¸‚ ä»¥æ•°æ®æºå¤´ä¸ºå¯¼å‘ å°†æ•°æ®æŠ½å–ä¸ºå®ä½“-å…³ç³»æ¨¡å‹ å¹¶ä¸å¼ºè°ƒäº‹å®è¡¨å’Œç»´åº¦è¡¨ ç»´åº¦å»ºæ¨¡ è‡ªä¸‹å‘ä¸Šï¼Œæ•°æ®é›†å¸‚â€”\u003eæ•°æ®ä»“åº“â€”\u003eåˆ†æ•£å¼‚æ„çš„æ•°æ®æº ä»¥æœ€ç»ˆä»»åŠ¡ä¸ºå¯¼å‘ æŒ‰ç…§ç›®æ ‡æ‹†åˆ†éœ€æ±‚ï¼ŒæŠ½å–ä¸ºäº‹å®-ç»´åº¦æ¨¡å‹ï¼Œæ•°æ®æºç»è¿‡ETLè½¬åŒ–ä¸ºäº‹å®è¡¨å’Œç»´åº¦è¡¨å¯¼å…¥æ•°æ®é›†å¸‚ ä»¥æ˜Ÿå‹æ¨¡å‹æˆ–é›ªèŠ±æ¨¡å‹æ„å»ºç»´åº¦æ•°æ®ä»“åº“ æ•°æ®é›†å¸‚æ˜¯æ•°æ®ä»“åº“ä¸­çš„ä¸€ä¸ªé€»è¾‘ä¸Šçš„ä¸»é¢˜åŸŸ å»ºæ¨¡å®è·µ ä»¥ç”µå•†ç³»ç»Ÿä¸ºä¾‹ï¼Œæœ‰4å¼ è¡¨ï¼Œåˆ†åˆ«æ˜¯ï¼š ç”¨æˆ·ä¿¡æ¯è¡¨ åŸå¸‚ä¿¡æ¯è¡¨ ç”¨æˆ·ç­‰çº§è¡¨ ç”¨æˆ·è®¢å•è¡¨ ","date":"2022-11-29","objectID":"/kimball/:0:0","tags":["ç»´åº¦å»ºæ¨¡"],"title":"Inmon èŒƒå¼å»ºæ¨¡å’Œ Kimball ç»´åº¦å»ºæ¨¡","uri":"/kimball/"},{"categories":["å­¦ä¹ "],"content":"Inmonå»ºæ¨¡ å°†æ•°æ®æŠ½å–ä¸ºå®ä½“-å…³ç³»(ER)æ¨¡å‹ ç”¨æˆ·å®ä½“è¡¨(ETLå·²è¿‡æ»¤æ‰æ³¨é”€ç”¨æˆ·) æ”¯ä»˜æˆåŠŸè®¢å•å®ä½“è¡¨ åŸå¸‚ä¿¡æ¯å®ä½“è¡¨ è®¢å•ä¸ç”¨æˆ·å…³ç³»è¡¨ ç”¨æˆ·ä¸åŸå¸‚ä¿¡æ¯å…³ç³»è¡¨ ç”¨æˆ·ä¸ç”¨æˆ·ç­‰çº§å…³ç³»è¡¨ æ•°æ®æ²¡æœ‰å†—ä½™ï¼Œç¬¦åˆä¸‰èŒƒå¼è®¾è®¡è§„èŒƒ ","date":"2022-11-29","objectID":"/kimball/:1:0","tags":["ç»´åº¦å»ºæ¨¡"],"title":"Inmon èŒƒå¼å»ºæ¨¡å’Œ Kimball ç»´åº¦å»ºæ¨¡","uri":"/kimball/"},{"categories":["å­¦ä¹ "],"content":"Kimballå»ºæ¨¡ å°†æ•°æ®æŠ½å–ä¸ºäº‹å®è¡¨å’Œç»´åº¦è¡¨ åœ¨ Kimball ç»´åº¦å»ºæ¨¡ä¸­ï¼Œä¸éœ€è¦å•ç‹¬ç»´æŠ¤æ•°æ®å…³ç³»è¡¨ï¼Œå› ä¸ºå…³ç³»å·²ç»å†—ä½™åœ¨äº‹å®è¡¨å’Œç»´åº¦è¡¨ä¸­ æ”¯ä»˜æˆåŠŸè®¢å•äº‹å®è¡¨ ç”¨æˆ·ç»´åº¦è¡¨ åŸå¸‚ä¿¡æ¯ç»´åº¦è¡¨ ç”¨æˆ·ç­‰çº§ç»´åº¦è¡¨ ä»¥ä¸Šæ˜¯é›ªèŠ±æ¨¡å‹ï¼Œç‰¹ç‚¹æ˜¯ç»´åº¦è¡¨å¯ä»¥æ‹¥æœ‰å…¶ä»–ç»´åº¦è¡¨ ","date":"2022-11-29","objectID":"/kimball/:2:0","tags":["ç»´åº¦å»ºæ¨¡"],"title":"Inmon èŒƒå¼å»ºæ¨¡å’Œ Kimball ç»´åº¦å»ºæ¨¡","uri":"/kimball/"},{"categories":["å­¦ä¹ "],"content":"èŒƒå¼å»ºæ¨¡ ä¼˜ç‚¹ï¼š æ²¡æœ‰æ•°æ®å†—ä½™ï¼Œä¿è¯äº†æ•°æ®ä¸€è‡´æ€§ æ•°æ®è§£è€¦ï¼Œæ–¹ä¾¿ç»´æŠ¤ ç¼ºç‚¹ï¼š è¡¨çš„æ•°é‡å¤š æŸ¥è¯¢æ—¶å¤šè¡¨è”æŸ¥é™ä½æŸ¥è¯¢æ€§èƒ½ ","date":"2022-11-29","objectID":"/kimball/:3:0","tags":["ç»´åº¦å»ºæ¨¡"],"title":"Inmon èŒƒå¼å»ºæ¨¡å’Œ Kimball ç»´åº¦å»ºæ¨¡","uri":"/kimball/"},{"categories":["å­¦ä¹ "],"content":"ç»´åº¦å»ºæ¨¡ ä¼˜ç‚¹ï¼š æ¨¡å‹ç®€å•ï¼Œé¢å‘åˆ†æ å¢åŠ æ•°æ®å†—ä½™ï¼Œå¼€å‘å‘¨æœŸçŸ­ï¼Œèƒ½å¿«é€Ÿè¿­ä»£ ç¼ºç‚¹ï¼š æ•°æ®å¤§é‡å†—ä½™ï¼Œé¢„å¤„ç†é˜¶æ®µå¼€é”€å¤§ åæœŸç»´æŠ¤éº»çƒ¦ ç»´åº¦è®¾è®¡ä¸å¥½çš„è¯ä¸èƒ½ä¿è¯æ•°æ®å£å¾„ä¸€è‡´æ€§ â˜ºï¸ ç»´åº¦å°±æ˜¯çœ‹å¾…é—®é¢˜çš„è§’åº¦ï¼Œé‡åº¦å°±æ˜¯äº‹å®è¡¨ä¸­æ•°æ®ç±»å‹çš„å­—æ®µ å¦‚æœæŠŠçœä»½å½“ä½œä¸€ä¸ªå•ç‹¬ç»´åº¦ï¼ŒåŸå¸‚å½“ä½œä¸€ä¸ªå•ç‹¬ç»´åº¦ï¼Œè®¡ç®—åŸå¸‚çš„äººå£æ•°é‡ã€‚ è¿™æ—¶çœä»½å’ŒåŸå¸‚éƒ½æ˜¯å•ç‹¬çš„ç»´åº¦ï¼Œå®ƒä»¬ä¹‹é—´æ²¡æœ‰äº†å…³ç³»ï¼Œä¼šå‡ºç°ï¼š å¹¿ä¸œçœ æ­å·å¸‚ 1500 æµ™æ±Ÿçœ å¹¿å·å¸‚ 1200 åœ¨èŒƒå¼å»ºæ¨¡ä¸­ï¼Œå¼ºè°ƒå®ä½“-å…³ç³»æ¨¡å‹ï¼Œçœä»½å’ŒåŸå¸‚ä¹‹é—´ä¸€å®šå­˜åœ¨å½’å±å…³ç³»ï¼Œæ‰€ä»¥èŒƒå¼å»ºæ¨¡èƒ½ä¿è¯å£å¾„çš„ä¸€è‡´æ€§ï¼Œè€Œç»´åº¦å»ºæ¨¡ä¸èƒ½ï¼ ","date":"2022-11-29","objectID":"/kimball/:4:0","tags":["ç»´åº¦å»ºæ¨¡"],"title":"Inmon èŒƒå¼å»ºæ¨¡å’Œ Kimball ç»´åº¦å»ºæ¨¡","uri":"/kimball/"},{"categories":["å­¦ä¹ "],"content":"å»ºæ¨¡æ–¹å¼å¯¹æ¯” ç‰¹æ€§ Kimball Inmon å¼€å‘å‘¨æœŸ çŸ­ é•¿ ç»´æŠ¤éš¾åº¦ å¤§ å° æ•°æ®è¦æ±‚ é’ˆå¯¹å…·ä½“ä¸šåŠ¡ ç«™åœ¨ä¼ä¸šè§’åº¦ ç¼“æ…¢å˜åŒ–ç»´ æ˜¯ å¦ æ•°æ®æ¨¡å‹ ç»´åº¦å»ºæ¨¡ã€æ˜Ÿå‹æ¨¡å‹ã€é›ªèŠ±æ¨¡å‹ å®ä½“-å…³ç³»æ¨¡å‹ï¼Œå‡†ä¸‰èŒƒå¼è®¾è®¡ ","date":"2022-11-29","objectID":"/kimball/:5:0","tags":["ç»´åº¦å»ºæ¨¡"],"title":"Inmon èŒƒå¼å»ºæ¨¡å’Œ Kimball ç»´åº¦å»ºæ¨¡","uri":"/kimball/"},{"categories":["å­¦ä¹ "],"content":"ä¸‰èŒƒå¼","date":"2022-11-29","objectID":"/3nf/","tags":["é¢è¯•","ä¸‰èŒƒå¼"],"title":"ä¸‰èŒƒå¼","uri":"/3nf/"},{"categories":["å­¦ä¹ "],"content":"ä¸‰èŒƒå¼éƒ½æœ‰å“ªäº›ï¼Ÿä¸¾ä¾‹è¯´æ˜å…·ä½“å«ä¹‰ ğŸ˜ã€‚ ç¬¬ä¸€èŒƒå¼ï¼šåŸå­æ€§(ä¸å¯åˆ†å‰²) ç¬¬äºŒèŒƒå¼ï¼šæ¶ˆé™¤éƒ¨åˆ†ä¾èµ– ç¬¬ä¸‰èŒƒå¼ï¼šæ¶ˆé™¤ä¼ é€’ä¾èµ– ä¸¾ä¾‹ï¼šå­˜åœ¨ä¸€å¼ å­¦ç”Ÿå…³ç³»æ¨¡å‹è¡¨ï¼ŒæŒ‰ç…§ä¸‰èŒƒå¼å»æ”¹è¿›è¯¥æ¨¡å‹ï¼Œå¦‚ä¸‹ï¼š ä¸‰èŒƒå¼ æ ¹æ®ç¬¬ä¸€èŒƒå¼ï¼šå­—æ®µ contact è”ç³»æ–¹å¼è¿˜å¯åˆ’åˆ†ä¸ºé‚®ç®±å’Œè”ç³»ç”µè¯ï¼Œæ”¹è¿›å¦‚ä¸‹ï¼š ä¸‰èŒƒå¼ æ ¹æ®ç¬¬äºŒèŒƒå¼ï¼šå½“éœ€è¦å½•å…¥å­¦ç”Ÿå¼ ä¸‰å¦ä¸€è¯¾ç¨‹ 856 çš„æ–°æˆç»©ï¼Œé™¤äº†æŠŠå­¦ç”Ÿå· stu_idï¼Œè¯¾ç¨‹å· cou_noï¼Œæˆç»© gradeï¼Œè¿˜éœ€å¡«å¼ ä¸‰çš„å…¶ä»–åŸºæœ¬ä¿¡æ¯ï¼Œä½ è§‰å¾—è¯¥å·¥ä½œååˆ†å†—ä½™ã€‚ ä½ æ€è€ƒå‘ç°ï¼šæˆç»© grade ä¾èµ–äºå­¦ç”Ÿå· stu_id å’Œè¯¾ç¨‹å· cou_no æ‰èƒ½å”¯ä¸€ç¡®å®šï¼Œè€Œå¼ ä¸‰åŸºæœ¬ä¿¡æ¯åªä¾èµ–äºå­¦ç”Ÿå· stu_idï¼Œäºæ˜¯ä½ æŠŠè¯¥è¡¨åˆ†æ‹†ä¸ºä¸¤ä¸ªè¡¨ï¼Œæ”¹è¿›å¦‚ä¸‹ï¼š ä¸‰èŒƒå¼ é€šè¿‡æ¶ˆé™¤éƒ¨åˆ†ä¾èµ–ï¼Œä½ åªéœ€è¦å½•å…¥å­¦ç”Ÿå· stu_idï¼Œè¯¾ç¨‹å· cou_noï¼Œæˆç»© grade å³å¯ã€‚ æ ¹æ®ç¬¬ä¸‰èŒƒå¼ï¼šåˆåœ¨å½•å…¥åŒä¸€ä¸ªç³»çš„å­¦ç”Ÿæˆç»©æ—¶ï¼Œå‘ç°ç³»ä¸»ä»»éƒ½æ˜¯ä¸€æ ·ï¼Œå³ï¼šå­¦ç”Ÿå· stu_id ç¡®å®šåˆ™ç³» stu_dept ç¡®å®šï¼Œç³» stu_dept åˆ™ç³»ä¸»ä»» dean ç¡®å®šã€‚ä½ æ€è€ƒå‘ç°ï¼šç³»ä¸»ä»» dean ä¼ é€’ä¾èµ–äºå­¦ç”Ÿå· stu_idï¼Œå†æ¬¡æ”¹è¿›äº†å…³ç³»æ¨¡å‹ï¼Œåˆ†æ‹†ä¸ºä¸‰ä¸ªè¡¨æè¿°ï¼Œå¦‚ä¸‹ï¼š ä¸‰èŒƒå¼ äºæ˜¯åˆå‡å°‘äº†å½•å…¥æä¸»ä»»çš„å·¥ä½œã€‚ ","date":"2022-11-29","objectID":"/3nf/:0:0","tags":["é¢è¯•","ä¸‰èŒƒå¼"],"title":"ä¸‰èŒƒå¼","uri":"/3nf/"},{"categories":["åˆ·é¢˜"],"content":"å­¦ä¹ ä¹‹è”é€šæ²ƒéŸ³ä¹","date":"2022-11-16","objectID":"/study-of-liantong/","tags":["é¢è¯•"],"title":"å­¦ä¹ ä¹‹è”é€šæ²ƒéŸ³ä¹","uri":"/study-of-liantong/"},{"categories":["åˆ·é¢˜"],"content":"æœ¬æ–‡ä¸»è¦æ‘˜è”é€šæ²ƒéŸ³ä¹çš„ä¸€äº›é¢˜ç›®ï¼Œä»¥ä¾¿åç»­æŸ¥é˜…å¤ä¹  ğŸ˜‹ã€‚ ","date":"2022-11-16","objectID":"/study-of-liantong/:0:0","tags":["é¢è¯•"],"title":"å­¦ä¹ ä¹‹è”é€šæ²ƒéŸ³ä¹","uri":"/study-of-liantong/"},{"categories":["åˆ·é¢˜"],"content":"shell é¢˜ç›® ","date":"2022-11-16","objectID":"/study-of-liantong/:1:0","tags":["é¢è¯•"],"title":"å­¦ä¹ ä¹‹è”é€šæ²ƒéŸ³ä¹","uri":"/study-of-liantong/"},{"categories":["åˆ·é¢˜"],"content":"ç¬¬ 1 é¢˜ å¦‚ä½•æŠŠæ–‡ä»¶ a.txt èµ‹æƒä¸º755ï¼Œå¦å¤–è§£é‡Š 755 æ˜¯ä»€ä¹ˆæƒé™ï¼Ÿ ç­”æ¡ˆ chmod 755 a.txt å…·ä½“çš„æƒé™æ˜¯ç”±æ•°å­—æ¥è¡¨ç¤ºçš„ è¯»å–çš„æƒé™ç­‰äº 4ï¼Œç”¨ r è¡¨ç¤ºï¼› å†™å…¥çš„æƒé™ç­‰äº 2ï¼Œç”¨ w è¡¨ç¤ºï¼› æ‰§è¡Œçš„æƒé™ç­‰äº 1ï¼Œç”¨ x è¡¨ç¤ºï¼› ä»¥ 755 ä¸ºä¾‹ï¼š 1-3 ä½ 7 ç­‰äº 4+2+1ï¼Œrwxï¼Œæ–‡ä»¶æ‰€æœ‰è€…å…·æœ‰è¯»å–ã€å†™å…¥ã€æ‰§è¡Œæƒé™ï¼› 4-6 ä½ 5 ç­‰äº 4+1+0ï¼Œr-xï¼ŒåŒç»„ç”¨æˆ·å…·æœ‰è¯»å–ã€æ‰§è¡Œæƒé™ä½†æ²¡æœ‰å†™å…¥æƒé™ï¼› 7-9 ä½ 5ï¼ŒåŒä¸Šï¼Œä¹Ÿæ˜¯ r-xï¼Œå…¶ä»–ç”¨æˆ·å…·æœ‰è¯»å–ã€æ‰§è¡Œæƒé™ä½†æ²¡æœ‰å†™å…¥æƒé™ã€‚ ","date":"2022-11-16","objectID":"/study-of-liantong/:1:1","tags":["é¢è¯•"],"title":"å­¦ä¹ ä¹‹è”é€šæ²ƒéŸ³ä¹","uri":"/study-of-liantong/"},{"categories":["åˆ·é¢˜"],"content":"ç¬¬ 2 é¢˜ å¦‚ä½•æŠŠæ–‡ä»¶ a.txt é‡å‘½åä¸º b.txt ç­”æ¡ˆ mv a.txt b.txt ","date":"2022-11-16","objectID":"/study-of-liantong/:1:2","tags":["é¢è¯•"],"title":"å­¦ä¹ ä¹‹è”é€šæ²ƒéŸ³ä¹","uri":"/study-of-liantong/"},{"categories":["åˆ·é¢˜"],"content":"ç¬¬ 3 é¢˜ å¦‚ä½•æŸ¥è¯¢åŒ…å« a.sh çš„æ‰€æœ‰è¿›ç¨‹ï¼Œå¹¶è¿›è¡Œæ‰¹é‡æ€è¿›ç¨‹ï¼Ÿ ç­”æ¡ˆ ä½¿ç”¨ awk æ‰¹é‡æ€è¿›ç¨‹çš„å‘½ä»¤ ps -ef | grep a.sh | grep -v grep | awk '{print \"kill -9 \"$2}'|sh è¯´æ˜ï¼š #åˆ—å‡ºäº†å½“å‰ä¸»æœºä¸­è¿è¡Œçš„è¿›ç¨‹ä¸­åŒ…å«a.shå…³é”®å­—çš„è¿›ç¨‹ ps -ef | grep a.sh | grep -v grep #åˆ—å‡ºäº†è¦killæ‰è¿™äº›è¿›ç¨‹çš„å‘½ä»¤ï¼Œå¹¶å°†ä¹‹æ‰“å°åœ¨äº†å±å¹•ä¸Š ps -ef | grep a.sh | grep -v grep | awk '{print \"kill -9 \"$2}' #åé¢åŠ ä¸Š|shåï¼Œåˆ™æ‰§è¡Œè¿™äº›å‘½ä»¤ï¼Œè¿›è€Œæ€æ‰äº†è¿™äº›è¿›ç¨‹ ps -ef | grep a.sh | grep -v grep | awk '{print \"kill -9 \"$2}' | sh ","date":"2022-11-16","objectID":"/study-of-liantong/:1:3","tags":["é¢è¯•"],"title":"å­¦ä¹ ä¹‹è”é€šæ²ƒéŸ³ä¹","uri":"/study-of-liantong/"},{"categories":["åˆ·é¢˜"],"content":"ç¬¬ 4 é¢˜ è¯·åˆ—ä¸¾ vi çš„ 6 ç§å‘½ååŠå…¶ç”¨é€” i: åœ¨å…‰æ ‡å‰æ’å†…å†…å®¹ x: åˆ é™¤å…‰æ ‡åé¢çš„å­—ç¬¦ yy: å¤åˆ¶æ•´è¡Œ :w ä¿å­˜ :q é€€å‡º :q! å¼ºåˆ¶é€€å‡º :w! å¼ºåˆ¶ä¿å­˜ ","date":"2022-11-16","objectID":"/study-of-liantong/:1:4","tags":["é¢è¯•"],"title":"å­¦ä¹ ä¹‹è”é€šæ²ƒéŸ³ä¹","uri":"/study-of-liantong/"},{"categories":["åˆ·é¢˜"],"content":"ç¬¬ 5 é¢˜ æ–‡ä»¶ a.txt åªæœ‰ä¸€åˆ—æ•°æ®ï¼Œè¯·è¿›è¡Œæ’åºå‰”é‡å¾—åˆ° b.txtï¼Ÿ a.txt b.txt 12 12 45 35 48 =\u003e 45 35 48 85 85 45 35 ç­”æ¡ˆ sort -u a.txt \u003e b.txt é»˜è®¤æ˜¯å‡åºï¼Œé™åºçš„è¯åŠ ä¸Š -r ","date":"2022-11-16","objectID":"/study-of-liantong/:1:5","tags":["é¢è¯•"],"title":"å­¦ä¹ ä¹‹è”é€šæ²ƒéŸ³ä¹","uri":"/study-of-liantong/"},{"categories":["åˆ·é¢˜"],"content":"ç¬¬ 6 é¢˜ è¯·å†™ä¸€ä¸ª shell å¾ªç¯å¾—åˆ° 1 åˆ° 100 çš„ç›¸åŠ ä¹‹å’Œã€‚ ç­”æ¡ˆ vim sum1_100.sh #!/bin/bash sum = 0 for i in {1..100} do let sum = sum + i done $echo $sum chmod +x sum1_100.sh sh sum1_100.sh æˆ–è€… ./sum1_100.sh ","date":"2022-11-16","objectID":"/study-of-liantong/:1:6","tags":["é¢è¯•"],"title":"å­¦ä¹ ä¹‹è”é€šæ²ƒéŸ³ä¹","uri":"/study-of-liantong/"},{"categories":["åˆ·é¢˜"],"content":"æ•°æ®åº“é¢˜ ","date":"2022-11-16","objectID":"/study-of-liantong/:2:0","tags":["é¢è¯•"],"title":"å­¦ä¹ ä¹‹è”é€šæ²ƒéŸ³ä¹","uri":"/study-of-liantong/"},{"categories":["åˆ·é¢˜"],"content":"ç¬¬ 7 é¢˜ ä»¥è¡¨ a ä½œä¸ºä¸»è¡¨ï¼Œå¤–è¿æ¥è¡¨ bï¼Œå¾—å‡ºè¡¨ cã€‚ æ•°æ®è¡¨ ç­”æ¡ˆ select a.id, a.Score1, coalesce(b.Score2, '') as Score2 from tab1 a left join tab2 b on a.id = b.id ","date":"2022-11-16","objectID":"/study-of-liantong/:2:1","tags":["é¢è¯•"],"title":"å­¦ä¹ ä¹‹è”é€šæ²ƒéŸ³ä¹","uri":"/study-of-liantong/"},{"categories":["åˆ·é¢˜"],"content":"ç¬¬ 8 é¢˜ å‚åŠ ä¸€ä¸ªæ´»åŠ¨ï¼Œè¡¨ a è®°å½•äº†æ´»åŠ¨çš„å¹´é¾„åŠè¯¥å¹´é¾„çš„äººæ•°ï¼Œç°éœ€è¦æ±‚å‡ºè¡¨ b å¹´é¾„åˆ†æ®µçš„äººæ•°ã€‚ æ•°æ®è¡¨ ç­”æ¡ˆ select case when age \u003e= 0 and age \u003c 10 then '[0,10)' when age \u003e= 10 and age \u003c 20 then '[10,20)' when age \u003e= 20 and age \u003c 30 then '[20,30)' when age \u003e= 30 then 'å¤§äº30' end as Age, sum(cnt) as Cnt from tab1 a group by 1 ","date":"2022-11-16","objectID":"/study-of-liantong/:2:2","tags":["é¢è¯•"],"title":"å­¦ä¹ ä¹‹è”é€šæ²ƒéŸ³ä¹","uri":"/study-of-liantong/"},{"categories":["åˆ·é¢˜"],"content":"ç¬¬ 9 é¢˜ è¡¨ a æœ‰å­¦ç”Ÿ id åŠå…¶æˆç»©ï¼Œç°åšæ’åå¾—å‡ºè¡¨ b æ•°æ®è¡¨ ç­”æ¡ˆ select a.id, a.Score, rank() over (order by Score desc) pm from tab1 a order by id ","date":"2022-11-16","objectID":"/study-of-liantong/:2:3","tags":["é¢è¯•"],"title":"å­¦ä¹ ä¹‹è”é€šæ²ƒéŸ³ä¹","uri":"/study-of-liantong/"},{"categories":["åˆ·é¢˜"],"content":"ç¬¬ 10 é¢˜ æ¯å¤© 1000 ä¸‡æ¡çš„æ•°æ®ï¼ˆæœ‰æ—¶é—´ï¼ˆå…·ä½“åˆ°ç§’ï¼‰ï¼Œå­—æ®µ2ï¼Œå­—æ®µ3ï¼Œå­—æ®µ4â€¦â€¦ï¼‰ä»å‰ç«¯å†™å…¥æ•°æ®åº“ï¼Œå¦‚ä½•è®¾ç½®è¡¨ç»“æ„ï¼Œå¯ä»¥å¿«é€Ÿçš„æŸ¥è¯¢åˆ° 2017å¹´3æœˆ11æ—¥20ç‚¹31åˆ†åˆ°32åˆ†çš„æ‰€æœ‰æ•°æ®ï¼Ÿ ç­”æ¡ˆ æ€è·¯æ˜¯æŠŠæ—¶é—´è¿›è¡Œæ‹†è§£ï¼ŒæŒ‰ç…§å¤©+å°æ—¶+åˆ†é’Ÿçš„æ ¼å¼ï¼Œç„¶åå¯¹æ—¶é—´å­—æ®µåŠ ä¸Šç´¢å¼•ï¼Œè¿™æ ·æŸ¥è¯¢çš„é€Ÿåº¦å°±ä¼šæå‡ã€‚ CREATE TABLE `tab1` ( `f_id` int(11) NOT NULL AUTO_INCREMENT COMMENT 'è‡ªå¢id', `f_date` varchar(64) NOT NULL DEFAULT '' COMMENT 'æ—¥æœŸ', `f_hour` varchar(64) NOT NULL DEFAULT '' COMMENT 'å°æ—¶', `f_min` varchar(64) NOT NULL DEFAULT '' COMMENT 'åˆ†é’Ÿ', å­—æ®µ2ï¼Œå­—æ®µ3.... `f_update_time` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP, PRIMARY KEY ( `f_id` ), KEY `all_index` (`f_date`, `f_hour`, `f_min`) ) ENGINE = InnoDB DEFAULT CHARSET = utf8 COMMENT = 'æ³¨é‡Š' ","date":"2022-11-16","objectID":"/study-of-liantong/:2:4","tags":["é¢è¯•"],"title":"å­¦ä¹ ä¹‹è”é€šæ²ƒéŸ³ä¹","uri":"/study-of-liantong/"},{"categories":["åˆ·é¢˜"],"content":"ç¬¬ 11 é¢˜ å¦‚ä¸‹å›¾ï¼šè¡¨ a æ˜¯è¥ä¸šå…ï¼Œæ‰€å±åŒºï¼Œåœ°å¸‚ï¼Œçœé”€å”®é‡‘é¢ï¼Œç°å¾—å‡ºè¡¨ b åŒºã€åœ°å¸‚å’Œå…¨çœæ±‡æ€» æ•°æ®è¡¨ ç­”æ¡ˆ select City, Area, sum(amt) as amt from tab1 group by 1,2 union all select 'å…¨çœ' as City, '' as Area, sum(amt) as amt from tab1 group by 1,2 union all select City as City, 'å…¨å¸‚' as Area, sum(amt) as amt from tab1 group by 1,2 ","date":"2022-11-16","objectID":"/study-of-liantong/:2:5","tags":["é¢è¯•"],"title":"å­¦ä¹ ä¹‹è”é€šæ²ƒéŸ³ä¹","uri":"/study-of-liantong/"},{"categories":["åˆ·é¢˜"],"content":"ç¬¬ 12 é¢˜ è¡¨ a å­—æ®µæ˜¯ä»¥æ—¥æœŸä½œä¸ºåˆ†åŒºè¡¨ï¼Œæœ‰æ—¥æœŸã€ç”¨æˆ·idã€äº§å“idï¼Œä½¿ç”¨çš„æ—¶é—´è¯¦ç»†æ—¶é—´ï¼Œæ¯å¤©æœ‰ 50 äº¿æ¡æ•°æ®ï¼Œå³ 31 å¤©æ€»æ•°æ®ä¸º 1550 äº¿ã€‚éœ€è¦æ¯å¤©å¾—åˆ°ä¸€ä¸ªè¡¨ bï¼Œä»¥ b è¡¨çš„æ—¥æœŸã€äº§å“idä¸ºè”åˆæ±‡æ€»ï¼Œç®—å‡º 1 å·åˆ°å½“å‰çš„æ—¥æœŸçš„ pv å’Œ uvã€‚ä½† Hadoop é›†ç¾¤åªèƒ½è®¡ç®— 100 äº¿æ•°æ®ï¼Œå¦‚ä½•é€šè¿‡é€»è¾‘æ–¹å¼è®¡ç®—è¯·å†™å‡ºå…·ä½“ sqlã€‚ç­”æ¡ˆéœ€è¦è€ƒè™‘é›†ç¾¤çš„è®¡ç®—èƒ½åŠ›ï¼Œæç¤ºæ¯å¤©æ–°å¢çš„ç”¨æˆ·å¤§æ¦‚ 3 åƒä¸‡ã€‚ æ•°æ®è¡¨ ç­”æ¡ˆ insert overwrite table tab_with_pv partition(static_dat='è®¡ç®—æ—¥') select static_dat, product_id, count(user_id) pv from tab1 where static_dat = 'è®¡ç®—æ—¥' group by 1,2 pv çš„è®¡ç®— select static_dat, product_id, sum(pv) pv from tab_with_pv where substr(static_dat,1,6) = 'è®¡ç®—æœˆ' and static_dat \u003c= 'è®¡ç®—æ—¥' group by 1,2 tab_with_user è¿™ä¸ªè¡¨éœ€è¦åŠ ä¸Šè‡ªä¾èµ– insert overwrite table tab_with_user partition(static_dat='è®¡ç®—æ—¥') select distinct static_dat, product_id, user_id from tab_with_user where static_dat = 'è®¡ç®—æ—¥' union select distinct static_dat, product_id, user_id from tab_with_user where static_dat = 'è®¡ç®—æ—¥å‰ä¸€æ—¥' and substr(static_dat,1,6) = 'è®¡ç®—æœˆ' uv çš„è®¡ç®— select static_dat, product_id, count(distinct user_id) uv from tab_with_user where static_dat = 'è®¡ç®—æ—¥' æœ€åæŠŠ pv å’Œ uv çš„æ•°æ®æ‹¼æ¥åœ¨ä¸€èµ·å³å¯ã€‚ ","date":"2022-11-16","objectID":"/study-of-liantong/:2:6","tags":["é¢è¯•"],"title":"å­¦ä¹ ä¹‹è”é€šæ²ƒéŸ³ä¹","uri":"/study-of-liantong/"},{"categories":["åˆ·é¢˜"],"content":"JAVAé¢˜ç›® ","date":"2022-11-16","objectID":"/study-of-liantong/:3:0","tags":["é¢è¯•"],"title":"å­¦ä¹ ä¹‹è”é€šæ²ƒéŸ³ä¹","uri":"/study-of-liantong/"},{"categories":["åˆ·é¢˜"],"content":"ç¬¬ 13 é¢˜ ç”¨ä»£ç æˆ–ä¼ªä»£ç å®ç°ä¸€ä¸ª java é™æµå·¥å…·ç±»ï¼ˆè¯´æ˜ï¼šè°ƒç”¨å…³ç³»ä¸ºæˆ‘æ–¹ç³»ç»Ÿè°ƒç”¨å¯¹æ–¹ç³»ç»Ÿï¼Œæˆ‘æ–¹ç³»ç»Ÿè°ƒç”¨é¢‘æ¬¡ä¸èƒ½å¤§äºå¯¹æ–¹ç³»ç»Ÿçš„é™åˆ¶ï¼Œå¦‚ï¼šé˜¿é‡Œäº‘é™åˆ¶æˆ‘æ–¹æ¯ç§’è°ƒç”¨ä¸èƒ½å¤§äº1000æ¬¡ï¼‰ã€‚ ç­”æ¡ˆ public class RateLimiterSimpleWindow { // é˜ˆå€¼ private static Integer QPS = 2; // æ—¶é—´çª—å£ï¼ˆæ¯«ç§’ï¼‰ private static long TIME_WINDOWS = 1000; // è®¡æ•°å™¨ private static AtomicInteger REQ_COUNT = new AtomicInteger(); private static long START_TIME = System.currentTimeMillis(); public synchronized static boolean tryAcquire() { if ((System.currentTimeMillis() - START_TIME) \u003e TIME_WINDOWS) { REQ_COUNT.set(0); START_TIME = System.currentTimeMillis(); } return REQ_COUNT.incrementAndGet() \u003c= QPS; } public static void main(String[] args) throws InterruptedException { for (int i = 0; i \u003c 10; i++) { Thread.sleep(250); LocalTime now = LocalTime.now(); if (!tryAcquire()) { System.out.println(now + \" è¢«é™æµ\"); } else { System.out.println(now + \" åšç‚¹ä»€ä¹ˆ\"); } } ","date":"2022-11-16","objectID":"/study-of-liantong/:3:1","tags":["é¢è¯•"],"title":"å­¦ä¹ ä¹‹è”é€šæ²ƒéŸ³ä¹","uri":"/study-of-liantong/"},{"categories":["åˆ·é¢˜"],"content":"ç¬¬ 14 é¢˜ å‡è®¾åœ¨ 5 å° linux æœåŠ¡å™¨ä¸Šæˆ‘ä»¬éƒ¨ç½²äº† 5 ä¸ªåº”ç”¨å®ä¾‹ï¼ˆå¤–éƒ¨è®¿é—®é»˜è®¤é€šè¿‡ ngix è´Ÿè½½ï¼‰ï¼Œè¯¥åº”ç”¨æ¶‰åŠåˆ°æ–‡ä»¶çš„ä¸Šä¼ å’Œä¸‹è½½ï¼Œä½ ä¼šå¦‚ä½•è®¾è®¡ï¼Œä¿è¯ç”¨æˆ·ä¸Šä¼ æ–‡ä»¶å’Œä¸‹è½½æ–‡ä»¶æ—¶ä¸ä¼šå‡ºç°å¼‚å¸¸é—®é¢˜ï¼ŒåŒæ—¶ä¹Ÿéœ€è¦ä¿è¯å­˜å‚¨æ•°æ®è®¿é—®çš„å®‰å…¨æ€§ï¼ˆå‡è®¾ä¸èƒ½ä½¿ç”¨å¯¹è±¡å­˜å‚¨æœåŠ¡ï¼‰ã€‚ ","date":"2022-11-16","objectID":"/study-of-liantong/:3:2","tags":["é¢è¯•"],"title":"å­¦ä¹ ä¹‹è”é€šæ²ƒéŸ³ä¹","uri":"/study-of-liantong/"},{"categories":["åˆ·é¢˜"],"content":"Pythoné¢˜ç›® ","date":"2022-11-16","objectID":"/study-of-liantong/:4:0","tags":["é¢è¯•"],"title":"å­¦ä¹ ä¹‹è”é€šæ²ƒéŸ³ä¹","uri":"/study-of-liantong/"},{"categories":["åˆ·é¢˜"],"content":"ç¬¬ 15 é¢˜ ç°æœ‰ä¸€ä¸ª dataframe å¯¹è±¡ dfï¼Œå¦‚ä¸‹ï¼š name age sex score zhangsan 10 50 lisi å¥³ 60 12 ç”· 90 chenyi 11 å¥³ chenhai 9 64 è¯·åˆ†åˆ«å†™å‡ºç›¸å…³ä»£ç ï¼š ï¼ˆ1ï¼‰å°†æ€§åˆ« sex ä¸ºç©ºçš„ä½¿ç”¨ç”·æ¥æ›¿ä»£ï¼›å°† name ä¸ºç©ºçš„è®°å½•åˆ é™¤ï¼›å°† ageã€score åˆ—ä¸ºç©ºçš„åˆ†åˆ«ä½¿ç”¨æ”¹åˆ—å¹³å‡å€¼æ›¿ä»£ã€‚ df[\"sex\"].fillna(\"ç”·\", inplace = True) # å°†æ€§åˆ« sex ä¸ºç©ºçš„ä½¿ç”¨ç”·æ¥æ›¿ä»£ df[\"name\"].dropna() # å°† name ä¸ºç©ºçš„è®°å½•åˆ é™¤ age_mean = df[\"age\"].mean() score_mean = df[\"score\"].mean() df[\"age\"].fillna(age_mean, inplace = True) df[\"score\"].fillna(score_mean, inplace = True) ï¼ˆ2ï¼‰å®Œæˆ 2.1 æ•°æ®åï¼Œå¯¹æ€§åˆ«è¿›è¡Œåˆ†ç»„æ±‡æ€»ï¼Œå¾—å‡ºæ¯ä¸ªæ€§åˆ«çš„ score æ±‡æ€»å¾—åˆ†ã€‚ df.groupby(\"sex\").agg({\"score\":\"sum\"}) ï¼ˆ3ï¼‰æ‰¾å‡ºåˆ†æ•°å¤§äºå¹³å‡åˆ†çš„è®°å½•ï¼Œå¹¶è¾“å‡º name å’Œ score df[df[\"score\"] \u003e df[\"score\"].mean()][[\"name\",\"score\"]] ","date":"2022-11-16","objectID":"/study-of-liantong/:4:1","tags":["é¢è¯•"],"title":"å­¦ä¹ ä¹‹è”é€šæ²ƒéŸ³ä¹","uri":"/study-of-liantong/"},{"categories":["å­¦ä¹ "],"content":"å­¦ä¹ ä¹‹åŸºç¡€çŸ¥è¯†ç¯‡","date":"2022-11-08","objectID":"/study-of-interview/","tags":["é¢è¯•","åŸºç¡€"],"title":"å­¦ä¹ ä¹‹åŸºç¡€çŸ¥è¯†ç¯‡","uri":"/study-of-interview/"},{"categories":["å­¦ä¹ "],"content":"æœ¬æ–‡ä¸»è¦æ‘˜æŠ„ä¸€äº›é¢è¯•è¿‡ç¨‹å¯èƒ½ä¼šé‡åˆ°çš„ä¸€äº›åŸºç¡€çŸ¥è¯†é—®é¢˜ï¼Œä»¥ä¾¿åç»­æŸ¥é˜…å¤ä¹ ã€‚ ","date":"2022-11-08","objectID":"/study-of-interview/:0:0","tags":["é¢è¯•","åŸºç¡€"],"title":"å­¦ä¹ ä¹‹åŸºç¡€çŸ¥è¯†ç¯‡","uri":"/study-of-interview/"},{"categories":["å­¦ä¹ "],"content":"Linuxæ“ä½œç³»ç»Ÿå¸¸ç”¨å‘½ä»¤ ä½¿ç”¨ shell å‘½ä»¤æŸ¥çœ‹è·¯å¾„ä¸‹çš„æ–‡ä»¶å¤§å°å’Œå±æ€§ ç­”æ¡ˆ ls -lrth ä½¿ç”¨s hell å‘½ä»¤æ‰¾å‡ºè·¯å¾„ä¸‹å¸¦æœ‰å…³é”®å­— â€œtestâ€ çš„ go è¯­è¨€æ–‡ä»¶ ç­”æ¡ˆ find . -name \"*.go\"|xargs grep \"test\" æŸ¥çœ‹æœåŠ¡å™¨çš„è¿›ç¨‹èµ„æºä½¿ç”¨æƒ…å†µ ç­”æ¡ˆ top ä½¿ç”¨ shell å‘½ä»¤æŸ¥çœ‹æœåŠ¡ç›‘å¬ 80 ç«¯å£çš„è¿›ç¨‹ id ç­”æ¡ˆ netstat -anp|grep EST|grep 80 ","date":"2022-11-08","objectID":"/study-of-interview/:1:0","tags":["é¢è¯•","åŸºç¡€"],"title":"å­¦ä¹ ä¹‹åŸºç¡€çŸ¥è¯†ç¯‡","uri":"/study-of-interview/"},{"categories":["å­¦ä¹ "],"content":"æ•°ä»“ä¹‹SQLç¯‡","date":"2022-11-07","objectID":"/study-of-sql/","tags":["æ•°ä»“","SQL"],"title":"æ•°ä»“ä¹‹SQLç¯‡","uri":"/study-of-sql/"},{"categories":["å­¦ä¹ "],"content":"æœ¬æ–‡ä¸»è¦æ‘˜æŠ„æ•°ä»“ä¸­çš„ä¸€äº› SQL é—®é¢˜ï¼ŒåŒ…æ‹¬ä¸€äº›å¸¸ç”¨çš„è¯­æ³•å’Œç»ƒä¹ é¢˜ï¼Œä»¥ä¾¿åç»­æŸ¥é˜…å¤ä¹ ã€‚ ","date":"2022-11-07","objectID":"/study-of-sql/:0:0","tags":["æ•°ä»“","SQL"],"title":"æ•°ä»“ä¹‹SQLç¯‡","uri":"/study-of-sql/"},{"categories":["å­¦ä¹ "],"content":"å¹³å‡æ´»è·ƒå¤©æ•°å’Œæœˆæ´»äººæ•° ç”¨æˆ·åœ¨ç‰›å®¢è¯•å·ä½œç­”åŒºä½œç­”è®°å½•å­˜å‚¨åœ¨è¡¨ exam_record ä¸­ï¼Œå†…å®¹å¦‚ä¸‹ï¼š exam_recordè¡¨ï¼ˆuid ç”¨æˆ· ID, exam_id è¯•å· ID, start_time å¼€å§‹ä½œç­”æ—¶é—´, submit_time äº¤å·æ—¶é—´, score å¾—åˆ†ï¼‰ id uid exam_id start_time submit_time score 1 1001 9001 2021-07-02 09:01:01 2021-07-02 09:21:01 80 2 1002 9001 2021-09-05 19:01:01 2021-09-05 19:40:01 81 3 1002 9002 2021-09-02 12:01:01 (NULL) (NULL) 4 1002 9003 2021-09-01 12:01:01 (NULL) (NULL) 5 1002 9001 2021-07-02 19:01:01 2021-07-02 19:30:01 82 6 1002 9002 2021-07-05 18:01:01 2021-07-05 18:59:02 90 7 1003 9002 2021-07-06 12:01:01 (NULL) (NULL) 8 1003 9003 2021-09-07 10:01:01 2021-09-07 10:31:01 86 9 1004 9003 2021-09-06 12:01:01 (NULL) (NULL) 10 1002 9003 2021-09-01 12:01:01 2021-09-01 12:31:01 81 11 1005 9001 2021-09-01 12:01:01 2021-09-01 12:31:01 88 12 1006 9002 2021-09-02 12:11:01 2021-09-02 12:31:01 89 13 1007 9002 2020-09-02 12:11:01 2020-09-02 12:31:01 89 è¯·è®¡ç®— 2021 å¹´æ¯ä¸ªæœˆé‡Œè¯•å·ä½œç­”åŒºç”¨æˆ·å¹³å‡æœˆæ´»è·ƒå¤©æ•° avg_active_days å’Œæœˆåº¦æ´»è·ƒäººæ•° mauï¼Œä¸Šé¢æ•°æ®çš„ç¤ºä¾‹è¾“å‡ºå¦‚ä¸‹ï¼š month avg_active_days mau 202107 1.50 2 202109 1.25 4 æ€è·¯ å¯¹äºç”¨æˆ·å¹³å‡æ´»è·ƒå¤©æ•°ï¼Œåˆ™éœ€è¦å¾—åˆ°ç”¨æˆ·çš„æ€»æ´»è·ƒå¤©æ•°å’Œä¸åŒçš„ç”¨æˆ·æ•°ã€‚ä¸åŒçš„ç”¨æˆ·æ•°å’Œæœˆæ´»çš„æ±‚è§£æ–¹å¼ä¸€æ ·ï¼Œæ€»æ´»è·ƒå¤©æ•°åˆ™éœ€è¦åŒæ—¶è¯»ç”¨æˆ·å’Œæ—¥æœŸè¿›è¡Œå»é‡ï¼Œå› ä¸ºå¦‚æœåŒä¸€å¤©æœ‰å¤šä¸ªç”¨æˆ·æ´»è·ƒï¼Œåˆ™æœ€ç»ˆçš„æ€»æ´»è·ƒå¤©æ•°ä¸­æ˜¯ä¼šè®¡ç®—å¤šå¤©çš„ã€‚ select date_format(submit_time,'%Y%m') month, round(count(distinct uid,date_format(submit_time,'%Y%m%d'))/count(distinct uid),2) avg_active_days, count(distinct uid) mau from exam_record where year(submit_time)=2021 group by month; ","date":"2022-11-07","objectID":"/study-of-sql/:1:0","tags":["æ•°ä»“","SQL"],"title":"æ•°ä»“ä¹‹SQLç¯‡","uri":"/study-of-sql/"},{"categories":["å­¦ä¹ "],"content":"æ¯å¤©çš„æ—¥æ´»æ•°åŠæ–°ç”¨æˆ·å æ¯” ç”¨æˆ·è¡Œä¸ºæ—¥å¿—è¡¨ tb_user_logï¼ˆuid-ç”¨æˆ·ID, artical_id-æ–‡ç« ID, in_time-è¿›å…¥æ—¶é—´, out_time-ç¦»å¼€æ—¶é—´, sign_in-æ˜¯å¦ç­¾åˆ°ï¼‰ id uid artical_id in_time out_time sign_cin 1 101 9001 2021-10-31 10:00:00 2021-10-31 10:00:09 0 2 102 9001 2021-10-31 10:00:00 2021-10-31 10:00:09 0 3 101 0 2021-11-01 10:00:00 2021-11-01 10:00:42 1 4 102 9001 2021-11-01 10:00:00 2021-11-01 10:00:09 0 5 108 9001 2021-11-01 10:00:01 2021-11-01 10:00:50 0 6 108 9001 2021-11-02 10:00:01 2021-11-02 10:00:50 0 7 104 9001 2021-11-02 10:00:28 2021-11-02 10:00:50 0 8 106 9001 2021-11-02 10:00:28 2021-11-02 10:00:50 0 9 108 9001 2021-11-03 10:00:01 2021-11-03 10:00:50 0 10 109 9002 2021-11-03 11:00:55 2021-11-03 11:00:59 0 11 104 9003 2021-11-03 11:00:45 2021-11-03 11:00:55 0 12 105 9003 2021-11-03 11:00:53 2021-11-03 11:00:59 0 13 106 9003 2021-11-03 11:00:45 2021-11-03 11:00:55 0 é—®é¢˜ï¼šç»Ÿè®¡æ¯å¤©çš„æ—¥æ´»æ•°åŠæ–°ç”¨æˆ·å æ¯” æ³¨ï¼š æ–°ç”¨æˆ·å æ¯” = å½“å¤©çš„æ–°ç”¨æˆ·æ•° Ã· å½“å¤©æ´»è·ƒç”¨æˆ·æ•°ï¼ˆæ—¥æ´»æ•°ï¼‰ã€‚ å¦‚æœin_time-è¿›å…¥æ—¶é—´å’Œout_time-ç¦»å¼€æ—¶é—´è·¨å¤©äº†ï¼Œåœ¨ä¸¤å¤©é‡Œéƒ½è®°ä¸ºè¯¥ç”¨æˆ·æ´»è·ƒè¿‡ã€‚ æ–°ç”¨æˆ·å æ¯”ä¿ç•™2ä½å°æ•°ï¼Œç»“æœæŒ‰æ—¥æœŸå‡åºæ’åºã€‚ è¾“å‡ºç¤ºä¾‹ï¼š ç¤ºä¾‹æ•°æ®çš„è¾“å‡ºç»“æœå¦‚ä¸‹ dt dau uv_new_ratio 2021-10-30 2 1.00 2021-11-01 3 0.33 2021-11-02 3 0.67 2021-11-03 5 0.40 æ€è·¯1 æ—¥æ´»å°±æ˜¯æ¯å¤©è®¿é—®çš„ä¸åŒç”¨æˆ·æ•°ï¼Œæ‰€ä»¥æˆ‘ä»¬é¦–å…ˆè¦å¾—åˆ°ä¸€å¼ ç™»å½•è¡¨ï¼Œç™»å½•è¡¨è®°å½•äº†æ¯å¤©ç™»å½•çš„ç”¨æˆ·ï¼Œå¹¶æŒ‰å¤©å¯¹ç”¨æˆ·è¿›è¡Œäº†å»é‡ï¼Œä¹Ÿå°±æ˜¯ä¸‹é¢çš„ t1ã€‚è€Œè¦ç»Ÿè®¡æ–°ç”¨æˆ·çš„å æ¯”ï¼Œæˆ‘ä»¬å°±éœ€è¦è¯†åˆ«æ¯å¤©ç™»å½•ç”¨æˆ·ä¸­å“ªäº›ç”¨æˆ·æ˜¯æ–°ç”¨æˆ·ï¼ˆå³ç¬¬ä¸€æ¬¡ç™»å½•ï¼‰ã€‚ä¸€ä¸ªå¯è¡Œçš„æ€è·¯æ˜¯ï¼Œä½¿ç”¨çª—å£å‡½æ•°å¯¹æ¯ä¸ªç”¨æˆ·çš„ç™»å½•æ—¥æœŸè¿›è¡Œæ’åºå¾—åˆ°ä¸‹é¢çš„ t2ã€‚ç»Ÿè®¡çš„æ—¶å€™è¿›è¡Œåˆ¤æ–­ï¼Œå¦‚æœç»Ÿè®¡å½“å¤©è¯¥ç”¨æˆ·çš„åºå·ä¸º 1ï¼Œåˆ™è¡¨ç¤ºç”¨æˆ·ä»Šå¤©æ˜¯ç¬¬ä¸€æ¬¡ç™»å½•ï¼Œå³ä¸ºæ–°ç”¨æˆ·ã€‚ with t1 as ( # ç”¨æˆ·ç™»å½•è¡¨ï¼Œè®°å½•äº†ç”¨æˆ· id å’Œç™»å½•æ—¶é—´ï¼Œå¯¹æ¯å¤©çš„ç™»å½•ç”¨æˆ·è¿›è¡Œäº†å»é‡ select uid, date(in_time) dt from tb_user_log union # union å®ç°å»é‡ï¼Œunion all ä¸å»é‡ select uid, date(out_time) dt from tb_user_log ), t2 as ( # å¯¹æ¯ä¸ªç”¨æˆ·çš„ç™»å½•æ—¥æœŸè¿›è¡Œæ’åºï¼Œæ³¨å†Œæ—¥æœŸçš„åºå·æ˜¯ 1 select uid,dt, row_number() over(partition by uid order by dt) rn from t1 ) # è·å¾—ç­”æ¡ˆ select dt, count(uid) dau, round(sum(if(rn=1, 1, 0))/count(uid),2) uv_new_ration from t2 group by dt order by dt; æ€è·¯2 åŒæ ·çš„æ€è·¯å¾—åˆ°ç”¨æˆ·ç™»å½•è¡¨ t1ã€‚æ¯ä¸ªç”¨æˆ·çš„æ³¨å†Œæ—¥æœŸè‚¯å®šåœ¨ç™»å½•è¡¨ä¸­æ˜¯æœ€å°çš„ï¼Œå› æ­¤ç”¨ min å‡½æ•°å¯ä»¥å¾—åˆ°ç”¨æˆ·ç™»å½•è¡¨å³ä¸‹é¢çš„ t2ã€‚æœ€ååœ¨æ±‚è§£ç­”æ¡ˆçš„æ—¶å€™ï¼Œç”¨ t1 left join t2ï¼Œå…³è”çš„å­—æ®µæ˜¯ uid ä»¥åŠæ—¥æœŸï¼Œç”±äºä½¿ç”¨äº† left joinï¼Œt1 ä¸­æ¯ä¸ªç”¨æˆ·æ‰€æœ‰çš„ç™»å½•æ—¥æœŸéƒ½å¾—åˆ°äº†ä¿ç•™ï¼Œcount è®¡æ•°å³å¯å¾—åˆ° dauï¼Œè€Œ t2 è¡¨ä¸­ä¸æ˜¯å½“å¤©æ³¨å†Œçš„ç”¨æˆ· uid å’Œ reg_dt éƒ½ä¸º nullï¼ŒåŒæ ·ä½¿ç”¨ count è®¡æ•°å°±èƒ½å¾—åˆ°å½“å¤©çš„æ–°ç”¨æˆ·ã€‚ with t1 as ( # ç”¨æˆ·ç™»å½•è¡¨ï¼Œè®°å½•äº†ç”¨æˆ· id å’Œç™»å½•æ—¶é—´ï¼Œå¯¹æ¯å¤©çš„ç™»å½•ç”¨æˆ·è¿›è¡Œäº†å»é‡ select uid, date(in_time) dt from tb_user_log union select uid, date(out_time) dt from tb_user_log ), t2 as ( # å¾—åˆ°ç”¨æˆ·æ³¨å†Œè¡¨ select uid, min(dt) reg_dt from t1 group by uid ) select dt, count(t1.uid) dau, round(count(t2.uid)/count(t1.uid),2) uv_new_ration from t1 left join t2 on t1.uid = t2.uid and t1.dt = t2.reg_dt group by dt order by dt; ","date":"2022-11-07","objectID":"/study-of-sql/:2:0","tags":["æ•°ä»“","SQL"],"title":"æ•°ä»“ä¹‹SQLç¯‡","uri":"/study-of-sql/"},{"categories":["å­¦ä¹ "],"content":"ç”¨æˆ·ç•™å­˜åˆ†æ næ—¥ç•™å­˜ç‡ = ç¬¬ n å¤©è¿˜åœ¨ç™»å½•çš„ç”¨æˆ·æ•°/æ–°å¢çš„ç”¨æˆ·æ•°ï¼Œå‡å¦‚æŸæ—¥æ–°å¢äº† 100 ä¸ªç”¨æˆ·ï¼Œç¬¬äºŒå¤©ç™»å½•äº† 50 ä¸ªï¼Œåˆ™æ¬¡æ—¥ç•™å­˜ç‡ä¸º 50/100 = 50%ï¼Œç¬¬ä¸‰å¤©ç™»å½•äº† 30 ä¸ªï¼Œåˆ™ç¬¬äºŒæ—¥ç•™å­˜ç‡ä¸º 30/100 = 30%ï¼Œä»¥æ­¤ç±»æ¨ï¼Œç¬¬ 7 å¤©ç™»å½•äº† 10 ä¸ªç”¨æˆ·ï¼Œåˆ™ 7 æ—¥ç•™å­˜ç‡å°±æ˜¯ 10/100 = 10%ã€‚ é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦è®¡ç®—å‡ºæ¯ä¸ªuserçš„é¦–æ¬¡ç™»å½•æ—¥æœŸï¼Œä¹Ÿå°±æ˜¯ä¸‹é¢çš„ä»£ç ã€‚ SELECT user_id, MIN(log_date) AS first_log_date FROM user_log GROUP BY user_id ç„¶åï¼Œæˆ‘ä»¬å’Œ user_log è¡¨è¿›è¡Œå…³è”ä¹‹åå†è¿›è¡Œæ—¥æœŸå·®çš„è®¡ç®—ï¼Œè¿™å°±å¾—åˆ°äº†æŸä¸€å¤©ç™»å½•ç¦»ç¬¬ä¸€æ¬¡ç™»å½•æœ‰å¤šé•¿æ—¶é—´ã€‚ --ç”¨æˆ·ç•™å­˜è®¡ç®— SELECT first_log_date, SUM(CASE WHEN t3.diff_days = 0 THEN 1 ELSE 0 END) AS day_0, SUM(CASE WHEN t3.diff_days = 1 THEN 1 ELSE 0 END) AS day_1, SUM(CASE WHEN t3.diff_days = 2 THEN 1 ELSE 0 END) AS day_2, SUM(CASE WHEN t3.diff_days = 3 THEN 1 ELSE 0 END) AS day_3, SUM(CASE WHEN t3.diff_days = 4 THEN 1 ELSE 0 END) AS day_4, SUM(CASE WHEN t3.diff_days = 5 THEN 1 ELSE 0 END) AS day_5, SUM(CASE WHEN t3.diff_days = 6 THEN 1 ELSE 0 END) AS day_6, SUM(CASE WHEN t3.diff_days = 7 THEN 1 ELSE 0 END) AS day_7 FROM ( SELECT t1.user_id, t2.first_log_date, DATEDIFF(DAY, t2.first_log_date, t1.log_date) AS diff_days FROM user_log AS t1 LEFT JOIN ( SELECT user_id, MIN(log_date) AS first_log_date FROM user_log GROUP BY user_id ) as t2 ON t1.user_id = t2.user_id ) AS t3 GROUP BY first_log_date ","date":"2022-11-07","objectID":"/study-of-sql/:3:0","tags":["æ•°ä»“","SQL"],"title":"æ•°ä»“ä¹‹SQLç¯‡","uri":"/study-of-sql/"},{"categories":["å­¦ä¹ "],"content":"æ•°ä»“ä¹‹å­¦æ— æ­¢å¢ƒ","date":"2022-11-03","objectID":"/study-of-all-life/","tags":["æ•°ä»“"],"title":"æ•°ä»“ä¹‹å­¦æ— æ­¢å¢ƒ","uri":"/study-of-all-life/"},{"categories":["å­¦ä¹ "],"content":"æœ¬æ–‡ä¸»è¦æ‘˜æŠ„æ•°ä»“é¢è¯•ä¸­çš„ä¸€äº›å¸¸è§é—®é¢˜ï¼Œä»¥ä¾¿åç»­æŸ¥é˜…å¤ä¹ ã€‚ ","date":"2022-11-03","objectID":"/study-of-all-life/:0:0","tags":["æ•°ä»“"],"title":"æ•°ä»“ä¹‹å­¦æ— æ­¢å¢ƒ","uri":"/study-of-all-life/"},{"categories":["å­¦ä¹ "],"content":"æ•°ä»“æ˜¯ä»€ä¹ˆï¼Ÿ æ•°æ®ä»“åº“æ˜¯ä¸€ä¸ªé¢å‘ä¸»é¢˜çš„ã€é›†æˆçš„ã€ç›¸å¯¹ç¨³å®šçš„ã€åæ˜ å†å²å˜åŒ–çš„æ•°æ®é›†åˆï¼Œç”¨äºæ”¯æŒç®¡ç†å†³ç­–ã€‚ ","date":"2022-11-03","objectID":"/study-of-all-life/:1:0","tags":["æ•°ä»“"],"title":"æ•°ä»“ä¹‹å­¦æ— æ­¢å¢ƒ","uri":"/study-of-all-life/"},{"categories":["å­¦ä¹ "],"content":"Hive æ˜¯ä»€ä¹ˆï¼Ÿ æ˜¯åŸºäº Hadoop çš„ä¸€ä¸ªæ•°æ®ä»“åº“å·¥å…·ï¼› å¯ä»¥å°†ç»“æ„åŒ–çš„æ•°æ®æ˜ å°„ä¸ºä¸€å¼ æ•°æ®åº“è¡¨ï¼› å¹¶æä¾› HQL(Hive SQL) æŸ¥è¯¢åŠŸèƒ½ï¼› åº•å±‚æ•°æ®æ˜¯å­˜å‚¨åœ¨ HDFS ä¸Šï¼› Hive çš„æœ¬è´¨æ˜¯å°† SQL è¯­å¥è½¬æ¢ä¸º MapReduceã€Tez æˆ–è€… spark ç­‰ä»»åŠ¡æ‰§è¡Œï¼› é€‚ç”¨äºç¦»çº¿çš„æ‰¹é‡æ•°æ®è®¡ç®—ã€‚ ","date":"2022-11-03","objectID":"/study-of-all-life/:2:0","tags":["æ•°ä»“"],"title":"æ•°ä»“ä¹‹å­¦æ— æ­¢å¢ƒ","uri":"/study-of-all-life/"},{"categories":["å­¦ä¹ "],"content":"ETL æ˜¯å“ªä¸‰ä¸ªå•è¯çš„ç¼©å†™ Extraction æå– Transformation è½¬æ¢ Loading åŠ è½½ ","date":"2022-11-03","objectID":"/study-of-all-life/:3:0","tags":["æ•°ä»“"],"title":"æ•°ä»“ä¹‹å­¦æ— æ­¢å¢ƒ","uri":"/study-of-all-life/"},{"categories":["å­¦ä¹ "],"content":"çŸ¥é“ç¬›å¡å°”ç§¯å—ï¼Ÿ æ ¹æ®ç¬›å¡å°”ç§¯çš„å®šä¹‰ï¼ŒJOIN çš„ä¸¤è¡¨ä¸­çš„ä»»æ„ä¸€è¡Œéƒ½ä¼šå½¢æˆä¸€ç»„å…³ç³»å¯¹ï¼Œå¦‚æœ A è¡¨æœ‰ N æ¡è®°å½•ï¼ŒB è¡¨æœ‰ M æ¡è®°å½•ï¼ŒA X B ä¼šç”Ÿäº§ N*M æ¡æ•°æ®ã€‚ 1 å¯ä»¥é€šè¿‡ CROSS JOIN æ¥å®ç°ç¬›å¡å°”ç§¯ select * from A cross join b å¦‚æœä¸æ”¯æŒ CROSS JOIN çš„æƒ…å†µä¸‹ï¼Œå¯ä»¥é‡‡ç”¨ select * from A join B on 1 = 1 çš„æ–¹å¼å®ç°ã€‚ ç¬¬äºŒç§æ–¹æ³•å¯èƒ½åœ¨è¯­æ³•æ£€æµ‹é˜¶æ®µå°±æŠ¥é”™ä¸æ”¯æŒï¼Œå¯ä»¥è½¬æˆå¦‚ä¸‹è¯­æ³• select * from (select * , '1' as flag from A) t1 on (select *, '1' as flag from B) t2 where t1.flag = t2.flag ","date":"2022-11-03","objectID":"/study-of-all-life/:4:0","tags":["æ•°ä»“"],"title":"æ•°ä»“ä¹‹å­¦æ— æ­¢å¢ƒ","uri":"/study-of-all-life/"},{"categories":["å­¦ä¹ "],"content":"shuffle ç”¨æ¥å¹²ä»€ä¹ˆï¼Ÿ ä¸ºäº†è®©ç›¸åŒçš„ key éƒ½åˆ°ä¸€ä¸ª reduce ä¸­è¿›è¡Œå¤„ç†ï¼Œreduce è¦å»æ¯ä¸ª map ä¸­æ‹‰å–æ•°æ®ï¼Œall-to-all çš„è¿‡ç¨‹ï¼Œè·¨åˆ†åŒºèšé›†ç›¸åŒçš„ keyã€‚ ","date":"2022-11-03","objectID":"/study-of-all-life/:5:0","tags":["æ•°ä»“"],"title":"æ•°ä»“ä¹‹å­¦æ— æ­¢å¢ƒ","uri":"/study-of-all-life/"},{"categories":["å­¦ä¹ "],"content":"æ•°æ®å€¾æ–œçš„åœºæ™¯ä¸è§£å†³æ–¹æ³• ","date":"2022-11-03","objectID":"/study-of-all-life/:6:0","tags":["æ•°ä»“"],"title":"æ•°ä»“ä¹‹å­¦æ— æ­¢å¢ƒ","uri":"/study-of-all-life/"},{"categories":["å­¦ä¹ "],"content":"å†…éƒ¨è¡¨å’Œå¤–éƒ¨è¡¨ ","date":"2022-11-03","objectID":"/study-of-all-life/:7:0","tags":["æ•°ä»“"],"title":"æ•°ä»“ä¹‹å­¦æ— æ­¢å¢ƒ","uri":"/study-of-all-life/"},{"categories":["å­¦ä¹ "],"content":"ç¦»çº¿æ•°ä»“æœ€å¤§çš„æŒ‘æˆ˜æ˜¯ä»€ä¹ˆï¼Œå¦‚ä½•å…‹æœçš„ï¼Œæ˜¯å¦æ²‰æ·€æ–¹æ³•è®º ","date":"2022-11-03","objectID":"/study-of-all-life/:8:0","tags":["æ•°ä»“"],"title":"æ•°ä»“ä¹‹å­¦æ— æ­¢å¢ƒ","uri":"/study-of-all-life/"},{"categories":["å­¦ä¹ "],"content":"å®æ—¶æ•°ä»“å¦‚ä½•ä¿éšœæ•°æ®è´¨é‡ï¼Œæœ‰å“ªäº›æ‰‹æ®µå’Œæ–¹å¼ å‚è€ƒé“¾æ¥ï¼šå¤§æ•°æ®SQLå¦‚ä½•å®ç°ç¬›å¡å°”ç§¯Â â†©ï¸ ","date":"2022-11-03","objectID":"/study-of-all-life/:9:0","tags":["æ•°ä»“"],"title":"æ•°ä»“ä¹‹å­¦æ— æ­¢å¢ƒ","uri":"/study-of-all-life/"},{"categories":["è¯—æ­Œ"],"content":"è¯—æ­Œä¹‹èŸèƒ","date":"2022-11-03","objectID":"/poetry-of-others/","tags":["å¼ è‹¥è™š"],"title":"è¯—æ­Œä¹‹èŸèƒ","uri":"/poetry-of-others/"},{"categories":["è¯—æ­Œ"],"content":"æœ¬æ–‡ä¸»è¦æ±‡æ€»ä¸€äº›è¯—äººçš„è‘—åè¯—ç¯‡ï¼Œè¿™äº›ä½œè€…ç•™ä¸‹çš„è¯—ç¯‡ä¸å¤šï¼Œä½†æ˜¯éƒ½æ˜¯éå¸¸ç»å…¸çš„ï¼Œæ¯”å¦‚å¼ è‹¥è™šçš„æ˜¥æ±ŸèŠ±æœˆå¤œã€‚ ","date":"2022-11-03","objectID":"/poetry-of-others/:0:0","tags":["å¼ è‹¥è™š"],"title":"è¯—æ­Œä¹‹èŸèƒ","uri":"/poetry-of-others/"},{"categories":["è¯—æ­Œ"],"content":"å¼ è‹¥è™š ","date":"2022-11-03","objectID":"/poetry-of-others/:1:0","tags":["å¼ è‹¥è™š"],"title":"è¯—æ­Œä¹‹èŸèƒ","uri":"/poetry-of-others/"},{"categories":["è¯—æ­Œ"],"content":"æ˜¥æ±ŸèŠ±æœˆå¤œ æ˜¥æ±Ÿæ½®æ°´è¿æµ·å¹³ï¼Œæµ·ä¸Šæ˜æœˆå…±æ½®ç”Ÿã€‚ æ»Ÿæ»Ÿéšæ³¢åƒä¸‡é‡Œï¼Œä½•å¤„æ˜¥æ±Ÿæ— æœˆæ˜ï¼ æ±Ÿæµå®›è½¬ç»•èŠ³ç”¸ï¼Œæœˆç…§èŠ±æ—çš†ä¼¼éœ°ï¼› ç©ºé‡Œæµéœœä¸è§‰é£ï¼Œæ±€ä¸Šç™½æ²™çœ‹ä¸è§ã€‚ æ±Ÿå¤©ä¸€è‰²æ— çº¤å°˜ï¼Œçšçšç©ºä¸­å­¤æœˆè½®ã€‚ æ±Ÿç•”ä½•äººåˆè§æœˆï¼Ÿæ±Ÿæœˆä½•å¹´åˆç…§äººï¼Ÿ äººç”Ÿä»£ä»£æ— ç©·å·²ï¼Œæ±Ÿæœˆå¹´å¹´æœ›ç›¸ä¼¼ã€‚ ä¸çŸ¥æ±Ÿæœˆå¾…ä½•äººï¼Œä½†è§é•¿æ±Ÿé€æµæ°´ã€‚ ç™½äº‘ä¸€ç‰‡å»æ‚ æ‚ ï¼Œé’æ«æµ¦ä¸Šä¸èƒœæ„ã€‚ è°å®¶ä»Šå¤œæ‰èˆŸå­ï¼Ÿä½•å¤„ç›¸æ€æ˜æœˆæ¥¼ï¼Ÿ å¯æ€œæ¥¼ä¸Šæœˆè£´å›ï¼Œåº”ç…§ç¦»äººå¦†é•œå°ã€‚ ç‰æˆ·å¸˜ä¸­å·ä¸å»ï¼Œæ£è¡£ç §ä¸Šæ‹‚è¿˜æ¥ã€‚ æ­¤æ—¶ç›¸æœ›ä¸ç›¸é—»ï¼Œæ„¿é€æœˆåæµç…§å›ã€‚ é¸¿é›é•¿é£å…‰ä¸åº¦ï¼Œé±¼é¾™æ½œè·ƒæ°´æˆæ–‡ã€‚ æ˜¨å¤œé—²æ½­æ¢¦è½èŠ±ï¼Œå¯æ€œæ˜¥åŠä¸è¿˜å®¶ã€‚ æ±Ÿæ°´æµæ˜¥å»æ¬²å°½ï¼Œæ±Ÿæ½­è½æœˆå¤è¥¿æ–œã€‚ æ–œæœˆæ²‰æ²‰è—æµ·é›¾ï¼Œç¢£çŸ³æ½‡æ¹˜æ— é™è·¯ã€‚ ä¸çŸ¥ä¹˜æœˆå‡ äººå½’ï¼Œè½æœˆæ‘‡æƒ…æ»¡æ±Ÿæ ‘ã€‚ ","date":"2022-11-03","objectID":"/poetry-of-others/:1:1","tags":["å¼ è‹¥è™š"],"title":"è¯—æ­Œä¹‹èŸèƒ","uri":"/poetry-of-others/"},{"categories":["è¯—æ­Œ"],"content":"ä»£ç­”é—ºæ¢¦è¿˜ å…³å¡å¹´åæ—©ï¼Œæ¥¼å°åˆ«æœ›è¿ã€‚ è¯•è¡«è‘—æš–æ°”ï¼Œå¼€é•œè§…æ˜¥æ™–ã€‚ ç‡•å…¥çª¥ç½—å¹•ï¼Œèœ‚æ¥ä¸Šç”»è¡£ã€‚ æƒ…å‚¬æ¡ƒæè‰³ï¼Œå¿ƒå¯„ç®¡å¼¦é£ã€‚ å¦†æ´—æœç›¸å¾…ï¼Œé£èŠ±æšä¸å½’ã€‚ æ¢¦é­‚ä½•å¤„å…¥ï¼Œå¯‚å¯‚æ©é‡æ‰‰ã€‚ ","date":"2022-11-03","objectID":"/poetry-of-others/:1:2","tags":["å¼ è‹¥è™š"],"title":"è¯—æ­Œä¹‹èŸèƒ","uri":"/poetry-of-others/"},{"categories":["è¯—æ­Œ"],"content":"è¯—æ­Œä¹‹æå•†éš","date":"2022-11-02","objectID":"/poetry-of-lishangyin/","tags":["æå•†éš"],"title":"è¯—æ­Œä¹‹æå•†éš","uri":"/poetry-of-lishangyin/"},{"categories":["è¯—æ­Œ"],"content":"æå•†éšï¼ˆçº¦813å¹´ï½çº¦858å¹´ï¼‰ï¼Œå­—ä¹‰å±±ï¼Œå·ç‰è°¿ç”Ÿï¼Œæ€€å·æ²³å†…ï¼ˆä»Šæ²³å—çœæ²é˜³å¸‚ï¼‰äººã€‚æ™šå”è‘—åè¯—äººï¼Œå’Œæœç‰§åˆç§°â€œå°ææœâ€ã€‚ ","date":"2022-11-02","objectID":"/poetry-of-lishangyin/:0:0","tags":["æå•†éš"],"title":"è¯—æ­Œä¹‹æå•†éš","uri":"/poetry-of-lishangyin/"},{"categories":["è¯—æ­Œ"],"content":"å¤œé›¨å¯„åŒ— å›é—®å½’æœŸæœªæœ‰æœŸï¼Œå·´å±±å¤œé›¨æ¶¨ç§‹æ± ã€‚ ä½•å½“å…±å‰ªè¥¿çª—çƒ›ï¼Œå´è¯å·´å±±å¤œé›¨æ—¶ã€‚ ","date":"2022-11-02","objectID":"/poetry-of-lishangyin/:1:0","tags":["æå•†éš"],"title":"è¯—æ­Œä¹‹æå•†éš","uri":"/poetry-of-lishangyin/"},{"categories":["è¯—æ­Œ"],"content":"æ— é¢˜Â·ç›¸è§æ—¶éš¾åˆ«äº¦éš¾ ç›¸è§æ—¶éš¾åˆ«äº¦éš¾ï¼Œä¸œé£æ— åŠ›ç™¾èŠ±æ®‹ã€‚ æ˜¥èš•åˆ°æ­»ä¸æ–¹å°½ï¼Œèœ¡ç‚¬æˆç°æ³ªå§‹å¹²ã€‚ æ™“é•œä½†æ„äº‘é¬“æ”¹ï¼Œå¤œåŸåº”è§‰æœˆå…‰å¯’ã€‚ è“¬å±±æ­¤å»æ— å¤šè·¯ï¼Œé’é¸Ÿæ®·å‹¤ä¸ºæ¢çœ‹ã€‚ ","date":"2022-11-02","objectID":"/poetry-of-lishangyin/:2:0","tags":["æå•†éš"],"title":"è¯—æ­Œä¹‹æå•†éš","uri":"/poetry-of-lishangyin/"},{"categories":["è¯—æ­Œ"],"content":"é”¦ç‘Ÿ é”¦ç‘Ÿæ— ç«¯äº”åå¼¦ï¼Œä¸€å¼¦ä¸€æŸ±æ€åå¹´ã€‚ åº„ç”Ÿæ™“æ¢¦è¿·è´è¶ï¼Œæœ›å¸æ˜¥å¿ƒæ‰˜æœé¹ƒã€‚ æ²§æµ·æœˆæ˜ç æœ‰æ³ªï¼Œè“ç”°æ—¥æš–ç‰ç”ŸçƒŸã€‚ æ­¤æƒ…å¯å¾…æˆè¿½å¿†ï¼Ÿåªæ˜¯å½“æ—¶å·²æƒ˜ç„¶ã€‚ ","date":"2022-11-02","objectID":"/poetry-of-lishangyin/:3:0","tags":["æå•†éš"],"title":"è¯—æ­Œä¹‹æå•†éš","uri":"/poetry-of-lishangyin/"},{"categories":["è¯—æ­Œ"],"content":"å«¦å¨¥ äº‘æ¯å±é£çƒ›å½±æ·±ï¼Œé•¿æ²³æ¸è½æ™“æ˜Ÿæ²‰ã€‚ å«¦å¨¥åº”æ‚”å·çµè¯ï¼Œç¢§æµ·é’å¤©å¤œå¤œå¿ƒã€‚ ","date":"2022-11-02","objectID":"/poetry-of-lishangyin/:4:0","tags":["æå•†éš"],"title":"è¯—æ­Œä¹‹æå•†éš","uri":"/poetry-of-lishangyin/"},{"categories":["è¯—æ­Œ"],"content":"ç™»ä¹æ¸¸åŸ å‘æ™šæ„ä¸é€‚ï¼Œé©±è½¦ç™»å¤åŸã€‚ å¤•é˜³æ— é™å¥½ï¼Œåªæ˜¯è¿‘é»„æ˜ã€‚ ","date":"2022-11-02","objectID":"/poetry-of-lishangyin/:5:0","tags":["æå•†éš"],"title":"è¯—æ­Œä¹‹æå•†éš","uri":"/poetry-of-lishangyin/"},{"categories":["è¯—æ­Œ"],"content":"è´¾ç”Ÿ å®£å®¤æ±‚è´¤è®¿é€è‡£ï¼Œè´¾ç”Ÿæ‰è°ƒæ›´æ— ä¼¦ã€‚ å¯æ€œå¤œåŠè™šå‰å¸­ï¼Œä¸é—®è‹ç”Ÿé—®é¬¼ç¥ã€‚ ","date":"2022-11-02","objectID":"/poetry-of-lishangyin/:6:0","tags":["æå•†éš"],"title":"è¯—æ­Œä¹‹æå•†éš","uri":"/poetry-of-lishangyin/"},{"categories":["è¯—æ­Œ"],"content":"å®¿éª†æ°äº­å¯„æ€€å´”é›å´”è¡® ç«¹åæ— å°˜æ°´æ§›æ¸…ï¼Œç›¸æ€è¿¢é€’éš”é‡åŸã€‚ ç§‹é˜´ä¸æ•£éœœé£æ™šï¼Œç•™å¾—æ¯è·å¬é›¨å£°ã€‚ ","date":"2022-11-02","objectID":"/poetry-of-lishangyin/:7:0","tags":["æå•†éš"],"title":"è¯—æ­Œä¹‹æå•†éš","uri":"/poetry-of-lishangyin/"},{"categories":["è¯—æ­Œ"],"content":"æ— é¢˜äºŒé¦– æ˜¨å¤œæ˜Ÿè¾°æ˜¨å¤œé£ï¼Œç”»æ¥¼è¥¿ç•”æ¡‚å ‚ä¸œã€‚ èº«æ— å½©å‡¤åŒé£ç¿¼ï¼Œå¿ƒæœ‰çµçŠ€ä¸€ç‚¹é€šã€‚ éš”åº§é€é’©æ˜¥é…’æš–ï¼Œåˆ†æ›¹å°„è¦†èœ¡ç¯çº¢ã€‚ å—Ÿä½™å¬é¼“åº”å®˜å»ï¼Œèµ°é©¬å…°å°ç±»è½¬è“¬ã€‚ é—»é“é˜Šé—¨è¼ç»¿åï¼Œæ˜”å¹´ç›¸æœ›æŠµå¤©æ¶¯ã€‚ å²‚çŸ¥ä¸€å¤œç§¦æ¥¼å®¢ï¼Œå·çœ‹å´ç‹è‹‘å†…èŠ±ã€‚ ","date":"2022-11-02","objectID":"/poetry-of-lishangyin/:8:0","tags":["æå•†éš"],"title":"è¯—æ­Œä¹‹æå•†éš","uri":"/poetry-of-lishangyin/"},{"categories":["è¯—æ­Œ"],"content":"å®‰å®šåŸæ¥¼ è¿¢é€’é«˜åŸç™¾å°ºæ¥¼ï¼Œç»¿æ¨æå¤–å°½æ±€æ´²ã€‚ è´¾ç”Ÿå¹´å°‘è™šå‚æ³ªï¼Œç‹ç²²æ˜¥æ¥æ›´è¿œæ¸¸ã€‚ æ°¸å¿†æ±Ÿæ¹–å½’ç™½å‘ï¼Œæ¬²å›å¤©åœ°å…¥æ‰èˆŸã€‚ ä¸çŸ¥è…é¼ æˆæ»‹å‘³ï¼ŒçŒœæ„é¹“é›ç«Ÿæœªä¼‘ã€‚ ","date":"2022-11-02","objectID":"/poetry-of-lishangyin/:9:0","tags":["æå•†éš"],"title":"è¯—æ­Œä¹‹æå•†éš","uri":"/poetry-of-lishangyin/"},{"categories":["è¯—æ­Œ"],"content":"æ— é¢˜Â·å…«å²å·ç…§é•œ å…«å²å·ç…§é•œï¼Œé•¿çœ‰å·²èƒ½ç”»ã€‚ åå²å»è¸é’ï¼ŒèŠ™è“‰ä½œè£™è¡©ã€‚ åäºŒå­¦å¼¹ç­ï¼Œé“¶ç”²ä¸æ›¾å¸ã€‚ åå››è—å…­äº²ï¼Œæ‚¬çŸ¥çŒœæƒ³çŠ¹æœªå«ã€‚ åäº”æ³£æ˜¥é£ï¼ŒèƒŒé¢ç§‹åƒä¸‹ã€‚ ","date":"2022-11-02","objectID":"/poetry-of-lishangyin/:10:0","tags":["æå•†éš"],"title":"è¯—æ­Œä¹‹æå•†éš","uri":"/poetry-of-lishangyin/"},{"categories":["è¯—æ­Œ"],"content":"å¤•é˜³æ¥¼ èŠ±æ˜æŸ³æš—ç»•å¤©æ„ï¼Œä¸Šå°½é‡åŸæ›´ä¸Šæ¥¼ã€‚ æ¬²é—®å­¤é¸¿å‘ä½•å¤„ï¼Œä¸çŸ¥èº«ä¸–è‡ªæ‚ æ‚ ã€‚ ","date":"2022-11-02","objectID":"/poetry-of-lishangyin/:11:0","tags":["æå•†éš"],"title":"è¯—æ­Œä¹‹æå•†éš","uri":"/poetry-of-lishangyin/"},{"categories":["è‚¡å¸‚"],"content":"è‚¡å¸‚2022Q4è®°å½•","date":"2022-10-30","objectID":"/stock-of-2022q4/","tags":["æŠ•èµ„"],"title":"è‚¡å¸‚2022Q4è®°å½•","uri":"/stock-of-2022q4/"},{"categories":["è‚¡å¸‚"],"content":" ç¢³ä¸­å’ŒåŸºé‡‘çš„æ¯æ—¥æ€»ç»“ æ—¥æœŸ Step1 Step2 Step3 Step4 20221101 é«˜å¼€ æ‹‰å‡ ä¸‹æ¥äº†ä¸€åŠ ç„¶åå†²é«˜ 20221102 ä½å¼€ æ‹‰å‡ å†²é«˜ éœ‡è¡ 20221103 ä½å¼€ æ‹‰å‡ éœ‡è¡ è·³æ°´ 20221106 é«˜å¼€ æ‹‰å‡ èµ°å¼º æ¨ªç›˜ 20221107 å¹³å¼€ æ‹‰å‡ è·³æ°´ éœ‡è¡ 20221108 ä½å¼€ æ‹‰å‡ è·³æ°´ å°V 20221109 é«˜å¼€ ä¸‹è·Œ è·³æ°´ æ¨ªç›˜ 20221110 ä½å¼€ ä¸‹è·Œ å›è½ æ¨ªç›˜ 20221111 é«˜å¼€ ä¸‹è·Œ å°V æ¨ªç›˜ 20221113 ä½å¼€ ä¸‹è·Œ è·³æ°´ è·³æ°´ ","date":"2022-10-30","objectID":"/stock-of-2022q4/:0:0","tags":["æŠ•èµ„"],"title":"è‚¡å¸‚2022Q4è®°å½•","uri":"/stock-of-2022q4/"},{"categories":["è‚¡å¸‚"],"content":"2022.10.14 åŒ»ç–—ETF æ—¥ä¸°è½¬å€º ä»Šå¤©åŒ»ç–—èµ›é“æ¶¨åˆ°å¤©èŠ±æ¿å»äº†ï¼ŒETFéƒ½æ¶¨äº† 10 ä¸ªç‚¹ å°¾ç›˜å…¥äº†æ—¥ä¸°è½¬å€ºï¼Œæˆæœ¬ 131.479ï¼Œå¸Œæœ›ä¸‹å‘¨ä¸€é«˜å¼€ï¼Œèµšä¸€ç‚¹ å‘¨å¤©å¬å¼€ 20 å¤§ï¼Œå¸Œæœ›å‡ºåˆ©å¥½æ¶ˆæ¯ï¼Œä¸‹å‘¨å¼€å¯èµ·é£æ¨¡å¼ ","date":"2022-10-30","objectID":"/stock-of-2022q4/:1:0","tags":["æŠ•èµ„"],"title":"è‚¡å¸‚2022Q4è®°å½•","uri":"/stock-of-2022q4/"},{"categories":["è‚¡å¸‚"],"content":"2022.11.01 ä¾›é”€ç¤¾æ¦‚å¿µ ç¢³ä¸­å’Œä»Šå¤©å›è¡€ 3.36 ä¸ªç‚¹ ","date":"2022-10-30","objectID":"/stock-of-2022q4/:2:0","tags":["æŠ•èµ„"],"title":"è‚¡å¸‚2022Q4è®°å½•","uri":"/stock-of-2022q4/"},{"categories":["è‚¡å¸‚"],"content":"2022.11.02 è…¾è®¯å’Œè”é€šåˆä½œæˆç«‹äº†ä¸€ä¸ªå…¬å¸ å›æš– 3000 ç‚¹ ","date":"2022-10-30","objectID":"/stock-of-2022q4/:3:0","tags":["æŠ•èµ„"],"title":"è‚¡å¸‚2022Q4è®°å½•","uri":"/stock-of-2022q4/"},{"categories":["è‚¡å¸‚"],"content":"2022.11.03 ç¾è”å‚¨åŠ æ¯ï¼ŒAè‚¡å¤§è·³æ°´ é«˜å¼€ä½èµ°çš„ä¸€å¤© ","date":"2022-10-30","objectID":"/stock-of-2022q4/:4:0","tags":["æŠ•èµ„"],"title":"è‚¡å¸‚2022Q4è®°å½•","uri":"/stock-of-2022q4/"},{"categories":["è‚¡å¸‚"],"content":"2022.11.07 è¿ç»­æ¶¨äº†å¥½å‡ å¤©ï¼Œå¸Œæœ›æ˜å¤©å¤§è·Œå•Š åœ¨å·æŠ•è½¬å€ºæ’¸äº† 200 å¤šå…ƒ ","date":"2022-10-30","objectID":"/stock-of-2022q4/:5:0","tags":["æŠ•èµ„"],"title":"è‚¡å¸‚2022Q4è®°å½•","uri":"/stock-of-2022q4/"},{"categories":["è‚¡å¸‚"],"content":"2022.11.08 å…¥äº†å˜‰è¯šè½¬å€ºï¼Œå¸Œæœ›æ—©ç‚¹è§£å¥— ","date":"2022-10-30","objectID":"/stock-of-2022q4/:6:0","tags":["æŠ•èµ„"],"title":"è‚¡å¸‚2022Q4è®°å½•","uri":"/stock-of-2022q4/"},{"categories":["è‚¡å¸‚"],"content":"2022.11.09 å˜‰è¯šè½¬å€º å˜‰è¯šè½¬å€ºè¢«æ·±å¥— 1.9 ä¸ªç‚¹ï¼Œä¸‹æ¬¡å†²é«˜çš„è¯è¿˜æ˜¯å…ˆå‡ºä¸€éƒ¨åˆ†å§ ä»Šå¤©è¡Œæƒ…ä¸å¤ªå¥½ï¼Œå¤§ç›˜åœ¨å›è°ƒ ","date":"2022-10-30","objectID":"/stock-of-2022q4/:7:0","tags":["æŠ•èµ„"],"title":"è‚¡å¸‚2022Q4è®°å½•","uri":"/stock-of-2022q4/"},{"categories":["è‚¡å¸‚"],"content":"2022.11.14 ä»Šå¤©æƒ¨å…®å…®ï¼Œç¢³ä¸­å’Œæ”¾é‡å¤§è·Œï¼Œè¡€äº 3 ä¸ªç‚¹ å¯¹å˜‰è¯šæ— è¯­äº†ï¼Œæ—©ç›˜è¿˜å†²é«˜äº†ï¼Œåé¢ç›´æ¥è·³æ°´ æœ€è¿‘åŒ»è¯æœ‰ç‚¹çŒ› ","date":"2022-10-30","objectID":"/stock-of-2022q4/:8:0","tags":["æŠ•èµ„"],"title":"è‚¡å¸‚2022Q4è®°å½•","uri":"/stock-of-2022q4/"},{"categories":["å­¦ä¹ "],"content":"å­¦ä¹ åˆ·é¢˜Part1","date":"2022-10-30","objectID":"/exercise-1/","tags":["ç‰›å®¢","åˆ·é¢˜"],"title":"å­¦ä¹ åˆ·é¢˜Part1","uri":"/exercise-1/"},{"categories":["å­¦ä¹ "],"content":"æ¯”ç‰¹å’Œæ³¢ç‰¹ å…³äºæ¯”ç‰¹å’Œæ³¢ç‰¹ï¼Œä¸‹é¢è¯´æ³•æ­£ç¡®çš„æ˜¯( )ã€‚ (A) æ¯”ç‰¹å’Œæ³¢ç‰¹æ–½ä¸€ä¸ªæ¦‚å¿µ (B) æ¯”ç‰¹æ˜¯ç å…ƒä¼ è¾“é€Ÿç‡å•ä½ (C) æ³¢ç‰¹æ˜¯ä¿¡æ¯é‡å•ä½ (D) åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œâ€œæ¯”ç‰¹/ç§’â€å’Œâ€œæ³¢ç‰¹â€åœ¨æ•°å€¼ä¸Šæ˜¯ç›¸ç­‰çš„ å‚è€ƒç­”æ¡ˆ ","date":"2022-10-30","objectID":"/exercise-1/:1:0","tags":["ç‰›å®¢","åˆ·é¢˜"],"title":"å­¦ä¹ åˆ·é¢˜Part1","uri":"/exercise-1/"},{"categories":["å­¦ä¹ "],"content":"æ¯”ç‰¹å’Œæ³¢ç‰¹ æ­£ç¡®ç­”æ¡ˆ: D æ¯”ç‰¹ æ¯”ç‰¹ç‡æ˜¯ä¿¡æ¯é‡ä¼ é€é€Ÿç‡å•ä½ï¼Œå³æ¯ç§’ä¼ è¾“äºŒ è¿›åˆ¶ä»£ç ä½æ•°ã€‚bit/s æ³¢ç‰¹ æ³¢ç‰¹ç‡æ˜¯ç å…ƒä¼ è¾“é€Ÿç‡å•ä½ï¼Œä»–è¯´æ˜å•ä½æ—¶é—´ ä¼ è¾“äº†å¤šå°‘ä¸ªç å…ƒ ","date":"2022-10-30","objectID":"/exercise-1/:2:0","tags":["ç‰›å®¢","åˆ·é¢˜"],"title":"å­¦ä¹ åˆ·é¢˜Part1","uri":"/exercise-1/"},{"categories":["è¯—æ­Œ"],"content":"è¯—æ­Œä¹‹æç™½ç¯‡","date":"2022-10-29","objectID":"/poetry-of-libai/","tags":["æç™½"],"title":"è¯—æ­Œä¹‹æç™½ç¯‡","uri":"/poetry-of-libai/"},{"categories":["è¯—æ­Œ"],"content":"æç™½ï¼ˆ701å¹´2æœˆ28æ—¥â€”762å¹´12æœˆï¼‰ï¼Œå­—å¤ªç™½ï¼Œå·é’è²å±…å£«ï¼Œåˆå·â€œè°ªä»™äººâ€ï¼Œå”ä»£ä¼Ÿå¤§çš„æµªæ¼«ä¸»ä¹‰è¯—äººï¼Œè¢«åäººèª‰ä¸ºâ€œè¯—ä»™â€ï¼Œä¸æœç”«å¹¶ç§°ä¸ºâ€œææœâ€ã€‚ ","date":"2022-10-29","objectID":"/poetry-of-libai/:0:0","tags":["æç™½"],"title":"è¯—æ­Œä¹‹æç™½ç¯‡","uri":"/poetry-of-libai/"},{"categories":["è¯—æ­Œ"],"content":"é»„é¹¤æ¥¼é€å­Ÿæµ©ç„¶ä¹‹å¹¿é™µ æ•…äººè¥¿è¾é»„é¹¤æ¥¼ï¼ŒçƒŸèŠ±ä¸‰æœˆä¸‹æ‰¬å·ã€‚ å­¤å¸†è¿œå½±ç¢§ç©ºå°½ï¼Œå”¯è§é•¿æ±Ÿå¤©é™…æµã€‚ ","date":"2022-10-29","objectID":"/poetry-of-libai/:1:0","tags":["æç™½"],"title":"è¯—æ­Œä¹‹æç™½ç¯‡","uri":"/poetry-of-libai/"},{"categories":["è¯—æ­Œ"],"content":"æœ›åºå±±ç€‘å¸ƒ æ—¥ç…§é¦™ç‚‰ç”Ÿç´«çƒŸï¼Œé¥çœ‹ç€‘å¸ƒæŒ‚å‰å·ã€‚ é£æµç›´ä¸‹ä¸‰åƒå°ºï¼Œç–‘æ˜¯é“¶æ²³è½ä¹å¤©ã€‚ ","date":"2022-10-29","objectID":"/poetry-of-libai/:2:0","tags":["æç™½"],"title":"è¯—æ­Œä¹‹æç™½ç¯‡","uri":"/poetry-of-libai/"},{"categories":["è¯—æ­Œ"],"content":"é™å¤œæ€ åºŠå‰æ˜æœˆå…‰ï¼Œç–‘æ˜¯åœ°ä¸Šéœœã€‚ ä¸¾å¤´æœ›æ˜æœˆï¼Œä½å¤´æ€æ•…ä¹¡ã€‚ ","date":"2022-10-29","objectID":"/poetry-of-libai/:3:0","tags":["æç™½"],"title":"è¯—æ­Œä¹‹æç™½ç¯‡","uri":"/poetry-of-libai/"},{"categories":["è¯—æ­Œ"],"content":"æ—©å‘ç™½å¸åŸ æœè¾ç™½å¸å½©äº‘é—´ï¼Œåƒé‡Œæ±Ÿé™µä¸€æ—¥è¿˜ã€‚ ä¸¤å²¸çŒ¿å£°å•¼ä¸ä½ï¼Œè½»èˆŸå·²è¿‡ä¸‡é‡å±±ã€‚ ","date":"2022-10-29","objectID":"/poetry-of-libai/:4:0","tags":["æç™½"],"title":"è¯—æ­Œä¹‹æç™½ç¯‡","uri":"/poetry-of-libai/"},{"categories":["è¯—æ­Œ"],"content":"ç‹¬åæ•¬äº­å±± ä¼—é¸Ÿé«˜é£å°½ï¼Œå­¤äº‘ç‹¬å»é—²ã€‚ ç›¸çœ‹ä¸¤ä¸åŒï¼Œåªæœ‰æ•¬äº­å±±ã€‚ ","date":"2022-10-29","objectID":"/poetry-of-libai/:5:0","tags":["æç™½"],"title":"è¯—æ­Œä¹‹æç™½ç¯‡","uri":"/poetry-of-libai/"},{"categories":["è¯—æ­Œ"],"content":"èµ æ±ªä¼¦ æç™½ä¹˜èˆŸå°†æ¬²è¡Œï¼Œå¿½é—»å²¸ä¸Šè¸æ­Œå£°ã€‚ æ¡ƒèŠ±æ½­æ°´æ·±åƒå°ºï¼Œä¸åŠæ±ªä¼¦é€æˆ‘æƒ…ã€‚ ","date":"2022-10-29","objectID":"/poetry-of-libai/:6:0","tags":["æç™½"],"title":"è¯—æ­Œä¹‹æç™½ç¯‡","uri":"/poetry-of-libai/"},{"categories":["è¯—æ­Œ"],"content":"æ¸…å¹³è°ƒÂ·å…¶ä¸€ äº‘æƒ³è¡£è£³èŠ±æƒ³å®¹ï¼Œæ˜¥é£æ‹‚æ§›éœ²åæµ“ã€‚ è‹¥éç¾¤ç‰å±±å¤´è§ï¼Œä¼šå‘ç‘¶å°æœˆä¸‹é€¢ã€‚ ","date":"2022-10-29","objectID":"/poetry-of-libai/:7:0","tags":["æç™½"],"title":"è¯—æ­Œä¹‹æç™½ç¯‡","uri":"/poetry-of-libai/"},{"categories":["è¯—æ­Œ"],"content":"æ¸…å¹³è°ƒÂ·å…¶äºŒ ä¸€æç§¾è‰³éœ²å‡é¦™ï¼Œäº‘é›¨å·«å±±æ‰æ–­è‚ ã€‚ å€Ÿé—®æ±‰å®«è°å¾—ä¼¼ï¼Œå¯æ€œé£ç‡•å€šæ–°å¦†ã€‚ ","date":"2022-10-29","objectID":"/poetry-of-libai/:8:0","tags":["æç™½"],"title":"è¯—æ­Œä¹‹æç™½ç¯‡","uri":"/poetry-of-libai/"},{"categories":["è¯—æ­Œ"],"content":"æ¸…å¹³è°ƒÂ·å…¶ä¸‰ åèŠ±å€¾å›½ä¸¤ç›¸æ¬¢ï¼Œå¸¸å¾—å›ç‹å¸¦ç¬‘çœ‹ã€‚ è§£é‡Šæ˜¥é£æ— é™æ¨ï¼Œæ²‰é¦™äº­åŒ—å€šé˜‘å¹²ã€‚ ","date":"2022-10-29","objectID":"/poetry-of-libai/:9:0","tags":["æç™½"],"title":"è¯—æ­Œä¹‹æç™½ç¯‡","uri":"/poetry-of-libai/"},{"categories":["è¯—æ­Œ"],"content":"æ¸¡è†é—¨é€åˆ« æ¸¡è¿œè†é—¨å¤–ï¼Œæ¥ä»æ¥šå›½æ¸¸ã€‚ å±±éšå¹³é‡å°½ï¼Œæ±Ÿå…¥å¤§è’æµã€‚ æœˆä¸‹é£å¤©é•œï¼Œäº‘ç”Ÿç»“æµ·æ¥¼ã€‚ ä»æ€œæ•…ä¹¡æ°´ï¼Œä¸‡é‡Œé€è¡ŒèˆŸã€‚ ","date":"2022-10-29","objectID":"/poetry-of-libai/:10:0","tags":["æç™½"],"title":"è¯—æ­Œä¹‹æç™½ç¯‡","uri":"/poetry-of-libai/"},{"categories":["è¯—æ­Œ"],"content":"å°†è¿›é…’Â·å›ä¸è§ å›ä¸è§ï¼Œé»„æ²³ä¹‹æ°´å¤©ä¸Šæ¥ï¼Œå¥”æµåˆ°æµ·ä¸å¤å›ã€‚ å›ä¸è§ï¼Œé«˜å ‚æ˜é•œæ‚²ç™½å‘ï¼Œæœå¦‚é’ä¸æš®æˆé›ªã€‚ äººç”Ÿå¾—æ„é¡»å°½æ¬¢ï¼Œè«ä½¿é‡‘æ¨½ç©ºå¯¹æœˆã€‚ å¤©ç”Ÿæˆ‘æå¿…æœ‰ç”¨ï¼Œåƒé‡‘æ•£å°½è¿˜å¤æ¥ã€‚ çƒ¹ç¾Šå®°ç‰›ä¸”ä¸ºä¹ï¼Œä¼šé¡»ä¸€é¥®ä¸‰ç™¾æ¯ã€‚ å²‘å¤«å­ï¼Œä¸¹ä¸˜ç”Ÿï¼Œå°†è¿›é…’ï¼Œæ¯è«åœã€‚ ä¸å›æ­Œä¸€æ›²ï¼Œè¯·å›ä¸ºæˆ‘å€¾è€³å¬ã€‚ é’Ÿé¼“é¦”ç‰ä¸è¶³è´µï¼Œä½†æ„¿é•¿é†‰ä¸æ„¿é†’ã€‚ å¤æ¥åœ£è´¤çš†å¯‚å¯ï¼ŒæƒŸæœ‰é¥®è€…ç•™å…¶åã€‚ é™ˆç‹æ˜”æ—¶å®´å¹³ä¹ï¼Œæ–—é…’ååƒæ£æ¬¢è°‘ã€‚ ä¸»äººä½•ä¸ºè¨€å°‘é’±ï¼Œå¾„é¡»æ²½å–å¯¹å›é…Œã€‚ äº”èŠ±é©¬ï¼Œåƒé‡‘è£˜ï¼Œ å‘¼å„¿å°†å‡ºæ¢ç¾é…’ï¼Œä¸å°”åŒé”€ä¸‡å¤æ„ã€‚ ","date":"2022-10-29","objectID":"/poetry-of-libai/:11:0","tags":["æç™½"],"title":"è¯—æ­Œä¹‹æç™½ç¯‡","uri":"/poetry-of-libai/"},{"categories":["è¯—æ­Œ"],"content":"æœ›å¤©é—¨å±± å¤©é—¨ä¸­æ–­æ¥šæ±Ÿå¼€ï¼Œç¢§æ°´ä¸œæµè‡³æ­¤å›ã€‚ ä¸¤å²¸é’å±±ç›¸å¯¹å‡ºï¼Œå­¤å¸†ä¸€ç‰‡æ—¥è¾¹æ¥ã€‚ ","date":"2022-10-29","objectID":"/poetry-of-libai/:12:0","tags":["æç™½"],"title":"è¯—æ­Œä¹‹æç™½ç¯‡","uri":"/poetry-of-libai/"},{"categories":["è¯—æ­Œ"],"content":"æ˜¥å¤œæ´›åŸé—»ç¬› è°å®¶ç‰ç¬›æš—é£å£°ï¼Œæ•£å…¥æ˜¥é£æ»¡æ´›åŸã€‚ æ­¤å¤œæ›²ä¸­é—»æŠ˜æŸ³ï¼Œä½•äººä¸èµ·æ•…å›­æƒ…ã€‚ ","date":"2022-10-29","objectID":"/poetry-of-libai/:13:0","tags":["æç™½"],"title":"è¯—æ­Œä¹‹æç™½ç¯‡","uri":"/poetry-of-libai/"},{"categories":["è¯—æ­Œ"],"content":"é—»ç‹æ˜Œé¾„å·¦è¿é¾™æ ‡é¥æœ‰æ­¤å¯„ æ¨èŠ±è½å°½å­è§„å•¼ï¼Œé—»é“é¾™æ ‡è¿‡äº”æºªã€‚ æˆ‘å¯„æ„å¿ƒä¸æ˜æœˆï¼Œéšå›ç›´åˆ°å¤œéƒè¥¿ã€‚ ","date":"2022-10-29","objectID":"/poetry-of-libai/:14:0","tags":["æç™½"],"title":"è¯—æ­Œä¹‹æç™½ç¯‡","uri":"/poetry-of-libai/"},{"categories":["è¯—æ­Œ"],"content":"å³¨çœ‰å±±æœˆæ­Œ å³¨çœ‰å±±æœˆåŠè½®ç§‹ï¼Œå½±å…¥å¹³ç¾Œæ±Ÿæ°´æµã€‚ å¤œå‘æ¸…æºªå‘ä¸‰å³¡ï¼Œæ€å›ä¸è§ä¸‹æ¸å·ã€‚ ","date":"2022-10-29","objectID":"/poetry-of-libai/:15:0","tags":["æç™½"],"title":"è¯—æ­Œä¹‹æç™½ç¯‡","uri":"/poetry-of-libai/"},{"categories":["è¯—æ­Œ"],"content":"å®£å·è°¢æœ“æ¥¼é¥¯åˆ«æ ¡ä¹¦å”äº‘ å¼ƒæˆ‘å»è€…ï¼Œæ˜¨æ—¥ä¹‹æ—¥ä¸å¯ç•™ï¼› ä¹±æˆ‘å¿ƒè€…ï¼Œä»Šæ—¥ä¹‹æ—¥å¤šçƒ¦å¿§ã€‚ é•¿é£ä¸‡é‡Œé€ç§‹é›ï¼Œå¯¹æ­¤å¯ä»¥é…£é«˜æ¥¼ã€‚ è“¬è±æ–‡ç« å»ºå®‰éª¨ï¼Œä¸­é—´å°è°¢åˆæ¸…å‘ã€‚ ä¿±æ€€é€¸å…´å£®æ€é£ï¼Œæ¬²ä¸Šé’å¤©è§ˆæ˜æœˆã€‚ æŠ½åˆ€æ–­æ°´æ°´æ›´æµï¼Œä¸¾æ¯æ¶ˆæ„æ„æ›´æ„ã€‚ äººç”Ÿåœ¨ä¸–ä¸ç§°æ„ï¼Œæ˜æœæ•£å‘å¼„æ‰èˆŸã€‚ ","date":"2022-10-29","objectID":"/poetry-of-libai/:16:0","tags":["æç™½"],"title":"è¯—æ­Œä¹‹æç™½ç¯‡","uri":"/poetry-of-libai/"},{"categories":["è¯—æ­Œ"],"content":"è¡Œè·¯éš¾Â·å…¶ä¸€ é‡‘æ¨½æ¸…é…’æ–—ååƒï¼Œç‰ç›˜çç¾ç›´ä¸‡é’±ã€‚ åœæ¯æŠ•ç®¸ä¸èƒ½é£Ÿï¼Œæ‹”å‰‘å››é¡¾å¿ƒèŒ«ç„¶ã€‚ æ¬²æ¸¡é»„æ²³å†°å¡å·ï¼Œå°†ç™»å¤ªè¡Œé›ªæ»¡å±±ã€‚ é—²æ¥å‚é’“ç¢§æºªä¸Šï¼Œå¿½å¤ä¹˜èˆŸæ¢¦æ—¥è¾¹ã€‚ è¡Œè·¯éš¾ï¼Œè¡Œè·¯éš¾ï¼Œå¤šæ­§è·¯ï¼Œä»Šå®‰åœ¨ï¼Ÿ é•¿é£ç ´æµªä¼šæœ‰æ—¶ï¼Œç›´æŒ‚äº‘å¸†æµæ²§æµ·ã€‚ ","date":"2022-10-29","objectID":"/poetry-of-libai/:17:0","tags":["æç™½"],"title":"è¯—æ­Œä¹‹æç™½ç¯‡","uri":"/poetry-of-libai/"},{"categories":["è¯—æ­Œ"],"content":"å¤œå®¿å±±å¯º å±æ¥¼é«˜ç™¾å°ºï¼Œæ‰‹å¯æ‘˜æ˜Ÿè¾°ã€‚ ä¸æ•¢é«˜å£°è¯­ï¼ŒææƒŠå¤©ä¸Šäººã€‚ ","date":"2022-10-29","objectID":"/poetry-of-libai/:18:0","tags":["æç™½"],"title":"è¯—æ­Œä¹‹æç™½ç¯‡","uri":"/poetry-of-libai/"},{"categories":["è¯—æ­Œ"],"content":"ç§‹é£è¯ ç§‹é£æ¸…ï¼Œç§‹æœˆæ˜ï¼Œ è½å¶èšè¿˜æ•£ï¼Œå¯’é¸¦æ –å¤æƒŠã€‚ ç›¸æ€ç›¸è§çŸ¥ä½•æ—¥ï¼Ÿæ­¤æ—¶æ­¤å¤œéš¾ä¸ºæƒ…ï¼ ","date":"2022-10-29","objectID":"/poetry-of-libai/:19:0","tags":["æç™½"],"title":"è¯—æ­Œä¹‹æç™½ç¯‡","uri":"/poetry-of-libai/"},{"categories":["è¯—æ­Œ"],"content":"èµ å­Ÿæµ©ç„¶ å¾çˆ±å­Ÿå¤«å­ï¼Œé£æµå¤©ä¸‹é—»ã€‚ çº¢é¢œå¼ƒè½©å†•ï¼Œç™½é¦–å§æ¾äº‘ã€‚ é†‰æœˆé¢‘ä¸­åœ£ï¼Œè¿·èŠ±ä¸äº‹å›ã€‚ é«˜å±±å®‰å¯ä»°ï¼Œå¾’æ­¤æ–æ¸…èŠ¬ã€‚ ","date":"2022-10-29","objectID":"/poetry-of-libai/:20:0","tags":["æç™½"],"title":"è¯—æ­Œä¹‹æç™½ç¯‡","uri":"/poetry-of-libai/"},{"categories":["è¯—æ­Œ"],"content":"å¬èœ€åƒ§æ¿¬å¼¹ç´ èœ€åƒ§æŠ±ç»¿ç»®ï¼Œè¥¿ä¸‹å³¨çœ‰å³°ã€‚ ä¸ºæˆ‘ä¸€æŒ¥æ‰‹ï¼Œå¦‚å¬ä¸‡å£‘æ¾ã€‚ å®¢å¿ƒæ´—æµæ°´ï¼Œé¦€å“å…¥éœœé’Ÿã€‚ ä¸è§‰ç¢§å±±æš®ï¼Œç§‹äº‘æš—å‡ é‡ã€‚ ","date":"2022-10-29","objectID":"/poetry-of-libai/:21:0","tags":["æç™½"],"title":"è¯—æ­Œä¹‹æç™½ç¯‡","uri":"/poetry-of-libai/"}]