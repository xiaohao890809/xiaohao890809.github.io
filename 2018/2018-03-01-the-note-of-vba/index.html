<!DOCTYPE html>
<html lang="en-us">
  <head>
  <meta http-equiv="content-type" content="text/html;charset=utf-8">
  <meta http-equiv="X-UA-Compatible" content="chrome=1">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="robots" content="noodp"/>
  <meta name="author" content="追寻原风景">
  
  
  
  <link rel="prev" href="https://xiaohao890809.github.io/2018/2018-02-27-the-study-of-reg-expression/" />
  <link rel="next" href="https://xiaohao890809.github.io/2018/2018-03-07-the-note-of-probability-theory/" />
  <link rel="canonical" href="https://xiaohao890809.github.io/2018/2018-03-01-the-note-of-vba/" />
  <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
  <link rel="manifest" href="/site.webmanifest">
  <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">
  <meta name="msapplication-TileColor" content="#da532c">
  <meta name="theme-color" content="#ffffff">
  <title>
       
       
           VBA知识点总结 | 枕霞惜友
       
  </title>
  <meta name="title" content="VBA知识点总结 | 枕霞惜友">
    
  
  <link rel="stylesheet" href="/font/iconfont.css">
  <link rel="stylesheet" href="/css/main.min.css">


  
  
 

<script type="application/ld+json">
{
    "@context" : "http://schema.org",
    "@type" : "BlogPosting",
    "mainEntityOfPage": {
         "@type": "WebPage",
         "@id": "https:\/\/xiaohao890809.github.io"
    },
    "articleSection" : "posts",
    "name" : "VBA知识点总结",
    "headline" : "VBA知识点总结",
    "description" : "VBA是一门比较早的语言了，用于处理 Office 办公软件的数据，不过最近听说以后会被 Python 代替（笑脸），现在总结一些使用 VBA 的过程遇到的一些问题以及解决办法。\n常见错误 问题1  此文件正由应用程序或另一用户使用。\n 解决方案：打开后记得做退出关闭操作。\nSet wdApp = GetObject(,\u0026#34;word.application\u0026#34;) If wdApp is Nothing Then Sef wdApp = CreatObject(\u0026#34;word.application\u0026#34;) wdApp.Visible = True End If wdApp.NormalTemplate.Saved = True wdApp.Quit Set wdApp = Nothing 常用函数 获取最大有效行数 Public Function GetLastRow(theSheet As Worksheet, ByVal col As Integer) As Integer Dim findreg As Range, ret As Range Set findreg = theSheet.Columns(col) Set ret = findreg.Find(what:=\u0026#34;*\u0026#34;, searchDirection:=xlPrevious) If Not ret Is Nothing Then GetLastRow = ret.",
    "inLanguage" : "en-us",
    "author" : "追寻原风景",
    "creator" : "追寻原风景",
    "publisher": "追寻原风景",
    "accountablePerson" : "追寻原风景",
    "copyrightHolder" : "追寻原风景",
    "copyrightYear" : "2018",
    "datePublished": "2018-03-01 22:53:23 \u002b0000 UTC",
    "dateModified" : "2018-03-01 22:53:23 \u002b0000 UTC",
    "url" : "https:\/\/xiaohao890809.github.io\/2018\/2018-03-01-the-note-of-vba\/",
    "wordCount" : "190",
    "keywords" : [  "枕霞惜友"]
}
</script>

</head>

  


  <body class="">
    <div class="wrapper">
        <nav class="navbar">
    
        <div class="top-scroll-bar"></div>
    
    <div class="container">
        <div class="navbar-header header-logo">
        	<a href="javascript:void(0);" class="theme-switch"><i class="iconfont icon-xihuan"></i></a>&nbsp;<a href="https://xiaohao890809.github.io">枕霞惜友</a>
        </div>
        <div class="menu navbar-right">
                
                
                <a class="menu-item" href="/posts/" title="">Blog</a>
                
                <a class="menu-item" href="/categories/" title="">Categories</a>
                
                <a class="menu-item" href="/tags/" title="">Tags</a>
                
        </div>
    </div>
</nav>
<nav class="navbar-mobile" id="nav-mobile" style="display: none">
    
        <div class="top-scroll-bar"></div>
    
     <div class="container">
        <div class="navbar-header">
            <div>  <a href="javascript:void(0);" class="theme-switch"><i class="iconfont icon-xihuan"></i></a>&nbsp;<a href="https://xiaohao890809.github.io">枕霞惜友</a></div>
            <div class="menu-toggle">
                <span></span><span></span><span></span>
            </div>
        </div>
     
          <div class="menu" id="mobile-menu">
                
                
                <a class="menu-item" href="/posts/" title="">Blog</a>
                
                <a class="menu-item" href="/categories/" title="">Categories</a>
                
                <a class="menu-item" href="/tags/" title="">Tags</a>
                
        </div>
    </div>
</nav>
    	 <main class="main">
          <div class="container">
      		
<article class="post-warp" itemscope itemtype="http://schema.org/Article">
    <header class="post-header">
        <h1 class="post-title" itemprop="name headline">VBA知识点总结</h1>
        <div class="post-meta">
                Written by <a itemprop="name" href="https://xiaohao890809.github.io" rel="author">追寻原风景</a> with ♥ 
                <span class="post-time">
                on <time datetime=2018-03-01 itemprop="datePublished">March 1, 2018</time>
                </span>
                in
                <i class="iconfont icon-folder"></i>
                <span class="post-category">
                        <a href="https://xiaohao890809.github.io/categories/%E6%8A%80%E6%9C%AF/"> 技术 </a>
                        
                </span>
        </div>
    </header>

    
          <div class="post-toc" id="post-toc">
  <h2 class="post-toc-title"></h2>
  
  <div class="post-toc-content always-active">
    <nav id="TableOfContents">
  <ul>
    <li><a href="#常见错误">常见错误</a>
      <ul>
        <li><a href="#问题1">问题1</a></li>
      </ul>
    </li>
    <li><a href="#常用函数">常用函数</a>
      <ul>
        <li><a href="#获取最大有效行数">获取最大有效行数</a></li>
        <li><a href="#获取最大有效列数">获取最大有效列数</a></li>
      </ul>
    </li>
    <li><a href="#常用操作">常用操作</a>
      <ul>
        <li><a href="#分割字符串">分割字符串</a></li>
        <li><a href="#写入txt">写入txt</a></li>
        <li><a href="#查看下拉框所有内容">查看下拉框所有内容</a></li>
        <li><a href="#下拉框进行赋值">下拉框进行赋值</a></li>
        <li><a href="#获取选定单元格所在的行和列">获取选定单元格所在的行和列</a></li>
      </ul>
    </li>
  </ul>
</nav>
  </div>
</div>
<script type="text/javascript">
  window.onload = function () {
    var fix = $('.post-toc');
    var end = $('.post-comment');
    var fixTop = fix.offset().top, fixHeight = fix.height();
    var endTop, miss;
    var offsetTop = fix[0].offsetTop;
    $(window).scroll(function () {
      var docTop = Math.max(document.body.scrollTop, document.documentElement.scrollTop);
      if (end.length > 0) {
        endTop = end.offset().top;
        miss = endTop - docTop - fixHeight;
      }
      if (fixTop < docTop) {
        fix.css({ 'position': 'fixed' });
        if ((end.length > 0) && (endTop < (docTop + fixHeight))) {
          fix.css({ top: miss });
        } else {
          fix.css({ top: 0 });
        }
      } else {
        fix.css({ 'position': 'absolute' });
        fix.css({ top: offsetTop });
      }
    })
  }
</script> 
    

    <script type="text/javascript">
            window.MathJax = {
            tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]},
            TeX: {equationNumbers: {autoNumber: "AMS"}},
            showProcessingMessages: false,
            messageStyle: 'none'
        };
   </script>

    <script type="text/javascript" async src="/lib/mathjax/MathJax.js?config=TeX-MML-AM_CHTML"></script>

    <script async src="https://cdn.jsdelivr.net/npm/mathjax@2.7.5/MathJax.js?config=TeX-MML-AM_CHTML"  integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>

    <div class="post-content">
        

        

        
        
     
          
          
          

          
          
          

          <p>VBA是一门比较早的语言了，用于处理 Office 办公软件的数据，不过最近听说以后会被 Python 代替（笑脸），现在总结一些使用 VBA 的过程遇到的一些问题以及解决办法。</p>
<h2 id="常见错误">常见错误</h2>
<h3 id="问题1">问题1</h3>
<blockquote>
<p>此文件正由应用程序或另一用户使用。</p>
</blockquote>
<p>解决方案：打开后记得做退出关闭操作。</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-vb" data-lang="vb"><span style="color:#66d9ef">Set</span> wdApp <span style="color:#f92672">=</span> GetObject(,<span style="color:#e6db74">&#34;word.application&#34;</span>)
<span style="color:#66d9ef">If</span> wdApp <span style="color:#f92672">is</span> <span style="color:#66d9ef">Nothing</span> <span style="color:#66d9ef">Then</span>
   Sef wdApp <span style="color:#f92672">=</span> CreatObject(<span style="color:#e6db74">&#34;word.application&#34;</span>)
   wdApp.Visible <span style="color:#f92672">=</span> <span style="color:#66d9ef">True</span>
<span style="color:#66d9ef">End</span> <span style="color:#66d9ef">If</span>
wdApp.NormalTemplate.Saved <span style="color:#f92672">=</span> <span style="color:#66d9ef">True</span>
wdApp.Quit
<span style="color:#66d9ef">Set</span> wdApp <span style="color:#f92672">=</span> <span style="color:#66d9ef">Nothing</span>
</code></pre></div><h2 id="常用函数">常用函数</h2>
<h3 id="获取最大有效行数">获取最大有效行数</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-vb" data-lang="vb"><span style="color:#66d9ef">Public</span> <span style="color:#66d9ef">Function</span> <span style="color:#a6e22e">GetLastRow</span>(theSheet <span style="color:#f92672">As</span> Worksheet, <span style="color:#66d9ef">ByVal</span> col <span style="color:#f92672">As</span> <span style="color:#66d9ef">Integer</span>) <span style="color:#f92672">As</span> <span style="color:#66d9ef">Integer</span>
  
   <span style="color:#66d9ef">Dim</span> findreg <span style="color:#f92672">As</span> Range, ret <span style="color:#f92672">As</span> Range
   <span style="color:#66d9ef">Set</span> findreg <span style="color:#f92672">=</span> theSheet.Columns(col)
   <span style="color:#66d9ef">Set</span> ret <span style="color:#f92672">=</span> findreg.Find(what:<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;*&#34;</span>, searchDirection:<span style="color:#f92672">=</span>xlPrevious)
   <span style="color:#66d9ef">If</span> <span style="color:#66d9ef">Not</span> ret <span style="color:#f92672">Is</span> <span style="color:#66d9ef">Nothing</span> <span style="color:#66d9ef">Then</span>
      GetLastRow <span style="color:#f92672">=</span> ret.Row
   <span style="color:#66d9ef">Else</span>
      GetLastRow <span style="color:#f92672">=</span> 0
   <span style="color:#66d9ef">End</span> <span style="color:#66d9ef">If</span>

<span style="color:#66d9ef">End</span> <span style="color:#66d9ef">Function</span>
</code></pre></div><h3 id="获取最大有效列数">获取最大有效列数</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-vb" data-lang="vb"><span style="color:#66d9ef">Public</span> <span style="color:#66d9ef">Function</span> <span style="color:#a6e22e">GetLastCol</span>(theSheet <span style="color:#f92672">As</span> Worksheet, <span style="color:#66d9ef">ByVal</span> row <span style="color:#f92672">As</span> <span style="color:#66d9ef">Integer</span>) <span style="color:#f92672">As</span> <span style="color:#66d9ef">Integer</span>
  
   <span style="color:#66d9ef">Dim</span> findreg <span style="color:#f92672">As</span> Range, ret <span style="color:#f92672">As</span> Range 
   <span style="color:#66d9ef">Set</span> findreg <span style="color:#f92672">=</span> theSheet.Rows(row)
   <span style="color:#66d9ef">Set</span> ret <span style="color:#f92672">=</span> findreg.Find(what:<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;*&#34;</span>, searchDirection:<span style="color:#f92672">=</span>xlPrevious)
   <span style="color:#66d9ef">If</span> <span style="color:#66d9ef">Not</span> ret <span style="color:#f92672">Is</span> <span style="color:#66d9ef">Nothing</span> <span style="color:#66d9ef">Then</span>
      GetLastCol <span style="color:#f92672">=</span> ret.Column
   <span style="color:#66d9ef">Else</span>
      GetLastCol <span style="color:#f92672">=</span> 0
   <span style="color:#66d9ef">End</span> <span style="color:#66d9ef">If</span>

<span style="color:#66d9ef">End</span> <span style="color:#66d9ef">Function</span>
</code></pre></div><h2 id="常用操作">常用操作</h2>
<h3 id="分割字符串">分割字符串</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-vb" data-lang="vb"><span style="color:#66d9ef">Dim</span> a <span style="color:#f92672">as</span> <span style="color:#66d9ef">Variant</span>
<span style="color:#66d9ef">Dim</span> b <span style="color:#f92672">as</span> <span style="color:#66d9ef">Variant</span>
a <span style="color:#f92672">=</span> Split(<span style="color:#e6db74">&#34;Red$Blue$Yellow&#34;</span>,<span style="color:#e6db74">&#34;$&#34;</span>)
b <span style="color:#f92672">=</span> ubound(a)
<span style="color:#66d9ef">For</span> i <span style="color:#f92672">=</span> 0 <span style="color:#66d9ef">to</span> b
   MsgBox a(i)
<span style="color:#66d9ef">Next</span>
</code></pre></div><h3 id="写入txt">写入txt</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-vb" data-lang="vb"><span style="color:#66d9ef">Sub</span> <span style="color:#a6e22e">test</span>()
   Open ThisWorkbook.Path <span style="color:#f92672">&amp;</span> <span style="color:#e6db74">&#34;1.txt&#34;</span> <span style="color:#66d9ef">For</span> Output(覆盖)<span style="color:#f92672">/</span>Append(追加) <span style="color:#f92672">As</span> #1
   Print #1, <span style="color:#e6db74">&#34;test2&#34;</span>
   Print #1, <span style="color:#e6db74">&#34;test3&#34;</span>
   Close #1
<span style="color:#66d9ef">End</span> <span style="color:#66d9ef">Sub</span>
</code></pre></div><h3 id="查看下拉框所有内容">查看下拉框所有内容</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-vb" data-lang="vb">Range(<span style="color:#e6db74">&#34;D4&#34;</span>).Validation.Formula1
</code></pre></div><h3 id="下拉框进行赋值">下拉框进行赋值</h3>
<ol>
<li>第一种方法</li>
</ol>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-vb" data-lang="vb">ComboBox1.List <span style="color:#f92672">=</span> Split(<span style="color:#e6db74">&#34;张三,李四&#34;</span>,<span style="color:#e6db74">&#34;,&#34;</span>)
</code></pre></div><ol>
<li>第二种方法</li>
</ol>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-vb" data-lang="vb"><span style="color:#66d9ef">With</span> ComboBox1
   .AddItem(<span style="color:#e6db74">&#34;str1&#34;</span>)
<span style="color:#66d9ef">End</span> <span style="color:#66d9ef">With</span>
</code></pre></div><h3 id="获取选定单元格所在的行和列">获取选定单元格所在的行和列</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-vb" data-lang="vb">ActiveCell.Row
ActiveCell.Column
</code></pre></div>
    </div>

    <div class="post-copyright">
             
            <p class="copyright-item">
                <span>Author:</span>
                <span>追寻原风景 </span>
                </p>
            
           
             
            <p class="copyright-item">
                    <span>Link:</span>
                    <a href=https://xiaohao890809.github.io/2018/2018-03-01-the-note-of-vba/>https://xiaohao890809.github.io/2018/2018-03-01-the-note-of-vba/</span>
            </p>
            
             
            <p class="copyright-item lincese">
                本文采用<a rel="license" href="http://creativecommons.org/licenses/by-nc/4.0/" target="_blank">知识共享署名-非商业性使用 4.0 国际许可协议</a>进行许可
            </p>
            
    </div>

  
    <div class="post-tags">
        
        <section>
                <a href="javascript:window.history.back();">back</a></span> · 
                <span><a href="https://xiaohao890809.github.io">home</a></span>
        </section>
    </div>

    <div class="post-nav">
        
        <a href="https://xiaohao890809.github.io/2018/2018-02-27-the-study-of-reg-expression/" class="prev" rel="prev" title="正则表达式知识积累"><i class="iconfont icon-left"></i>&nbsp;正则表达式知识积累</a>
         
        
        <a href="https://xiaohao890809.github.io/2018/2018-03-07-the-note-of-probability-theory/" class="next" rel="next" title="机器学习基础之概率论">机器学习基础之概率论&nbsp;<i class="iconfont icon-right"></i></a>
        
    </div>

    <div class="post-comment">
        
        
    </div>

</article>
          </div>
		   </main>
      <footer class="footer">
    <div class="copyright">
        &copy;
        
        <span itemprop="copyrightYear">2015 - 2020</span>
        
        <span class="with-love">
    	 <i class="iconfont icon-love"></i> 
         </span>
         
            <span class="author" itemprop="copyrightHolder"><a href="https://xiaohao890809.github.io">追寻原风景</a> | </span> 
         

         
		  <span>Powered by <a href="https://gohugo.io/" target="_blank" rel="external nofollow">Hugo</a> & <a href="https://github.com/liuzc/leaveit" target="_blank" rel="external nofollow">LeaveIt</a></span> 
    </div>
</footer>













    
    
    <script src="/js/vendor_no_gallery.min.js" async=""></script>
    
  



     </div>
  </body>
</html>
